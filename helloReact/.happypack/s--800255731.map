{"version":3,"sources":["src\\assets\\kindEditor\\kindeditor-all.js"],"names":["window","undefined","KindEditor","console","log","_VERSION","_ua","navigator","userAgent","toLowerCase","_IE","indexOf","_NEWIE","_GECKO","_WEBKIT","_OPERA","_MOBILE","_IOS","test","_QUIRKS","document","compatMode","_IERANGE","getSelection","_matches","exec","_V","_TIME","Date","getTime","_isArray","val","Object","prototype","toString","call","_isFunction","_inArray","arr","i","len","length","_each","obj","fn","key","hasOwnProperty","_trim","str","replace","_inString","delimiter","_addUnit","unit","_removeUnit","match","parseInt","_escape","_unescape","_toCamel","split","charAt","toUpperCase","substr","_toHex","hex","d","s","$0","$1","$2","$3","_toMap","map","_toArray","offset","Array","slice","_undef","defaultVal","_invalidUrl","url","_addParam","param","_extend","child","parent","proto","childProto","constructor","_json","text","cx","lastIndex","a","charCodeAt","eval","_round","Math","round","K","DEBUG","VERSION","IE","GECKO","WEBKIT","OPERA","V","TIME","each","isArray","isFunction","inArray","inString","trim","addUnit","removeUnit","escape","unescape","toCamel","toHex","toMap","toArray","undef","invalidUrl","addParam","extend","json","_INLINE_TAG_MAP","_BLOCK_TAG_MAP","_SINGLE_TAG_MAP","_STYLE_TAG_MAP","_CONTROL_TAG_MAP","_PRE_TAG_MAP","_NOSPLIT_TAG_MAP","_AUTOCLOSE_TAG_MAP","_FILL_ATTR_MAP","_VALUE_TAG_MAP","_getBasePath","els","getElementsByTagName","src","substring","lastIndexOf","basePath","options","designMode","fullscreenMode","filterMode","wellFormatMode","shadowMode","loadStyleMode","themesPath","langPath","pluginsPath","themeType","langType","urlType","newlineTag","resizeType","syncType","pasteType","dialogAlignType","useContextmenu","fullscreenShortcut","bodyClass","indentChar","cssPath","cssData","minWidth","minHeight","minChangeSize","zIndex","items","noDisableItems","colorTable","fontSizeTable","htmlTags","font","span","div","table","embed","img","pre","hr","iframe","layout","_useCapture","_INPUT_KEY_MAP","_CURSORMOVE_KEY_MAP","_CHANGE_KEY_MAP","_bindEvent","el","type","addEventListener","attachEvent","_unbindEvent","removeEventListener","detachEvent","_EVENT_PROPS","KEvent","event","init","self","doc","ownerDocument","target","srcElement","nodeType","parentNode","relatedTarget","fromElement","toElement","pageX","clientX","documentElement","body","scrollLeft","clientLeft","pageY","clientY","scrollTop","clientTop","which","charCode","keyCode","metaKey","ctrlKey","button","preventDefault","ev","returnValue","stopPropagation","cancelBubble","stop","_eventExpendo","_eventId","_eventData","_getId","_setId","_removeId","e","removeAttribute","_bind","id","events","kevent","push","_unbind","splice","count","_fire","_ctrl","shiftKey","altKey","_readyFinished","_ready","loaded","readyFunc","ieReadyFunc","doScroll","setTimeout","ieReadyStateFunc","readyState","toplevel","frameElement","ctrl","ready","_getCssList","css","list","reg","_getAttrList","tag","_addClassToTag","className","_formatCss","_formatUrl","mode","host","pathname","location","protocol","m","getRealPath","path","parts","paths","part","pop","join","getRelativePath","depth","prefix","_formatHtml","html","wellFormatted","fontSizeList","htmlTagMap","script","style","re","tagStack","$4","$5","$6","full","startNewline","startSlash","tagName","attr","endSlash","endNewline","attrMap","fontStyleMap","fontStyle","color","styleMap","k","v","_clearMsWord","_mediaType","_mediaClass","_mediaAttrs","srcTag","_mediaEmbed","attrs","play","align","menu","hidden","flashvars","_mediaImg","blankPath","width","height","_tmpl","data","Function","formatUrl","formatHtml","getCssList","getAttrList","mediaType","mediaAttrs","mediaEmbed","mediaImg","clearMsWord","tmpl","_contains","nodeA","nodeB","_getSetAttrDiv","createElement","setAttribute","_GET_SET_ATTRIBUTE","_getAttr","nodeName","appendChild","cloneNode","innerHTML","getAttribute","_queryAll","expr","root","exprList","mergedResults","stripslashes","cmpTag","tagA","tagB","byId","getElementById","byClass","getElementsByClassName","querySelectorAll","cls","byName","name","getElementsByName","byAttr","select","matches","results","isChild","subResults","j","l","_query","query","queryAll","_get","_getDoc","node","_getWin","parentWindow","defaultView","_setHtml","temp","removeChild","empty","_hasClass","_setAttr","_removeAttr","_getNodeName","_computedCss","win","camelKey","getComputedStyle","getPropertyValue","currentStyle","_hasVal","_docElement","_docHeight","max","scrollHeight","clientHeight","_docWidth","scrollWidth","clientWidth","_getScrollPos","x","y","scrollX","scrollY","KNode","bind","unbind","fire","hasAttr","outer","removeAttr","get","eq","hasClass","addClass","removeClass","RegExp","innerText","textContent","hasVal","value","offsetWidth","offsetHeight","opacity","filter","pos","getBoundingClientRect","box","left","top","offsetLeft","offsetTop","offsetParent","clone","bool","append","appendTo","before","insertBefore","after","nextSibling","replaceWith","nodes","newNode","replaceChild","firstChild","next","remove","keepChilds","show","_originDisplay","hide","display","isSingle","isInline","isBlock","isStyle","isControl","contains","otherNode","children","nodeValue","first","last","index","sibling","previousSibling","prev","scan","order","walk","n","lastChild","_K","childNodes","arguments","NodeClass","_START_TO_START","_START_TO_END","_END_TO_END","_END_TO_START","_BOOKMARK_ID","_updateCollapsed","range","collapsed","startContainer","endContainer","startOffset","endOffset","_copyAndDelete","isCopy","isDelete","nodeList","splitTextNode","centerNode","splitText","center","setStart","right","setEnd","removeNodes","up","collapse","copyRange","cloneRange","down","start","incStart","incEnd","end","ancestor","commonAncestor","frag","createDocumentFragment","textNode","extractNodes","nextNode","testRange","KRange","selectNode","compareBoundaryPoints","childFlag","_moveToElementText","knode","moveToElementText","_getStartEnd","rng","isStart","parentElement","pointRange","duplicate","startNode","startPos","cmp","compareEndPoints","nodeRange","dummy","setEndPoint","moveStart","prevNode","_getEndRange","createTextRange","kchild","_toRange","tr2td","cells","item","getParents","parents","parentsA","parentsB","lenA","lenB","parentA","parentB","setStartBefore","setStartAfter","setEndBefore","setEndAfter","selectNodeContents","toStart","how","rangeA","rangeB","nodeC","posA","posB","diff","cloneContents","deleteContents","extractContents","insertNode","sc","so","ec","eo","c","nodeCount","surroundContents","hasControlRange","createRange","createControlRange","addElement","downPos","upPos","enlarge","toBlock","enlargePos","shrink","createBookmark","serialize","endNode","moveToBookmark","bookmark","dump","_range","mixed","RangeClass","START_TO_START","START_TO_END","END_TO_END","END_TO_START","_nativeCommand","execCommand","_nativeCommandValue","queryCommandValue","_getSel","selection","_getRng","sel","rangeCount","getRangeAt","_singleKeyMap","newMap","_hasAttrOrCss","_hasAttrOrCssByKey","mapKey","method","_removeAttrOrCss","_removeAttrOrCssByKey","allFlag","_getInnerNode","inner","_isEmptyNode","_mergeWrapper","b","lastA","childA","merged","_mergeAttrs","_wrapNode","wrapper","nodeWrapper","styles","_inPreElement","KCmd","forceReset","hasDummy","hasU200b","ex","focus","createTextNode","removeAllRanges","addRange","scrollTo","wrap","copyWrapper","tempRange","needSplit","dummyParent","ksc","kscp","sb","sa","startBefore","startDummy","endDummy","cmpStart","startAfter","endAfter","commonNode","find","cNode","state","queryCommandState","lc","toggle","bold","strong","italic","em","underline","u","strikethrough","forecolor","hilitecolor","fontsize","fontname","fontfamily","removeformat","tags","inserthtml","quickMode","pasteHtml","outerHTML","pasteHTML","newRange","insertHtml","print","insertimage","title","border","createlink","setAttr","unlink","queryCommandSupported","_cmd","CmdClass","cmd","_drag","moveEl","moveFn","clickEl","beforeDrag","iframeFix","docs","_iframeDoc","mousedown","moveListener","kdoc","diffX","diffY","selectListener","upListener","releaseCapture","mousemove","mouseup","setCapture","KWidget","z","_alignEl","alignEl","position","autoPos","autoScroll","scrollPos","updateProp","w","h","docEl","draggable","_widget","WidgetClass","widget","contentDocument","contentWindow","_direction","dir","_getInitHtml","_elementVal","KEdit","beforeGetHtml","beforeSetHtml","afterSetHtml","isDocumentDomain","domain","srcScript","iframeSrc","encodeURIComponent","textarea","tabIndex","isNaN","setWidth","setHeight","open","write","close","afterChange","click","_mousedownHandler","blur","keydown","disabled","contentEditable","afterCreate","isFull","design","input","keyup","contextmenu","timeoutHandler","_edit","EditClass","edit","iframeDoc","_selectToolbar","KToolbar","disableMode","noDisableItemMap","_itemMap","hover","mouseover","mouseout","unselect","enable","disable","disableAll","_toolbar","ToolbarClass","toolbar","KMenu","centerLineMode","addItem","itemDiv","leftDiv","rightDiv","iconClass","centerDiv","checked","beforeRemove","_menu","MenuClass","KColorPicker","colors","selectedColor","_cells","cellPadding","cellSpacing","row","insertRow","cell","insertCell","colSpan","_addAttr","noColor","_colorpicker","ColorPickerClass","colorpicker","KUploadButton","fieldName","extraParams","afterError","alert","hiddenElements","form","fileBox","submit","customUploadImg","attachType","files","client_width","client_height","insert","error","afterUpload","_uploadbutton","UploadButtonClass","uploadbutton","_createButton","arg","btn","KDialog","previewBtn","yesBtn","noBtn","closeBtn","showMask","contentDiv","iframeMask","headerDiv","closeIcon","bodyDiv","footerDiv","mask","docWidth","docHeight","isLoading","setMaskIndex","showLoading","msg","loading","hideLoading","_dialog","DialogClass","dialog","_tabs","afterSelect","liList","ul","add","tab","li","selectedIndex","panel","tabs","_loadScript","head","charset","onload","onreadystatechange","_chopQuery","_loadStyle","link","absoluteUrl","links","href","rel","_ajax","dataType","xhr","XMLHttpRequest","ActiveXObject","status","responseText","params","setRequestHeader","send","loadScript","loadStyle","ajax","_plugins","_plugin","_language","_parseLangKey","ns","_lang","_getImageFromRange","_bindContextmenuEvent","hideMenu","_contextmenus","maxWidth","cond","shift","prevItem","visibility","menuHeight","_bindNewlineEvent","brSkipTagMap","pSkipTagMap","getAncestorTagName","p","_bindTabEvent","afterTab","_bindFocusEvent","afterFocus","afterBlur","_removeBookmarkTag","_removeTempTag","_addBookmarkToStack","stack","_undoToRedo","fromStack","toStack","KEditor","setOption","se","initContent","plugin","isCreated","_handlers","_undoStack","_redoStack","_firstAddBookmark","dialogs","lang","loadPlugin","_pluginStatus","handler","clickToolbar","updateState","addContextmenu","create","overflow","container","toolbarDiv","editDiv","statusbar","_scrollPos","_fullscreenExecuted","htmlList","menuName","editHeight","_docMousedownFn","addBookmark","readonlyMode","readonly","_fullscreenResizeHandler","initResize","resize","hideDialog","fullHtml","isEmpty","isDirty","selectedHtml","changeFlag","apply","appendHtml","sync","checkSize","abs","undo","redo","fullscreen","isReadonly","createMenu","hideContextmenu","createDialog","firstDialog","parentDialog","errorDialog","_editor","_instances","_create","editor","_eachEditor","EditorClass","instances","shortcutKeys","selectall","hasForm","resetBtn","blocks","heights","h1","h2","h3","H4","curVal","getSelectedLink","getSelectedImage","getSelectedFlash","getSelectedMedia","getSelectedAnchor","uName","getSelectedTable","getSelectedRow","getSelectedCell","pasting","movePastedData","imgAttrs","code","source","preview","cut","copy","paste","plainpaste","wordpaste","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","formatblock","image","multiimage","flash","media","tablecell","emoticons","about","filemanager","baidumap","lineheight","clearhtml","pagebreak","quickformat","insertfile","template","anchor","yes","no","editImage","deleteImage","editFlash","deleteFlash","editMedia","deleteMedia","editLink","deleteLink","editAnchor","deleteAnchor","tableprop","tablecellprop","tableinsert","tabledelete","tablecolinsertleft","tablecolinsertright","tablerowinsertabove","tablerowinsertbelow","tablerowmerge","tablecolmerge","tablerowsplit","tablecolsplit","tablecoldelete","tablerowdelete","pleaseSelectFile","invalidImg","invalidMedia","invalidWidth","invalidHeight","invalidBorder","invalidRows","invalidCols","invalidPadding","invalidSpacing","invalidJson","uploadSuccess","cutError","copyError","pasteError","ajaxLoading","uploadLoading","uploadError","h4","nameBox","autoHeightMode","hideScroll","scroll","overflowY","resetHeight","mapWidth","mapHeight","address","search","insertDynamicMap","centerObj","getCenter","lng","lat","zoom","getZoom","checkbox","searchBtn","addressBox","geocoder","maptype","getMapTypeId","iframeHtml","pleaseInput","emoticonsPath","allowPreview","allowPreviewEmoticons","currentPageNum","rows","cols","total","startNum","pages","ceil","colsHalf","floor","wrapperDiv","elements","removeEvent","previewDiv","previewImg","bindCellEvent","num","createEmoticonsTable","pageNum","parentDiv","pageDiv","bindPageEvent","createPageTable","fileManagerJson","imgPath","makeFileTitle","filename","filesize","datetime","bindTitle","is_dir","filemanagerDialog","dirName","viewType","clickFn","moveup","viewImage","listImage","orderType","fileName","fileSize","fileType","moveupImg","moveupLink","viewServerBtn","viewTypeBox","orderTypeBox","reloadPage","func","elList","bindEvent","result","createFunc","fileUrl","current_url","dirPath","current_dir_path","is_photo","createCommon","moveup_dir_path","changeFunc","createView","createList","change","fileList","file_list","iconUrl","cell0","has_file","emptyFolder","photoDiv","allowFlashUpload","allowFileManager","formatUploadUrl","extraFileUploadParams","filePostName","uploadJson","upload","viewServer","urlBox","widthBox","heightBox","quality","message","afterSelectFile","allowImageUpload","allowImageRemote","imageTabIndex","fillDescAfterUploadImage","imageDialog","imageUrl","imageWidth","imageHeight","imageTitle","imageAlign","showRemote","showLocal","remoteUrl","size","resetSize","imgTitle","localUrl","dialogWidth","dialogHeight","localUrlBox","titleBox","alignBox","refreshBtn","remoteImage","localImage","originalWidth","originalHeight","setSize","tempImg","allowFileUpload","fileDialog","fileTitle","lineHeight","linkType","typeBox","Option","newWindow","selfWindow","allowMediaUpload","autostart","autostartBox","loop","KSWFUpload","progressbars","uploadDesc","startButtonValue","showError","settings","debug","upload_url","uploadUrl","flash_url","flashUrl","file_post_name","button_placeholder","button_image_url","buttonImageUrl","button_width","buttonWidth","button_height","buttonHeight","button_cursor","SWFUpload","CURSOR","HAND","file_types","fileTypes","file_types_description","fileTypesDesc","file_upload_limit","fileUploadLimit","file_size_limit","fileSizeLimit","post_params","postParams","file_queued_handler","file","fileIconUrl","appendFile","file_queue_error_handler","errorCode","errorName","QUEUE_ERROR","QUEUE_LIMIT_EXCEEDED","queueLimitExceeded","FILE_EXCEEDS_SIZE_LIMIT","fileExceedsSizeLimit","ZERO_BYTE_FILE","zeroByteFile","INVALID_FILETYPE","invalidFiletype","unknownError","upload_start_handler","upload_progress_handler","bytesLoaded","bytesTotal","percent","progressbar","bar","upload_error_handler","filestatus","FILE_STATUS","ERROR","errorMessage","upload_success_handler","serverData","swfu","startUpload","getUrlList","COMPLETE","removeFile","fileId","cancelUpload","removeFiles","statusDiv","pendingMessage","destroy","swfupload","element","imageSizeLimit","imageFileTypes","imageUploadLimit","multiImageDialog","uploadLimit","sizeLimit","insertAll","clearAll","pending","urlList","initSWFUpload","customSettings","eventQueue","movieName","movieCount","movieElement","initSettings","loadFlash","displayDebugInfo","version","UPLOAD_ERROR","HTTP_ERROR","MISSING_UPLOAD_URL","IO_ERROR","SECURITY_ERROR","UPLOAD_LIMIT_EXCEEDED","UPLOAD_FAILED","SPECIFIED_FILE_ID_NOT_FOUND","FILE_VALIDATION_FAILED","FILE_CANCELLED","UPLOAD_STOPPED","QUEUED","IN_PROGRESS","CANCELLED","BUTTON_ACTION","SELECT_FILE","SELECT_FILES","START_UPLOAD","ARROW","WINDOW_MODE","WINDOW","TRANSPARENT","OPAQUE","completeURL","currentURL","hostname","port","indexSlash","ensureDefault","settingName","defaultValue","debug_enabled","return_upload_start_handler","returnUploadStart","debugMessage","custom_settings","prevent_swf_caching","preserve_relative_urls","targetElement","tempParent","button_placeholder_id","getFlashHTML","getMovieElement","classid","button_window_mode","getFlashVars","paramString","buildParamString","httpSuccessString","http_success","use_query_string","requeue_on_error","assume_success_timeout","file_queue_limit","button_text","button_text_top_padding","button_text_left_padding","button_text_style","button_action","button_disabled","paramStringPairs","CallFunction","ex1","ex2","swfupload_loaded_handler","file_dialog_start_handler","upload_complete_handler","debug_handler","addSetting","default_value","getSetting","callFlash","functionName","argumentArray","returnString","__flash__argumentsToXML","post","unescapeFilePostParams","selectFile","selectFiles","fileID","triggerErrorEvent","stopUpload","getStats","setStats","statsObject","getFile","addFileParam","removeFileParam","setUploadURL","setPostParams","paramsObject","addPostParam","removePostParam","setFileTypes","types","description","setFileSizeLimit","setFileUploadLimit","setFileQueueLimit","fileQueueLimit","setFilePostName","setUseQueryString","useQueryString","setRequeueOnError","requeueOnError","setHTTPSuccess","http_status_codes","setAssumeSuccessTimeout","timeout_seconds","setDebugEnabled","debugEnabled","setButtonImageURL","buttonImageURL","setButtonDimensions","movie","setButtonText","setButtonTextPadding","setButtonTextStyle","setButtonDisabled","isDisabled","setButtonAction","buttonAction","setButtonCursor","cursor","queueEvent","handlerName","executeNextEvent","f","unescapedPost","uk","String","fromCharCode","testExternalInterface","flashReady","cleanUp","instance","flashEx","fileDialogStart","fileQueued","fileQueueError","fileDialogComplete","numFilesSelected","numFilesQueued","numFilesInQueue","uploadStart","uploadProgress","bytesComplete","responseReceived","uploadComplete","exceptionMessage","exceptionValues","Console","writeLine","documentForm","fontFamily","margin","queue","oldInitSettings","queueSettings","queue_cancelled_flag","queue_upload_count","user_upload_complete_handler","user_upload_start_handler","uploadCompleteHandler","uploadStartHandler","queue_complete_handler","cancelQueue","stats","files_queued","continueUpload","pagebreakHtml","tail","comment","blockMap","getFirstChild","subList","zeroborder","_setColor","pickerList","_initColorPicker","dialogDiv","colorBox","removePicker","picker","_getCellIndex","rowSpanCount","rowSpan","cellIndex","prop","isInsert","px","space","padding","spacing","alignDefault","alignLeft","alignCenter","alignRight","borderWidth","borderColor","backgroundColor","rowsBox","colsBox","widthType","widthTypeBox","heightType","heightTypeBox","paddingBox","spacingBox","borderBox","bgColor","tableWidth","tableHeight","cellprop","textAlign","verticalAlign","alignTop","alignMiddle","alignBottom","alignBaseline","textAlignBox","verticalAlignBox","cellWidth","cellHeight","colinsert","newRow","newCell","colinsertleft","colinsertright","rowinsert","rowIndex","rowinsertabove","rowinsertbelow","rowmerge","nextRowIndex","nextRow","nextCell","deleteCell","colmerge","nextCellIndex","rowsplit","colsplit","coldelete","rowdelete","deleteRow","htmlPath","getFilePath","selectTemplate","replaceContent","selectBox","fixToolBar","originY"],"mappings":"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","file":"kindeditor-all.js","sourceRoot":"C:/Users/liu.ping/helloReact","sourcesContent":["/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2017 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @website http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n* @version 4.1.12 (2017-10-24)\r\n*******************************************************************************/\r\n(function (window, undefined) {\r\n  if (window.KindEditor) {\r\n    return;\r\n  }\r\n\r\n\r\nif (!window.console) {\r\n  window.console = {};\r\n}\r\nif (!console.log) {\r\n  console.log = function () {};\r\n}\r\nvar _VERSION = '4.1.12 (2017-10-24)',\r\n  _ua = navigator.userAgent.toLowerCase(),\r\n  _IE = _ua.indexOf('msie') > -1 && _ua.indexOf('opera') == -1,\r\n  _NEWIE = _ua.indexOf('msie') == -1 && _ua.indexOf('trident') > -1,\r\n  _GECKO = _ua.indexOf('gecko') > -1 && _ua.indexOf('khtml') == -1,\r\n  _WEBKIT = _ua.indexOf('applewebkit') > -1,\r\n  _OPERA = _ua.indexOf('opera') > -1,\r\n  _MOBILE = _ua.indexOf('mobile') > -1,\r\n  _IOS = /ipad|iphone|ipod/.test(_ua),\r\n  _QUIRKS = document.compatMode != 'CSS1Compat',\r\n  _IERANGE = !window.getSelection,\r\n  _matches = /(?:msie|firefox|webkit|opera)[\\/:\\s](\\d+)/.exec(_ua),\r\n  _V = _matches ? _matches[1] : '0',\r\n  _TIME = new Date().getTime();\r\nfunction _isArray(val) {\r\n  if (!val) {\r\n    return false;\r\n  }\r\n  return Object.prototype.toString.call(val) === '[object Array]';\r\n}\r\nfunction _isFunction(val) {\r\n  if (!val) {\r\n    return false;\r\n  }\r\n  return Object.prototype.toString.call(val) === '[object Function]';\r\n}\r\nfunction _inArray(val, arr) {\r\n  for (var i = 0, len = arr.length; i < len; i++) {\r\n    if (val === arr[i]) {\r\n      return i;\r\n    }\r\n  }\r\n  return -1;\r\n}\r\nfunction _each(obj, fn) {\r\n  if (_isArray(obj)) {\r\n    for (var i = 0, len = obj.length; i < len; i++) {\r\n      if (fn.call(obj[i], i, obj[i]) === false) {\r\n        break;\r\n      }\r\n    }\r\n  } else {\r\n    for (var key in obj) {\r\n      if (obj.hasOwnProperty(key)) {\r\n        if (fn.call(obj[key], key, obj[key]) === false) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\nfunction _trim(str) {\r\n  return str.replace(/(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '');\r\n}\r\nfunction _inString(val, str, delimiter) {\r\n  delimiter = delimiter === undefined ? ',' : delimiter;\r\n  return (delimiter + str + delimiter).indexOf(delimiter + val + delimiter) >= 0;\r\n}\r\nfunction _addUnit(val, unit) {\r\n  unit = unit || 'px';\r\n  return val && /^-?\\d+(?:\\.\\d+)?$/.test(val) ? val + unit : val;\r\n}\r\nfunction _removeUnit(val) {\r\n  var match;\r\n  return val && (match = /(\\d+)/.exec(val)) ? parseInt(match[1], 10) : 0;\r\n}\r\nfunction _escape(val) {\r\n  return val.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n}\r\nfunction _unescape(val) {\r\n  return val.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\r\n}\r\nfunction _toCamel(str) {\r\n  var arr = str.split('-');\r\n  str = '';\r\n  _each(arr, function(key, val) {\r\n    str += (key > 0) ? val.charAt(0).toUpperCase() + val.substr(1) : val;\r\n  });\r\n  return str;\r\n}\r\nfunction _toHex(val) {\r\n  function hex(d) {\r\n    var s = parseInt(d, 10).toString(16).toUpperCase();\r\n    return s.length > 1 ? s : '0' + s;\r\n  }\r\n  return val.replace(/rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/ig,\r\n    function($0, $1, $2, $3) {\r\n      return '#' + hex($1) + hex($2) + hex($3);\r\n    }\r\n  );\r\n}\r\nfunction _toMap(val, delimiter) {\r\n  delimiter = delimiter === undefined ? ',' : delimiter;\r\n  var map = {}, arr = _isArray(val) ? val : val.split(delimiter), match;\r\n  _each(arr, function(key, val) {\r\n    if ((match = /^(\\d+)\\.\\.(\\d+)$/.exec(val))) {\r\n      for (var i = parseInt(match[1], 10); i <= parseInt(match[2], 10); i++) {\r\n        map[i.toString()] = true;\r\n      }\r\n    } else {\r\n      map[val] = true;\r\n    }\r\n  });\r\n  return map;\r\n}\r\nfunction _toArray(obj, offset) {\r\n  return Array.prototype.slice.call(obj, offset || 0);\r\n}\r\nfunction _undef(val, defaultVal) {\r\n  return val === undefined ? defaultVal : val;\r\n}\r\nfunction _invalidUrl(url) {\r\n  return !url || /[<>\"]/.test(url);\r\n}\r\nfunction _addParam(url, param) {\r\n  return url.indexOf('?') >= 0 ? url + '&' + param : url + '?' + param;\r\n}\r\nfunction _extend(child, parent, proto) {\r\n  if (!proto) {\r\n    proto = parent;\r\n    parent = null;\r\n  }\r\n  var childProto;\r\n  if (parent) {\r\n    var fn = function () {};\r\n    fn.prototype = parent.prototype;\r\n    childProto = new fn();\r\n    _each(proto, function(key, val) {\r\n      childProto[key] = val;\r\n    });\r\n  } else {\r\n    childProto = proto;\r\n  }\r\n  childProto.constructor = child;\r\n  child.prototype = childProto;\r\n  child.parent = parent ? parent.prototype : null;\r\n}\r\n\r\n\r\nfunction _json(text) {\r\n  var match;\r\n  if ((match = /\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\]/.exec(text))) {\r\n    text = match[0];\r\n  }\r\n  var cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\r\n  cx.lastIndex = 0;\r\n  if (cx.test(text)) {\r\n    text = text.replace(cx, function (a) {\r\n      return '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\r\n    });\r\n  }\r\n  if (/^[\\],:{}\\s]*$/.\r\n  test(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').\r\n  replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\r\n  replace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\r\n    return eval('(' + text + ')');\r\n  }\r\n  throw 'JSON parse error';\r\n}\r\nvar _round = Math.round;\r\nvar K = {\r\n  DEBUG : false,\r\n  VERSION : _VERSION,\r\n  IE : _IE,\r\n  GECKO : _GECKO,\r\n  WEBKIT : _WEBKIT,\r\n  OPERA : _OPERA,\r\n  V : _V,\r\n  TIME : _TIME,\r\n  each : _each,\r\n  isArray : _isArray,\r\n  isFunction : _isFunction,\r\n  inArray : _inArray,\r\n  inString : _inString,\r\n  trim : _trim,\r\n  addUnit : _addUnit,\r\n  removeUnit : _removeUnit,\r\n  escape : _escape,\r\n  unescape : _unescape,\r\n  toCamel : _toCamel,\r\n  toHex : _toHex,\r\n  toMap : _toMap,\r\n  toArray : _toArray,\r\n  undef : _undef,\r\n  invalidUrl : _invalidUrl,\r\n  addParam : _addParam,\r\n  extend : _extend,\r\n  json : _json\r\n};\r\nvar _INLINE_TAG_MAP = _toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),\r\n  _BLOCK_TAG_MAP = _toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),\r\n  _SINGLE_TAG_MAP = _toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),\r\n  _STYLE_TAG_MAP = _toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),\r\n  _CONTROL_TAG_MAP = _toMap('img,table,input,textarea,button'),\r\n  _PRE_TAG_MAP = _toMap('pre,style,script'),\r\n  _NOSPLIT_TAG_MAP = _toMap('html,head,body,td,tr,table,ol,ul,li'),\r\n  _AUTOCLOSE_TAG_MAP = _toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),\r\n  _FILL_ATTR_MAP = _toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),\r\n  _VALUE_TAG_MAP = _toMap('input,button,textarea,select');\r\n\r\n\r\nfunction _getBasePath() {\r\n  var els = document.getElementsByTagName('script'), src;\r\n  for (var i = 0, len = els.length; i < len; i++) {\r\n    src = els[i].src || '';\r\n    if (/kindeditor[\\w\\-\\.]*\\.js/.test(src)) {\r\n      return src.substring(0, src.lastIndexOf('/') + 1);\r\n    }\r\n  }\r\n  return '';\r\n}\r\nK.basePath = _getBasePath();\r\nK.options = {\r\n  designMode : true,\r\n  fullscreenMode : false,\r\n  filterMode : true,\r\n  wellFormatMode : true,\r\n  shadowMode : true,\r\n  loadStyleMode : true,\r\n  basePath : K.basePath,\r\n  themesPath : K.basePath + 'themes/',\r\n  langPath : K.basePath + 'lang/',\r\n  pluginsPath : K.basePath + 'plugins/',\r\n  themeType : 'default',\r\n  langType : 'zh-CN',\r\n  urlType : '',\r\n  newlineTag : 'p',\r\n  resizeType : 2,\r\n  syncType : 'form',\r\n  pasteType : 2,\r\n  dialogAlignType : 'page',\r\n  useContextmenu : true,\r\n  fullscreenShortcut : false,\r\n  bodyClass : 'ke-content',\r\n  indentChar : '\\t',\r\n  cssPath : '',\r\n  cssData : '',\r\n  minWidth : 650,\r\n  minHeight : 100,\r\n  minChangeSize : 50,\r\n  zIndex : 811213,\r\n  items : [\r\n    'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',\r\n    'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',\r\n    'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',\r\n    'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',\r\n    'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',\r\n    'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',\r\n    'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',\r\n    'anchor', 'link', 'unlink', '|', 'about'\r\n  ],\r\n  noDisableItems : ['source', 'fullscreen'],\r\n  colorTable : [\r\n    ['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n    ['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n    ['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n    ['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n  ],\r\n  fontSizeTable : ['9px', '10px', '12px', '14px', '16px', '18px', '24px', '32px'],\r\n  htmlTags : {\r\n    font : ['id', 'class', 'color', 'size', 'face', '.background-color'],\r\n    span : [\r\n      'id', 'class', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n      '.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.line-height'\r\n    ],\r\n    div : [\r\n      'id', 'class', 'align', '.border', '.margin', '.padding', '.text-align', '.color',\r\n      '.background-color', '.font-size', '.font-family', '.font-weight', '.background',\r\n      '.font-style', '.text-decoration', '.vertical-align', '.margin-left'\r\n    ],\r\n    table: [\r\n      'id', 'class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'bordercolor',\r\n      '.padding', '.margin', '.border', 'bgcolor', '.text-align', '.color', '.background-color',\r\n      '.font-size', '.font-family', '.font-weight', '.font-style', '.text-decoration', '.background',\r\n      '.width', '.height', '.border-collapse'\r\n    ],\r\n    'td,th': [\r\n      'id', 'class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor',\r\n      '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.font-weight',\r\n      '.font-style', '.text-decoration', '.vertical-align', '.background', '.border'\r\n    ],\r\n    a : ['id', 'class', 'href', 'target', 'name'],\r\n    embed : ['id', 'class', 'src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess', 'wmode'],\r\n    img : ['id', 'class', 'src', 'width', 'height', 'border', 'alt', 'title', 'align', '.width', '.height', '.border'],\r\n    'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : [\r\n      'id', 'class', 'align', '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n      '.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.text-indent', '.margin-left'\r\n    ],\r\n    pre : ['id', 'class'],\r\n    hr : ['id', 'class', '.page-break-after'],\r\n    'br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del' : ['id', 'class'],\r\n    iframe : ['id', 'class', 'src', 'frameborder', 'width', 'height', '.width', '.height']\r\n  },\r\n  layout : '<div class=\"container\"><div class=\"toolbar\"></div><div class=\"edit\"></div><div class=\"statusbar\"></div></div>'\r\n};\r\n\r\n\r\nvar _useCapture = false;\r\n\r\n\r\nvar _INPUT_KEY_MAP = _toMap('8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222');\r\n\r\nvar _CURSORMOVE_KEY_MAP = _toMap('33..40');\r\n\r\nvar _CHANGE_KEY_MAP = {};\r\n_each(_INPUT_KEY_MAP, function(key, val) {\r\n  _CHANGE_KEY_MAP[key] = val;\r\n});\r\n_each(_CURSORMOVE_KEY_MAP, function(key, val) {\r\n  _CHANGE_KEY_MAP[key] = val;\r\n});\r\n\r\n\r\nfunction _bindEvent(el, type, fn) {\r\n  if (el.addEventListener){\r\n    el.addEventListener(type, fn, _useCapture);\r\n  } else if (el.attachEvent){\r\n    el.attachEvent('on' + type, fn);\r\n  }\r\n}\r\n\r\nfunction _unbindEvent(el, type, fn) {\r\n  if (el.removeEventListener){\r\n    el.removeEventListener(type, fn, _useCapture);\r\n  } else if (el.detachEvent){\r\n    el.detachEvent('on' + type, fn);\r\n  }\r\n}\r\nvar _EVENT_PROPS = ('altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,' +\r\n  'data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,' +\r\n  'pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which').split(',');\r\n\r\n\r\nfunction KEvent(el, event) {\r\n  this.init(el, event);\r\n}\r\n_extend(KEvent, {\r\n  init : function(el, event) {\r\n    var self = this, doc = el.ownerDocument || el.document || el;\r\n    self.event = event;\r\n    _each(_EVENT_PROPS, function(key, val) {\r\n      self[val] = event[val];\r\n    });\r\n    if (!self.target) {\r\n      self.target = self.srcElement || doc;\r\n    }\r\n    if (self.target.nodeType === 3) {\r\n      self.target = self.target.parentNode;\r\n    }\r\n    if (!self.relatedTarget && self.fromElement) {\r\n      self.relatedTarget = self.fromElement === self.target ? self.toElement : self.fromElement;\r\n    }\r\n    if (self.pageX == null && self.clientX != null) {\r\n      var d = doc.documentElement, body = doc.body;\r\n      self.pageX = self.clientX + (d && d.scrollLeft || body && body.scrollLeft || 0) - (d && d.clientLeft || body && body.clientLeft || 0);\r\n      self.pageY = self.clientY + (d && d.scrollTop  || body && body.scrollTop  || 0) - (d && d.clientTop  || body && body.clientTop  || 0);\r\n    }\r\n    if (!self.which && ((self.charCode || self.charCode === 0) ? self.charCode : self.keyCode)) {\r\n      self.which = self.charCode || self.keyCode;\r\n    }\r\n    if (!self.metaKey && self.ctrlKey) {\r\n      self.metaKey = self.ctrlKey;\r\n    }\r\n    if (!self.which && self.button !== undefined) {\r\n      self.which = (self.button & 1 ? 1 : (self.button & 2 ? 3 : (self.button & 4 ? 2 : 0)));\r\n    }\r\n    switch (self.which) {\r\n    case 186 :\r\n      self.which = 59;\r\n      break;\r\n    case 187 :\r\n    case 107 :\r\n    case 43 :\r\n      self.which = 61;\r\n      break;\r\n    case 189 :\r\n    case 45 :\r\n      self.which = 109;\r\n      break;\r\n    case 42 :\r\n      self.which = 106;\r\n      break;\r\n    case 47 :\r\n      self.which = 111;\r\n      break;\r\n    case 78 :\r\n      self.which = 110;\r\n      break;\r\n    }\r\n    if (self.which >= 96 && self.which <= 105) {\r\n      self.which -= 48;\r\n    }\r\n  },\r\n  preventDefault : function() {\r\n    var ev = this.event;\r\n    if (ev.preventDefault) {\r\n      ev.preventDefault();\r\n    } else {\r\n      ev.returnValue = false;\r\n    }\r\n  },\r\n  stopPropagation : function() {\r\n    var ev = this.event;\r\n    if (ev.stopPropagation) {\r\n      ev.stopPropagation();\r\n    } else {\r\n      ev.cancelBubble = true;\r\n    }\r\n  },\r\n  stop : function() {\r\n    this.preventDefault();\r\n    this.stopPropagation();\r\n  }\r\n});\r\nvar _eventExpendo = 'kindeditor_' + _TIME, _eventId = 0, _eventData = {};\r\nfunction _getId(el) {\r\n  return el[_eventExpendo] || null;\r\n}\r\nfunction _setId(el) {\r\n  el[_eventExpendo] = ++_eventId;\r\n  return _eventId;\r\n}\r\nfunction _removeId(el) {\r\n  try {\r\n    delete el[_eventExpendo];\r\n  } catch(e) {\r\n    if (el.removeAttribute) {\r\n      el.removeAttribute(_eventExpendo);\r\n    }\r\n  }\r\n}\r\nfunction _bind(el, type, fn) {\r\n  if (type.indexOf(',') >= 0) {\r\n    _each(type.split(','), function() {\r\n      _bind(el, this, fn);\r\n    });\r\n    return;\r\n  }\r\n  var id = _getId(el);\r\n  if (!id) {\r\n    id = _setId(el);\r\n  }\r\n  if (_eventData[id] === undefined) {\r\n    _eventData[id] = {};\r\n  }\r\n  var events = _eventData[id][type];\r\n  if (events && events.length > 0) {\r\n    _unbindEvent(el, type, events[0]);\r\n  } else {\r\n    _eventData[id][type] = [];\r\n    _eventData[id].el = el;\r\n  }\r\n  events = _eventData[id][type];\r\n  if (events.length === 0) {\r\n    events[0] = function(e) {\r\n      var kevent = e ? new KEvent(el, e) : undefined;\r\n      _each(events, function(i, event) {\r\n        if (i > 0 && event) {\r\n          event.call(el, kevent);\r\n        }\r\n      });\r\n    };\r\n  }\r\n  if (_inArray(fn, events) < 0) {\r\n    events.push(fn);\r\n  }\r\n  _bindEvent(el, type, events[0]);\r\n}\r\nfunction _unbind(el, type, fn) {\r\n  if (type && type.indexOf(',') >= 0) {\r\n    _each(type.split(','), function() {\r\n      _unbind(el, this, fn);\r\n    });\r\n    return;\r\n  }\r\n  var id = _getId(el);\r\n  if (!id) {\r\n    return;\r\n  }\r\n  if (type === undefined) {\r\n    if (id in _eventData) {\r\n      _each(_eventData[id], function(key, events) {\r\n        if (key != 'el' && events.length > 0) {\r\n          _unbindEvent(el, key, events[0]);\r\n        }\r\n      });\r\n      delete _eventData[id];\r\n      _removeId(el);\r\n    }\r\n    return;\r\n  }\r\n  if (!_eventData[id]) {\r\n    return;\r\n  }\r\n  var events = _eventData[id][type];\r\n  if (events && events.length > 0) {\r\n    if (fn === undefined) {\r\n      _unbindEvent(el, type, events[0]);\r\n      delete _eventData[id][type];\r\n    } else {\r\n      _each(events, function(i, event) {\r\n        if (i > 0 && event === fn) {\r\n          events.splice(i, 1);\r\n        }\r\n      });\r\n      if (events.length == 1) {\r\n        _unbindEvent(el, type, events[0]);\r\n        delete _eventData[id][type];\r\n      }\r\n    }\r\n    var count = 0;\r\n    _each(_eventData[id], function() {\r\n      count++;\r\n    });\r\n    if (count < 2) {\r\n      delete _eventData[id];\r\n      _removeId(el);\r\n    }\r\n  }\r\n}\r\nfunction _fire(el, type) {\r\n  if (type.indexOf(',') >= 0) {\r\n    _each(type.split(','), function() {\r\n      _fire(el, this);\r\n    });\r\n    return;\r\n  }\r\n  var id = _getId(el);\r\n  if (!id) {\r\n    return;\r\n  }\r\n  var events = _eventData[id][type];\r\n  if (_eventData[id] && events && events.length > 0) {\r\n    events[0]();\r\n  }\r\n}\r\nfunction _ctrl(el, key, fn) {\r\n  var self = this;\r\n  key = /^\\d{2,}$/.test(key) ? key : key.toUpperCase().charCodeAt(0);\r\n  _bind(el, 'keydown', function(e) {\r\n    if (e.ctrlKey && e.which == key && !e.shiftKey && !e.altKey) {\r\n      fn.call(el);\r\n      e.stop();\r\n    }\r\n  });\r\n}\r\nvar _readyFinished = false;\r\nfunction _ready(fn) {\r\n  if (_readyFinished) {\r\n    fn(KindEditor);\r\n    return;\r\n  }\r\n  var loaded = false;\r\n  function readyFunc() {\r\n    if (!loaded) {\r\n      loaded = true;\r\n      fn(KindEditor);\r\n      _readyFinished = true;\r\n    }\r\n  }\r\n  function ieReadyFunc() {\r\n    if (!loaded) {\r\n      try {\r\n        document.documentElement.doScroll('left');\r\n      } catch(e) {\r\n        setTimeout(ieReadyFunc, 100);\r\n        return;\r\n      }\r\n      readyFunc();\r\n    }\r\n  }\r\n  function ieReadyStateFunc() {\r\n    if (document.readyState === 'complete') {\r\n      readyFunc();\r\n    }\r\n  }\r\n  if (document.addEventListener) {\r\n    _bind(document, 'DOMContentLoaded', readyFunc);\r\n  } else if (document.attachEvent) {\r\n    _bind(document, 'readystatechange', ieReadyStateFunc);\r\n    var toplevel = false;\r\n    try {\r\n      toplevel = window.frameElement == null;\r\n    } catch(e) {}\r\n    if (document.documentElement.doScroll && toplevel) {\r\n      ieReadyFunc();\r\n    }\r\n  }\r\n  _bind(window, 'load', readyFunc);\r\n}\r\nif (window.attachEvent) {\r\n  window.attachEvent('onunload', function() {\r\n    _each(_eventData, function(key, events) {\r\n      if (events.el) {\r\n        _unbind(events.el);\r\n      }\r\n    });\r\n  });\r\n}\r\nK.ctrl = _ctrl;\r\nK.ready = _ready;\r\n\r\nfunction _getCssList(css) {\r\n  css = css.replace(/&quot;/g, '\"');\r\n  var list = {},\r\n    reg = /\\s*([\\w\\-]+)\\s*:([^;]*)(;|$)/g,\r\n    match;\r\n  while ((match = reg.exec(css))) {\r\n    var key = _trim(match[1].toLowerCase()),\r\n      val = _trim(_toHex(match[2]));\r\n    list[key] = val;\r\n  }\r\n  return list;\r\n}\r\nfunction _getAttrList(tag) {\r\n  var list = {},\r\n    reg = /\\s+(?:([\\w\\-:]+)|(?:([\\w\\-:]+)=([^\\s\"'<>]+))|(?:([\\w\\-:\"]+)=\"([^\"]*)\")|(?:([\\w\\-:\"]+)='([^']*)'))(?=(?:\\s|\\/|>)+)/g,\r\n    match;\r\n  while ((match = reg.exec(tag))) {\r\n    var key = (match[1] || match[2] || match[4] || match[6]).toLowerCase(),\r\n      val = (match[2] ? match[3] : (match[4] ? match[5] : match[7])) || '';\r\n    list[key] = val;\r\n  }\r\n  return list;\r\n}\r\nfunction _addClassToTag(tag, className) {\r\n  if (/\\s+class\\s*=/.test(tag)) {\r\n    tag = tag.replace(/(\\s+class=[\"']?)([^\"']*)([\"']?[\\s>])/, function($0, $1, $2, $3) {\r\n      if ((' ' + $2 + ' ').indexOf(' ' + className + ' ') < 0) {\r\n        return $2 === '' ? $1 + className + $3 : $1 + $2 + ' ' + className + $3;\r\n      } else {\r\n        return $0;\r\n      }\r\n    });\r\n  } else {\r\n    tag = tag.substr(0, tag.length - 1) + ' class=\"' + className + '\">';\r\n  }\r\n  return tag;\r\n}\r\nfunction _formatCss(css) {\r\n  var str = '';\r\n  _each(_getCssList(css), function(key, val) {\r\n    str += key + ':' + val + ';';\r\n  });\r\n  return str;\r\n}\r\nfunction _formatUrl(url, mode, host, pathname) {\r\n  mode = _undef(mode, '').toLowerCase();\r\n  if (url.substr(0, 5) != 'data:') {\r\n    url = url.replace(/([^:])\\/\\//g, '$1/');\r\n  }\r\n  if (_inArray(mode, ['absolute', 'relative', 'domain']) < 0) {\r\n    return url;\r\n  }\r\n  host = host || location.protocol + '//' + location.host;\r\n  if (pathname === undefined) {\r\n    var m = location.pathname.match(/^(\\/.*)\\//);\r\n    pathname = m ? m[1] : '';\r\n  }\r\n  var match;\r\n  if ((match = /^(\\w+:\\/\\/[^\\/]*)/.exec(url))) {\r\n    if (match[1] !== host) {\r\n      return url;\r\n    }\r\n  } else if (/^\\w+:/.test(url)) {\r\n    return url;\r\n  }\r\n  function getRealPath(path) {\r\n    var parts = path.split('/'), paths = [];\r\n    for (var i = 0, len = parts.length; i < len; i++) {\r\n      var part = parts[i];\r\n      if (part == '..') {\r\n        if (paths.length > 0) {\r\n          paths.pop();\r\n        }\r\n      } else if (part !== '' && part != '.') {\r\n        paths.push(part);\r\n      }\r\n    }\r\n    return '/' + paths.join('/');\r\n  }\r\n  if (/^\\//.test(url)) {\r\n    url = host + getRealPath(url.substr(1));\r\n  } else if (!/^\\w+:\\/\\//.test(url)) {\r\n    url = host + getRealPath(pathname + '/' + url);\r\n  }\r\n  function getRelativePath(path, depth) {\r\n    if (url.substr(0, path.length) === path) {\r\n      var arr = [];\r\n      for (var i = 0; i < depth; i++) {\r\n        arr.push('..');\r\n      }\r\n      var prefix = '.';\r\n      if (arr.length > 0) {\r\n        prefix += '/' + arr.join('/');\r\n      }\r\n      if (pathname == '/') {\r\n        prefix += '/';\r\n      }\r\n      return prefix + url.substr(path.length);\r\n    } else {\r\n      if ((match = /^(.*)\\//.exec(path))) {\r\n        return getRelativePath(match[1], ++depth);\r\n      }\r\n    }\r\n  }\r\n  if (mode === 'relative') {\r\n    url = getRelativePath(host + pathname, 0).substr(2);\r\n  } else if (mode === 'absolute') {\r\n    if (url.substr(0, host.length) === host) {\r\n      url = url.substr(host.length);\r\n    }\r\n  }\r\n  return url;\r\n}\r\nfunction _formatHtml(html, htmlTags, urlType, wellFormatted, indentChar) {\r\n  if (html == null) {\r\n    html = '';\r\n  }\r\n  urlType = urlType || '';\r\n  wellFormatted = _undef(wellFormatted, false);\r\n  indentChar = _undef(indentChar, '\\t');\r\n  var fontSizeList = 'xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');\r\n  html = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n    return $1 + $2.replace(/<(?:br|br\\s[^>]*)>/ig, '\\n') + $3;\r\n  });\r\n  html = html.replace(/<(?:br|br\\s[^>]*)\\s*\\/?>\\s*<\\/p>/ig, '</p>');\r\n  html = html.replace(/(<(?:p|p\\s[^>]*)>)\\s*(<\\/p>)/ig, '$1<br />$2');\r\n  html = html.replace(/\\u200B/g, '');\r\n  html = html.replace(/\\u00A9/g, '&copy;');\r\n  html = html.replace(/\\u00AE/g, '&reg;');\r\n  html = html.replace(/\\u2003/g, '&emsp;');\r\n  html = html.replace(/\\u3000/g, '&emsp;');\r\n  html = html.replace(/<[^>]+/g, function($0) {\r\n    return $0.replace(/\\s+/g, ' ');\r\n  });\r\n  var htmlTagMap = {};\r\n  if (htmlTags) {\r\n    _each(htmlTags, function(key, val) {\r\n      var arr = key.split(',');\r\n      for (var i = 0, len = arr.length; i < len; i++) {\r\n        htmlTagMap[arr[i]] = _toMap(val);\r\n      }\r\n    });\r\n    if (!htmlTagMap.script) {\r\n      html = html.replace(/(<(?:script|script\\s[^>]*)>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n    }\r\n    if (!htmlTagMap.style) {\r\n      html = html.replace(/(<(?:style|style\\s[^>]*)>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n    }\r\n  }\r\n  var re = /(\\s*)<(\\/)?([\\w\\-:]+)((?:\\s+|(?:\\s+[\\w\\-:]+)|(?:\\s+[\\w\\-:]+=[^\\s\"'<>]+)|(?:\\s+[\\w\\-:\"]+=\"[^\"]*\")|(?:\\s+[\\w\\-:\"]+='[^']*'))*)(\\/)?>(\\s*)/g;\r\n  var tagStack = [];\r\n  html = html.replace(re, function($0, $1, $2, $3, $4, $5, $6) {\r\n    var full = $0,\r\n      startNewline = $1 || '',\r\n      startSlash = $2 || '',\r\n      tagName = $3.toLowerCase(),\r\n      attr = $4 || '',\r\n      endSlash = $5 ? ' ' + $5 : '',\r\n      endNewline = $6 || '';\r\n    if (htmlTags && !htmlTagMap[tagName]) {\r\n      return '';\r\n    }\r\n    if (endSlash === '' && _SINGLE_TAG_MAP[tagName]) {\r\n      endSlash = ' /';\r\n    }\r\n    if (_INLINE_TAG_MAP[tagName]) {\r\n      if (startNewline) {\r\n        startNewline = ' ';\r\n      }\r\n      if (endNewline) {\r\n        endNewline = ' ';\r\n      }\r\n    }\r\n    if (_PRE_TAG_MAP[tagName]) {\r\n      if (startSlash) {\r\n        endNewline = '\\n';\r\n      } else {\r\n        startNewline = '\\n';\r\n      }\r\n    }\r\n    if (wellFormatted && tagName == 'br') {\r\n      endNewline = '\\n';\r\n    }\r\n    if (_BLOCK_TAG_MAP[tagName] && !_PRE_TAG_MAP[tagName]) {\r\n      if (wellFormatted) {\r\n        if (startSlash && tagStack.length > 0 && tagStack[tagStack.length - 1] === tagName) {\r\n          tagStack.pop();\r\n        } else {\r\n          tagStack.push(tagName);\r\n        }\r\n        startNewline = '\\n';\r\n        endNewline = '\\n';\r\n        for (var i = 0, len = startSlash ? tagStack.length : tagStack.length - 1; i < len; i++) {\r\n          startNewline += indentChar;\r\n          if (!startSlash) {\r\n            endNewline += indentChar;\r\n          }\r\n        }\r\n        if (endSlash) {\r\n          tagStack.pop();\r\n        } else if (!startSlash) {\r\n          endNewline += indentChar;\r\n        }\r\n      } else {\r\n        startNewline = endNewline = '';\r\n      }\r\n    }\r\n    if (attr !== '') {\r\n      var attrMap = _getAttrList(full);\r\n      if (tagName === 'font') {\r\n        var fontStyleMap = {}, fontStyle = '';\r\n        _each(attrMap, function(key, val) {\r\n          if (key === 'color') {\r\n            fontStyleMap.color = val;\r\n            delete attrMap[key];\r\n          }\r\n          if (key === 'size') {\r\n            fontStyleMap['font-size'] = fontSizeList[parseInt(val, 10) - 1] || '';\r\n            delete attrMap[key];\r\n          }\r\n          if (key === 'face') {\r\n            fontStyleMap['font-family'] = val;\r\n            delete attrMap[key];\r\n          }\r\n          if (key === 'style') {\r\n            fontStyle = val;\r\n          }\r\n        });\r\n        if (fontStyle && !/;$/.test(fontStyle)) {\r\n          fontStyle += ';';\r\n        }\r\n        _each(fontStyleMap, function(key, val) {\r\n          if (val === '') {\r\n            return;\r\n          }\r\n          if (/\\s/.test(val)) {\r\n            val = \"'\" + val + \"'\";\r\n          }\r\n          fontStyle += key + ':' + val + ';';\r\n        });\r\n        attrMap.style = fontStyle;\r\n      }\r\n      _each(attrMap, function(key, val) {\r\n        if (_FILL_ATTR_MAP[key]) {\r\n          attrMap[key] = key;\r\n        }\r\n        if (_inArray(key, ['src', 'href']) >= 0) {\r\n          attrMap[key] = _formatUrl(val, urlType);\r\n        }\r\n        if (htmlTags && key !== 'style' && !htmlTagMap[tagName]['*'] && !htmlTagMap[tagName][key] ||\r\n          tagName === 'body' && key === 'contenteditable' ||\r\n          /^kindeditor_\\d+$/.test(key)) {\r\n          delete attrMap[key];\r\n        }\r\n        if (key === 'style' && val !== '') {\r\n          var styleMap = _getCssList(val);\r\n          _each(styleMap, function(k, v) {\r\n            if (htmlTags && !htmlTagMap[tagName].style && !htmlTagMap[tagName]['.' + k]) {\r\n              delete styleMap[k];\r\n            }\r\n          });\r\n          var style = '';\r\n          _each(styleMap, function(k, v) {\r\n            style += k + ':' + v + ';';\r\n          });\r\n          attrMap.style = style;\r\n        }\r\n      });\r\n      attr = '';\r\n      _each(attrMap, function(key, val) {\r\n        if (key === 'style' && val === '') {\r\n          return;\r\n        }\r\n        val = val.replace(/\"/g, '&quot;');\r\n        attr += ' ' + key + '=\"' + val + '\"';\r\n      });\r\n    }\r\n    if (tagName === 'font') {\r\n      tagName = 'span';\r\n    }\r\n    return startNewline + '<' + startSlash + tagName + attr + endSlash + '>' + endNewline;\r\n  });\r\n  html = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n    return $1 + $2.replace(/\\n/g, '<span id=\"__kindeditor_pre_newline__\">\\n') + $3;\r\n  });\r\n  html = html.replace(/\\n\\s*\\n/g, '\\n');\r\n  html = html.replace(/<span id=\"__kindeditor_pre_newline__\">\\n/g, '\\n');\r\n  return _trim(html);\r\n}\r\n\r\nfunction _clearMsWord(html, htmlTags) {\r\n  html = html.replace(/<meta[\\s\\S]*?>/ig, '')\r\n    .replace(/<![\\s\\S]*?>/ig, '')\r\n    .replace(/<style[^>]*>[\\s\\S]*?<\\/style>/ig, '')\r\n    .replace(/<script[^>]*>[\\s\\S]*?<\\/script>/ig, '')\r\n    .replace(/<w:[^>]+>[\\s\\S]*?<\\/w:[^>]+>/ig, '')\r\n    .replace(/<o:[^>]+>[\\s\\S]*?<\\/o:[^>]+>/ig, '')\r\n    .replace(/<xml>[\\s\\S]*?<\\/xml>/ig, '')\r\n    .replace(/<(?:table|td)[^>]*>/ig, function(full) {\r\n      return full.replace(/border-bottom:([#\\w\\s]+)/ig, 'border:$1');\r\n    });\r\n  return _formatHtml(html, htmlTags);\r\n}\r\n\r\nfunction _mediaType(src) {\r\n  if (/\\.(swf|flv)(\\?|$)/i.test(src)) {\r\n    return 'application/x-shockwave-flash';\r\n  }\r\n  return ''\r\n  // if (/\\.(rm|rmvb)(\\?|$)/i.test(src)) {\r\n  //   return 'audio/x-pn-realaudio-plugin';\r\n  // }\r\n  // return 'video/x-ms-asf-plugin';\r\n}\r\n\r\nfunction _mediaClass(type) {\r\n  if (/realaudio/i.test(type)) {\r\n    return 'ke-rm';\r\n  }\r\n  if (/flash/i.test(type)) {\r\n    return 'ke-flash';\r\n  }\r\n  return 'ke-media';\r\n}\r\nfunction _mediaAttrs(srcTag) {\r\n  return _getAttrList(unescape(srcTag));\r\n}\r\nfunction _mediaEmbed(attrs) {\r\n  var html = '<embed ';\r\n  console.log('attrs1:', attrs)\r\n  attrs.play = false\r\n  attrs.align = 'bottom'\r\n  attrs.menu = \"false\"\r\n  attrs.hidden = \"true\"\r\n  attrs.flashvars = \"autoplay=false&play=false&isAutoPlay=False\"\r\n\r\n  _each(attrs, function(key, val) {\r\n\r\n    html += key + '=\"' + val + '\" ';\r\n  });\r\n  html += '/>';\r\n  return html;\r\n}\r\nfunction _mediaImg(blankPath, attrs) {\r\n  var width = attrs.width,\r\n    height = attrs.height,\r\n    type = attrs.type || _mediaType(attrs.src),\r\n    srcTag = _mediaEmbed(attrs),\r\n    style = '';\r\n  if (/\\D/.test(width)) {\r\n    style += 'width:' + width + ';';\r\n  } else if (width > 0) {\r\n    style += 'width:' + width + 'px;';\r\n  }\r\n  if (/\\D/.test(height)) {\r\n    style += 'height:' + height + ';';\r\n  } else if (height > 0) {\r\n    style += 'height:' + height + 'px;';\r\n  }\r\n  var html = '<img class=\"' + _mediaClass(type) + '\" src=\"' + blankPath + '\" ';\r\n  if (style !== '') {\r\n    html += 'style=\"' + style + '\" ';\r\n  }\r\n  html += 'data-ke-tag=\"' + escape(srcTag) + '\" alt=\"\" />';\r\n  return html;\r\n}\r\n\r\n\r\n\r\n\r\nfunction _tmpl(str, data) {\r\n  var fn = new Function(\"obj\",\r\n    \"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n    \"with(obj){p.push('\" +\r\n    str.replace(/[\\r\\t\\n]/g, \" \")\r\n      .split(\"<%\").join(\"\\t\")\r\n      .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n      .replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n      .split(\"\\t\").join(\"');\")\r\n      .split(\"%>\").join(\"p.push('\")\r\n      .split(\"\\r\").join(\"\\\\'\") + \"');}return p.join('');\");\r\n  return data ? fn(data) : fn;\r\n}\r\nK.formatUrl = _formatUrl;\r\nK.formatHtml = _formatHtml;\r\nK.getCssList = _getCssList;\r\nK.getAttrList = _getAttrList;\r\nK.mediaType = _mediaType;\r\nK.mediaAttrs = _mediaAttrs;\r\nK.mediaEmbed = _mediaEmbed;\r\nK.mediaImg = _mediaImg;\r\nK.clearMsWord = _clearMsWord;\r\nK.tmpl = _tmpl;\r\n\r\n\r\nfunction _contains(nodeA, nodeB) {\r\n  if (nodeA.nodeType == 9 && nodeB.nodeType != 9) {\r\n    return true;\r\n  }\r\n  while ((nodeB = nodeB.parentNode)) {\r\n    if (nodeB == nodeA) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\nvar _getSetAttrDiv = document.createElement('div');\r\n_getSetAttrDiv.setAttribute('className', 't');\r\nvar _GET_SET_ATTRIBUTE = _getSetAttrDiv.className !== 't';\r\nfunction _getAttr(el, key) {\r\n  key = key.toLowerCase();\r\n  var val = null;\r\n  if (!_GET_SET_ATTRIBUTE && el.nodeName.toLowerCase() != 'script') {\r\n    var div = el.ownerDocument.createElement('div');\r\n    div.appendChild(el.cloneNode(false));\r\n    var list = _getAttrList(_unescape(div.innerHTML));\r\n    if (key in list) {\r\n      val = list[key];\r\n    }\r\n  } else {\r\n    try {\r\n      val = el.getAttribute(key, 2);\r\n    } catch(e) {\r\n      val = el.getAttribute(key, 1);\r\n    }\r\n  }\r\n  if (key === 'style' && val !== null) {\r\n    val = _formatCss(val);\r\n  }\r\n  return val;\r\n}\r\nfunction _queryAll(expr, root) {\r\n  var exprList = expr.split(',');\r\n  if (exprList.length > 1) {\r\n    var mergedResults = [];\r\n    _each(exprList, function() {\r\n      _each(_queryAll(this, root), function() {\r\n        if (_inArray(this, mergedResults) < 0) {\r\n          mergedResults.push(this);\r\n        }\r\n      });\r\n    });\r\n    return mergedResults;\r\n  }\r\n  root = root || document;\r\n  function escape(str) {\r\n    if (typeof str != 'string') {\r\n      return str;\r\n    }\r\n    return str.replace(/([^\\w\\-])/g, '\\\\$1');\r\n  }\r\n  function stripslashes(str) {\r\n    return str.replace(/\\\\/g, '');\r\n  }\r\n  function cmpTag(tagA, tagB) {\r\n    return tagA === '*' || tagA.toLowerCase() === escape(tagB.toLowerCase());\r\n  }\r\n  function byId(id, tag, root) {\r\n    var arr = [],\r\n      doc = root.ownerDocument || root,\r\n      el = doc.getElementById(stripslashes(id));\r\n    if (el) {\r\n      if (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n        arr.push(el);\r\n      }\r\n    }\r\n    return arr;\r\n  }\r\n  function byClass(className, tag, root) {\r\n    var doc = root.ownerDocument || root, arr = [], els, i, len, el;\r\n    if (root.getElementsByClassName) {\r\n      els = root.getElementsByClassName(stripslashes(className));\r\n      for (i = 0, len = els.length; i < len; i++) {\r\n        el = els[i];\r\n        if (cmpTag(tag, el.nodeName)) {\r\n          arr.push(el);\r\n        }\r\n      }\r\n    } else if (doc.querySelectorAll) {\r\n      els = doc.querySelectorAll((root.nodeName !== '#document' ? root.nodeName + ' ' : '') + tag + '.' + className);\r\n      for (i = 0, len = els.length; i < len; i++) {\r\n        el = els[i];\r\n        if (_contains(root, el)) {\r\n          arr.push(el);\r\n        }\r\n      }\r\n    } else {\r\n      els = root.getElementsByTagName(tag);\r\n      className = ' ' + className + ' ';\r\n      for (i = 0, len = els.length; i < len; i++) {\r\n        el = els[i];\r\n        if (el.nodeType == 1) {\r\n          var cls = el.className;\r\n          if (cls && (' ' + cls + ' ').indexOf(className) > -1) {\r\n            arr.push(el);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return arr;\r\n  }\r\n  function byName(name, tag, root) {\r\n    var arr = [], doc = root.ownerDocument || root,\r\n      els = doc.getElementsByName(stripslashes(name)), el;\r\n    for (var i = 0, len = els.length; i < len; i++) {\r\n      el = els[i];\r\n      if (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n        if (el.getAttribute('name') !== null) {\r\n          arr.push(el);\r\n        }\r\n      }\r\n    }\r\n    return arr;\r\n  }\r\n  function byAttr(key, val, tag, root) {\r\n    var arr = [], els = root.getElementsByTagName(tag), el;\r\n    for (var i = 0, len = els.length; i < len; i++) {\r\n      el = els[i];\r\n      if (el.nodeType == 1) {\r\n        if (val === null) {\r\n          if (_getAttr(el, key) !== null) {\r\n            arr.push(el);\r\n          }\r\n        } else {\r\n          if (val === escape(_getAttr(el, key))) {\r\n            arr.push(el);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return arr;\r\n  }\r\n  function select(expr, root) {\r\n    var arr = [], matches;\r\n    matches = /^((?:\\\\.|[^.#\\s\\[<>])+)/.exec(expr);\r\n    var tag = matches ? matches[1] : '*';\r\n    if ((matches = /#((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n      arr = byId(matches[1], tag, root);\r\n    } else if ((matches = /\\.((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n      arr = byClass(matches[1], tag, root);\r\n    } else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\]/.exec(expr))) {\r\n      arr = byAttr(matches[1].toLowerCase(), null, tag, root);\r\n    } else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\s*=\\s*['\"]?((?:\\\\.|[^'\"]+)+)['\"]?\\]/.exec(expr))) {\r\n      var key = matches[1].toLowerCase(), val = matches[2];\r\n      if (key === 'id') {\r\n        arr = byId(val, tag, root);\r\n      } else if (key === 'class') {\r\n        arr = byClass(val, tag, root);\r\n      } else if (key === 'name') {\r\n        arr = byName(val, tag, root);\r\n      } else {\r\n        arr = byAttr(key, val, tag, root);\r\n      }\r\n    } else {\r\n      var els = root.getElementsByTagName(tag), el;\r\n      for (var i = 0, len = els.length; i < len; i++) {\r\n        el = els[i];\r\n        if (el.nodeType == 1) {\r\n          arr.push(el);\r\n        }\r\n      }\r\n    }\r\n    return arr;\r\n  }\r\n  var parts = [], arr, re = /((?:\\\\.|[^\\s>])+|[\\s>])/g;\r\n  while ((arr = re.exec(expr))) {\r\n    if (arr[1] !== ' ') {\r\n      parts.push(arr[1]);\r\n    }\r\n  }\r\n  var results = [];\r\n  if (parts.length == 1) {\r\n    return select(parts[0], root);\r\n  }\r\n  var isChild = false, part, els, subResults, val, v, i, j, k, length, len, l;\r\n  for (i = 0, length = parts.length; i < length; i++) {\r\n    part = parts[i];\r\n    if (part === '>') {\r\n      isChild = true;\r\n      continue;\r\n    }\r\n    if (i > 0) {\r\n      els = [];\r\n      for (j = 0, len = results.length; j < len; j++) {\r\n        val = results[j];\r\n        subResults = select(part, val);\r\n        for (k = 0, l = subResults.length; k < l; k++) {\r\n          v = subResults[k];\r\n          if (isChild) {\r\n            if (val === v.parentNode) {\r\n              els.push(v);\r\n            }\r\n          } else {\r\n            els.push(v);\r\n          }\r\n        }\r\n      }\r\n      results = els;\r\n    } else {\r\n      results = select(part, root);\r\n    }\r\n    if (results.length === 0) {\r\n      return [];\r\n    }\r\n  }\r\n  return results;\r\n}\r\nfunction _query(expr, root) {\r\n  var arr = _queryAll(expr, root);\r\n  return arr.length > 0 ? arr[0] : null;\r\n}\r\nK.query = _query;\r\nK.queryAll = _queryAll;\r\n\r\n\r\nfunction _get(val) {\r\n  return K(val)[0];\r\n}\r\nfunction _getDoc(node) {\r\n  if (!node) {\r\n    return document;\r\n  }\r\n  return node.ownerDocument || node.document || node;\r\n}\r\nfunction _getWin(node) {\r\n  if (!node) {\r\n    return window;\r\n  }\r\n  var doc = _getDoc(node);\r\n  return doc.parentWindow || doc.defaultView;\r\n}\r\nfunction _setHtml(el, html) {\r\n  if (el.nodeType != 1) {\r\n    return;\r\n  }\r\n  var doc = _getDoc(el);\r\n  try {\r\n    el.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + html;\r\n    var temp = doc.getElementById('__kindeditor_temp_tag__');\r\n    temp.parentNode.removeChild(temp);\r\n  } catch(e) {\r\n    K(el).empty();\r\n    K('@' + html, doc).each(function() {\r\n      el.appendChild(this);\r\n    });\r\n  }\r\n}\r\nfunction _hasClass(el, cls) {\r\n  return _inString(cls, el.className, ' ');\r\n}\r\nfunction _setAttr(el, key, val) {\r\n  if (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n    key = 'className';\r\n  }\r\n  el.setAttribute(key, '' + val);\r\n}\r\nfunction _removeAttr(el, key) {\r\n  if (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n    key = 'className';\r\n  }\r\n  _setAttr(el, key, '');\r\n  el.removeAttribute(key);\r\n}\r\nfunction _getNodeName(node) {\r\n  if (!node || !node.nodeName) {\r\n    return '';\r\n  }\r\n  return node.nodeName.toLowerCase();\r\n}\r\nfunction _computedCss(el, key) {\r\n  var self = this, win = _getWin(el), camelKey = _toCamel(key), val = '';\r\n  if (win.getComputedStyle) {\r\n    var style = win.getComputedStyle(el, null);\r\n    val = style[camelKey] || style.getPropertyValue(key) || el.style[camelKey];\r\n  } else if (el.currentStyle) {\r\n    val = el.currentStyle[camelKey] || el.style[camelKey];\r\n  }\r\n  return val;\r\n}\r\nfunction _hasVal(node) {\r\n  return !!_VALUE_TAG_MAP[_getNodeName(node)];\r\n}\r\nfunction _docElement(doc) {\r\n  doc = doc || document;\r\n  return _QUIRKS ? doc.body : doc.documentElement;\r\n}\r\nfunction _docHeight(doc) {\r\n  var el = _docElement(doc);\r\n  return Math.max(el.scrollHeight, el.clientHeight);\r\n}\r\nfunction _docWidth(doc) {\r\n  var el = _docElement(doc);\r\n  return Math.max(el.scrollWidth, el.clientWidth);\r\n}\r\nfunction _getScrollPos(doc) {\r\n  doc = doc || document;\r\n  var x, y;\r\n  if (_IE || _NEWIE || _OPERA) {\r\n    x = _docElement(doc).scrollLeft;\r\n    y = _docElement(doc).scrollTop;\r\n  } else {\r\n    x = _getWin(doc).scrollX;\r\n    y = _getWin(doc).scrollY;\r\n  }\r\n  return {x : x, y : y};\r\n}\r\n\r\n\r\nfunction KNode(node) {\r\n  this.init(node);\r\n}\r\n_extend(KNode, {\r\n  init : function(node) {\r\n    var self = this;\r\n    node = _isArray(node) ? node : [node];\r\n    var length = 0;\r\n    for (var i = 0, len = node.length; i < len; i++) {\r\n      if (node[i]) {\r\n        self[i] = node[i].constructor === KNode ? node[i][0] : node[i];\r\n        length++;\r\n      }\r\n    }\r\n    self.length = length;\r\n    self.doc = _getDoc(self[0]);\r\n    self.name = _getNodeName(self[0]);\r\n    self.type = self.length > 0 ? self[0].nodeType : null;\r\n    self.win = _getWin(self[0]);\r\n  },\r\n  each : function(fn) {\r\n    var self = this;\r\n    for (var i = 0; i < self.length; i++) {\r\n      if (fn.call(self[i], i, self[i]) === false) {\r\n        return self;\r\n      }\r\n    }\r\n    return self;\r\n  },\r\n  bind : function(type, fn) {\r\n    this.each(function() {\r\n      _bind(this, type, fn);\r\n    });\r\n    return this;\r\n  },\r\n  unbind : function(type, fn) {\r\n    this.each(function() {\r\n      _unbind(this, type, fn);\r\n    });\r\n    return this;\r\n  },\r\n  fire : function(type) {\r\n    if (this.length < 1) {\r\n      return this;\r\n    }\r\n    _fire(this[0], type);\r\n    return this;\r\n  },\r\n  hasAttr : function(key) {\r\n    if (this.length < 1) {\r\n      return false;\r\n    }\r\n    return !!_getAttr(this[0], key);\r\n  },\r\n  attr : function(key, val) {\r\n    var self = this;\r\n    if (key === undefined) {\r\n      return _getAttrList(self.outer());\r\n    }\r\n    if (typeof key === 'object') {\r\n      _each(key, function(k, v) {\r\n        self.attr(k, v);\r\n      });\r\n      return self;\r\n    }\r\n    if (val === undefined) {\r\n      val = self.length < 1 ? null : _getAttr(self[0], key);\r\n      return val === null ? '' : val;\r\n    }\r\n    self.each(function() {\r\n      _setAttr(this, key, val);\r\n    });\r\n    return self;\r\n  },\r\n  removeAttr : function(key) {\r\n    this.each(function() {\r\n      _removeAttr(this, key);\r\n    });\r\n    return this;\r\n  },\r\n  get : function(i) {\r\n    if (this.length < 1) {\r\n      return null;\r\n    }\r\n    return this[i || 0];\r\n  },\r\n  eq : function(i) {\r\n    if (this.length < 1) {\r\n      return null;\r\n    }\r\n    return this[i] ? new KNode(this[i]) : null;\r\n  },\r\n  hasClass : function(cls) {\r\n    if (this.length < 1) {\r\n      return false;\r\n    }\r\n    return _hasClass(this[0], cls);\r\n  },\r\n  addClass : function(cls) {\r\n    this.each(function() {\r\n      if (!_hasClass(this, cls)) {\r\n        this.className = _trim(this.className + ' ' + cls);\r\n      }\r\n    });\r\n    return this;\r\n  },\r\n  removeClass : function(cls) {\r\n    this.each(function() {\r\n      if (_hasClass(this, cls)) {\r\n        this.className = _trim(this.className.replace(new RegExp('(^|\\\\s)' + cls + '(\\\\s|$)'), ' '));\r\n      }\r\n    });\r\n    return this;\r\n  },\r\n  html : function(val) {\r\n    var self = this;\r\n    if (val === undefined) {\r\n      if (self.length < 1 || self.type != 1) {\r\n        return '';\r\n      }\r\n      return _formatHtml(self[0].innerHTML);\r\n    }\r\n    self.each(function() {\r\n      _setHtml(this, val);\r\n    });\r\n    return self;\r\n  },\r\n  text : function() {\r\n    var self = this;\r\n    if (self.length < 1) {\r\n      return '';\r\n    }\r\n    return _IE ? self[0].innerText : self[0].textContent;\r\n  },\r\n  hasVal : function() {\r\n    if (this.length < 1) {\r\n      return false;\r\n    }\r\n    return _hasVal(this[0]);\r\n  },\r\n  val : function(val) {\r\n    var self = this;\r\n    if (val === undefined) {\r\n      if (self.length < 1) {\r\n        return '';\r\n      }\r\n      return self.hasVal() ? self[0].value : self.attr('value');\r\n    } else {\r\n      self.each(function() {\r\n        if (_hasVal(this)) {\r\n          this.value = val;\r\n        } else {\r\n          _setAttr(this, 'value' , val);\r\n        }\r\n      });\r\n      return self;\r\n    }\r\n  },\r\n  css : function(key, val) {\r\n    var self = this;\r\n    if (key === undefined) {\r\n      return _getCssList(self.attr('style'));\r\n    }\r\n    if (typeof key === 'object') {\r\n      _each(key, function(k, v) {\r\n        self.css(k, v);\r\n      });\r\n      return self;\r\n    }\r\n    if (val === undefined) {\r\n      if (self.length < 1) {\r\n        return '';\r\n      }\r\n      return self[0].style[_toCamel(key)] || _computedCss(self[0], key) || '';\r\n    }\r\n    self.each(function() {\r\n      this.style[_toCamel(key)] = val;\r\n    });\r\n    return self;\r\n  },\r\n  width : function(val) {\r\n    var self = this;\r\n    if (val === undefined) {\r\n      if (self.length < 1) {\r\n        return 0;\r\n      }\r\n      return self[0].offsetWidth;\r\n    }\r\n    return self.css('width', _addUnit(val));\r\n  },\r\n  height : function(val) {\r\n    var self = this;\r\n    if (val === undefined) {\r\n      if (self.length < 1) {\r\n        return 0;\r\n      }\r\n      return self[0].offsetHeight;\r\n    }\r\n    return self.css('height', _addUnit(val));\r\n  },\r\n  opacity : function(val) {\r\n    this.each(function() {\r\n      if (this.style.opacity === undefined) {\r\n        this.style.filter = val == 1 ? '' : 'alpha(opacity=' + (val * 100) + ')';\r\n      } else {\r\n        this.style.opacity = val == 1 ? '' : val;\r\n      }\r\n    });\r\n    return this;\r\n  },\r\n  data : function(key, val) {\r\n    var self = this;\r\n    key = 'kindeditor_data_' + key;\r\n    if (val === undefined) {\r\n      if (self.length < 1) {\r\n        return null;\r\n      }\r\n      return self[0][key];\r\n    }\r\n    this.each(function() {\r\n      this[key] = val;\r\n    });\r\n    return self;\r\n  },\r\n  pos : function() {\r\n    var self = this, node = self[0], x = 0, y = 0;\r\n    if (node) {\r\n      if (node.getBoundingClientRect) {\r\n        var box = node.getBoundingClientRect(),\r\n          pos = _getScrollPos(self.doc);\r\n        x = box.left + pos.x;\r\n        y = box.top + pos.y;\r\n      } else {\r\n        while (node) {\r\n          x += node.offsetLeft;\r\n          y += node.offsetTop;\r\n          node = node.offsetParent;\r\n        }\r\n      }\r\n    }\r\n    return {x : _round(x), y : _round(y)};\r\n  },\r\n  clone : function(bool) {\r\n    if (this.length < 1) {\r\n      return new KNode([]);\r\n    }\r\n    return new KNode(this[0].cloneNode(bool));\r\n  },\r\n  append : function(expr) {\r\n    this.each(function() {\r\n      if (this.appendChild) {\r\n        this.appendChild(_get(expr));\r\n      }\r\n    });\r\n    return this;\r\n  },\r\n  appendTo : function(expr) {\r\n    this.each(function() {\r\n      _get(expr).appendChild(this);\r\n    });\r\n    return this;\r\n  },\r\n  before : function(expr) {\r\n    this.each(function() {\r\n      this.parentNode.insertBefore(_get(expr), this);\r\n    });\r\n    return this;\r\n  },\r\n  after : function(expr) {\r\n    this.each(function() {\r\n      if (this.nextSibling) {\r\n        this.parentNode.insertBefore(_get(expr), this.nextSibling);\r\n      } else {\r\n        this.parentNode.appendChild(_get(expr));\r\n      }\r\n    });\r\n    return this;\r\n  },\r\n  replaceWith : function(expr) {\r\n    var nodes = [];\r\n    this.each(function(i, node) {\r\n      _unbind(node);\r\n      var newNode = _get(expr);\r\n      node.parentNode.replaceChild(newNode, node);\r\n      nodes.push(newNode);\r\n    });\r\n    return K(nodes);\r\n  },\r\n  empty : function() {\r\n    var self = this;\r\n    self.each(function(i, node) {\r\n      var child = node.firstChild;\r\n      while (child) {\r\n        if (!node.parentNode) {\r\n          return;\r\n        }\r\n        var next = child.nextSibling;\r\n        child.parentNode.removeChild(child);\r\n        child = next;\r\n      }\r\n    });\r\n    return self;\r\n  },\r\n  remove : function(keepChilds) {\r\n    var self = this;\r\n    self.each(function(i, node) {\r\n      if (!node.parentNode) {\r\n        return;\r\n      }\r\n      _unbind(node);\r\n      if (keepChilds) {\r\n        var child = node.firstChild;\r\n        while (child) {\r\n          var next = child.nextSibling;\r\n          node.parentNode.insertBefore(child, node);\r\n          child = next;\r\n        }\r\n      }\r\n      node.parentNode.removeChild(node);\r\n      delete self[i];\r\n    });\r\n    self.length = 0;\r\n    return self;\r\n  },\r\n  show : function(val) {\r\n    var self = this;\r\n    if (val === undefined) {\r\n      val = self._originDisplay || '';\r\n    }\r\n    if (self.css('display') != 'none') {\r\n      return self;\r\n    }\r\n    return self.css('display', val);\r\n  },\r\n  hide : function() {\r\n    var self = this;\r\n    if (self.length < 1) {\r\n      return self;\r\n    }\r\n    self._originDisplay = self[0].style.display;\r\n    return self.css('display', 'none');\r\n  },\r\n  outer : function() {\r\n    var self = this;\r\n    if (self.length < 1) {\r\n      return '';\r\n    }\r\n    var div = self.doc.createElement('div'), html;\r\n    div.appendChild(self[0].cloneNode(true));\r\n    html = _formatHtml(div.innerHTML);\r\n    div = null;\r\n    return html;\r\n  },\r\n  isSingle : function() {\r\n    return !!_SINGLE_TAG_MAP[this.name];\r\n  },\r\n  isInline : function() {\r\n    return !!_INLINE_TAG_MAP[this.name];\r\n  },\r\n  isBlock : function() {\r\n    return !!_BLOCK_TAG_MAP[this.name];\r\n  },\r\n  isStyle : function() {\r\n    return !!_STYLE_TAG_MAP[this.name];\r\n  },\r\n  isControl : function() {\r\n    return !!_CONTROL_TAG_MAP[this.name];\r\n  },\r\n  contains : function(otherNode) {\r\n    if (this.length < 1) {\r\n      return false;\r\n    }\r\n    return _contains(this[0], _get(otherNode));\r\n  },\r\n  parent : function() {\r\n    if (this.length < 1) {\r\n      return null;\r\n    }\r\n    var node = this[0].parentNode;\r\n    return node ? new KNode(node) : null;\r\n  },\r\n  children : function() {\r\n    if (this.length < 1) {\r\n      return new KNode([]);\r\n    }\r\n    var list = [], child = this[0].firstChild;\r\n    while (child) {\r\n      if (child.nodeType != 3 || _trim(child.nodeValue) !== '') {\r\n        list.push(child);\r\n      }\r\n      child = child.nextSibling;\r\n    }\r\n    return new KNode(list);\r\n  },\r\n  first : function() {\r\n    var list = this.children();\r\n    return list.length > 0 ? list.eq(0) : null;\r\n  },\r\n  last : function() {\r\n    var list = this.children();\r\n    return list.length > 0 ? list.eq(list.length - 1) : null;\r\n  },\r\n  index : function() {\r\n    if (this.length < 1) {\r\n      return -1;\r\n    }\r\n    var i = -1, sibling = this[0];\r\n    while (sibling) {\r\n      i++;\r\n      sibling = sibling.previousSibling;\r\n    }\r\n    return i;\r\n  },\r\n  prev : function() {\r\n    if (this.length < 1) {\r\n      return null;\r\n    }\r\n    var node = this[0].previousSibling;\r\n    return node ? new KNode(node) : null;\r\n  },\r\n  next : function() {\r\n    if (this.length < 1) {\r\n      return null;\r\n    }\r\n    var node = this[0].nextSibling;\r\n    return node ? new KNode(node) : null;\r\n  },\r\n  scan : function(fn, order) {\r\n    if (this.length < 1) {\r\n      return;\r\n    }\r\n    order = (order === undefined) ? true : order;\r\n    function walk(node) {\r\n      var n = order ? node.firstChild : node.lastChild;\r\n      while (n) {\r\n        var next = order ? n.nextSibling : n.previousSibling;\r\n        if (fn(n) === false) {\r\n          return false;\r\n        }\r\n        if (walk(n) === false) {\r\n          return false;\r\n        }\r\n        n = next;\r\n      }\r\n    }\r\n    walk(this[0]);\r\n    return this;\r\n  }\r\n});\r\n_each(('blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,' +\r\n  'mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,' +\r\n  'change,select,submit,keydown,keypress,keyup,error,contextmenu').split(','), function(i, type) {\r\n  KNode.prototype[type] = function(fn) {\r\n    return fn ? this.bind(type, fn) : this.fire(type);\r\n  };\r\n});\r\nvar _K = K;\r\nK = function(expr, root) {\r\n  if (expr === undefined || expr === null) {\r\n    return;\r\n  }\r\n  function newNode(node) {\r\n    if (!node[0]) {\r\n      node = [];\r\n    }\r\n    return new KNode(node);\r\n  }\r\n  if (typeof expr === 'string') {\r\n    if (root) {\r\n      root = _get(root);\r\n    }\r\n    var length = expr.length;\r\n    if (expr.charAt(0) === '@') {\r\n      expr = expr.substr(1);\r\n    }\r\n    if (expr.length !== length || /<.+>/.test(expr)) {\r\n      var doc = root ? root.ownerDocument || root : document,\r\n        div = doc.createElement('div'), list = [];\r\n      div.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + expr;\r\n      for (var i = 0, len = div.childNodes.length; i < len; i++) {\r\n        var child = div.childNodes[i];\r\n        if (child.id == '__kindeditor_temp_tag__') {\r\n          continue;\r\n        }\r\n        list.push(child);\r\n      }\r\n      return newNode(list);\r\n    }\r\n    return newNode(_queryAll(expr, root));\r\n  }\r\n  if (expr && expr.constructor === KNode) {\r\n    return expr;\r\n  }\r\n  if (expr.toArray) {\r\n    expr = expr.toArray();\r\n  }\r\n  if (_isArray(expr)) {\r\n    return newNode(expr);\r\n  }\r\n  return newNode(_toArray(arguments));\r\n};\r\n_each(_K, function(key, val) {\r\n  K[key] = val;\r\n});\r\nK.NodeClass = KNode;\r\nwindow.KindEditor = K;\r\n\r\n\r\nvar _START_TO_START = 0,\r\n  _START_TO_END = 1,\r\n  _END_TO_END = 2,\r\n  _END_TO_START = 3,\r\n  _BOOKMARK_ID = 0;\r\nfunction _updateCollapsed(range) {\r\n  range.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\r\n  return range;\r\n}\r\nfunction _copyAndDelete(range, isCopy, isDelete) {\r\n  var doc = range.doc, nodeList = [];\r\n  function splitTextNode(node, startOffset, endOffset) {\r\n    var length = node.nodeValue.length, centerNode;\r\n    if (isCopy) {\r\n      var cloneNode = node.cloneNode(true);\r\n      if (startOffset > 0) {\r\n        centerNode = cloneNode.splitText(startOffset);\r\n      } else {\r\n        centerNode = cloneNode;\r\n      }\r\n      if (endOffset < length) {\r\n        centerNode.splitText(endOffset - startOffset);\r\n      }\r\n    }\r\n    if (isDelete) {\r\n      var center = node;\r\n      if (startOffset > 0) {\r\n        center = node.splitText(startOffset);\r\n        range.setStart(node, startOffset);\r\n      }\r\n      if (endOffset < length) {\r\n        var right = center.splitText(endOffset - startOffset);\r\n        range.setEnd(right, 0);\r\n      }\r\n      nodeList.push(center);\r\n    }\r\n    return centerNode;\r\n  }\r\n  function removeNodes() {\r\n    if (isDelete) {\r\n      range.up().collapse(true);\r\n    }\r\n    for (var i = 0, len = nodeList.length; i < len; i++) {\r\n      var node = nodeList[i];\r\n      if (node.parentNode) {\r\n        node.parentNode.removeChild(node);\r\n      }\r\n    }\r\n  }\r\n  var copyRange = range.cloneRange().down();\r\n  var start = -1, incStart = -1, incEnd = -1, end = -1,\r\n    ancestor = range.commonAncestor(), frag = doc.createDocumentFragment();\r\n  if (ancestor.nodeType == 3) {\r\n    var textNode = splitTextNode(ancestor, range.startOffset, range.endOffset);\r\n    if (isCopy) {\r\n      frag.appendChild(textNode);\r\n    }\r\n    removeNodes();\r\n    return isCopy ? frag : range;\r\n  }\r\n  function extractNodes(parent, frag) {\r\n    var node = parent.firstChild, nextNode;\r\n    while (node) {\r\n      var testRange = new KRange(doc).selectNode(node);\r\n      start = testRange.compareBoundaryPoints(_START_TO_END, range);\r\n      if (start >= 0 && incStart <= 0) {\r\n        incStart = testRange.compareBoundaryPoints(_START_TO_START, range);\r\n      }\r\n      if (incStart >= 0 && incEnd <= 0) {\r\n        incEnd = testRange.compareBoundaryPoints(_END_TO_END, range);\r\n      }\r\n      if (incEnd >= 0 && end <= 0) {\r\n        end = testRange.compareBoundaryPoints(_END_TO_START, range);\r\n      }\r\n      if (end >= 0) {\r\n        return false;\r\n      }\r\n      nextNode = node.nextSibling;\r\n      if (start > 0) {\r\n        if (node.nodeType == 1) {\r\n          if (incStart >= 0 && incEnd <= 0) {\r\n            if (isCopy) {\r\n              frag.appendChild(node.cloneNode(true));\r\n            }\r\n            if (isDelete) {\r\n              nodeList.push(node);\r\n            }\r\n          } else {\r\n            var childFlag;\r\n            if (isCopy) {\r\n              childFlag = node.cloneNode(false);\r\n              frag.appendChild(childFlag);\r\n            }\r\n            if (extractNodes(node, childFlag) === false) {\r\n              return false;\r\n            }\r\n          }\r\n        } else if (node.nodeType == 3) {\r\n          var textNode;\r\n          if (node == copyRange.startContainer) {\r\n            textNode = splitTextNode(node, copyRange.startOffset, node.nodeValue.length);\r\n          } else if (node == copyRange.endContainer) {\r\n            textNode = splitTextNode(node, 0, copyRange.endOffset);\r\n          } else {\r\n            textNode = splitTextNode(node, 0, node.nodeValue.length);\r\n          }\r\n          if (isCopy) {\r\n            try {\r\n              frag.appendChild(textNode);\r\n            } catch(e) {}\r\n          }\r\n        }\r\n      }\r\n      node = nextNode;\r\n    }\r\n  }\r\n  extractNodes(ancestor, frag);\r\n  if (isDelete) {\r\n    range.up().collapse(true);\r\n  }\r\n  for (var i = 0, len = nodeList.length; i < len; i++) {\r\n    var node = nodeList[i];\r\n    if (node.parentNode) {\r\n      node.parentNode.removeChild(node);\r\n    }\r\n  }\r\n  return isCopy ? frag : range;\r\n}\r\n\r\nfunction _moveToElementText(range, el) {\r\n  var node = el;\r\n  while (node) {\r\n    var knode = K(node);\r\n    if (knode.name == 'marquee' || knode.name == 'select') {\r\n      return;\r\n    }\r\n    node = node.parentNode;\r\n  }\r\n  try {\r\n    range.moveToElementText(el);\r\n  } catch(e) {}\r\n}\r\n\r\nfunction _getStartEnd(rng, isStart) {\r\n  var doc = rng.parentElement().ownerDocument,\r\n    pointRange = rng.duplicate();\r\n  pointRange.collapse(isStart);\r\n  var parent = pointRange.parentElement(),\r\n    nodes = parent.childNodes;\r\n  if (nodes.length === 0) {\r\n    return {node: parent.parentNode, offset: K(parent).index()};\r\n  }\r\n  var startNode = doc, startPos = 0, cmp = -1;\r\n  var testRange = rng.duplicate();\r\n  _moveToElementText(testRange, parent);\r\n  for (var i = 0, len = nodes.length; i < len; i++) {\r\n    var node = nodes[i];\r\n    cmp = testRange.compareEndPoints('StartToStart', pointRange);\r\n    if (cmp === 0) {\r\n      return {node: node.parentNode, offset: i};\r\n    }\r\n    if (node.nodeType == 1) {\r\n      var nodeRange = rng.duplicate(), dummy, knode = K(node), newNode = node;\r\n      if (knode.isControl()) {\r\n        dummy = doc.createElement('span');\r\n        knode.after(dummy);\r\n        newNode = dummy;\r\n        startPos += knode.text().replace(/\\r\\n|\\n|\\r/g, '').length;\r\n      }\r\n      _moveToElementText(nodeRange, newNode);\r\n      testRange.setEndPoint('StartToEnd', nodeRange);\r\n      if (cmp > 0) {\r\n        startPos += nodeRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n      } else {\r\n        startPos = 0;\r\n      }\r\n      if (dummy) {\r\n        K(dummy).remove();\r\n      }\r\n    } else if (node.nodeType == 3) {\r\n      testRange.moveStart('character', node.nodeValue.length);\r\n      startPos += node.nodeValue.length;\r\n    }\r\n    if (cmp < 0) {\r\n      startNode = node;\r\n    }\r\n  }\r\n  if (cmp < 0 && startNode.nodeType == 1) {\r\n    return {node: parent, offset: K(parent.lastChild).index() + 1};\r\n  }\r\n  if (cmp > 0) {\r\n    while (startNode.nextSibling && startNode.nodeType == 1) {\r\n      startNode = startNode.nextSibling;\r\n    }\r\n  }\r\n  testRange = rng.duplicate();\r\n  _moveToElementText(testRange, parent);\r\n  testRange.setEndPoint('StartToEnd', pointRange);\r\n  startPos -= testRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n  if (cmp > 0 && startNode.nodeType == 3) {\r\n    var prevNode = startNode.previousSibling;\r\n    while (prevNode && prevNode.nodeType == 3) {\r\n      startPos -= prevNode.nodeValue.length;\r\n      prevNode = prevNode.previousSibling;\r\n    }\r\n  }\r\n  return {node: startNode, offset: startPos};\r\n}\r\n\r\nfunction _getEndRange(node, offset) {\r\n  var doc = node.ownerDocument || node,\r\n    range = doc.body.createTextRange();\r\n  if (doc == node) {\r\n    range.collapse(true);\r\n    return range;\r\n  }\r\n  if (node.nodeType == 1 && node.childNodes.length > 0) {\r\n    var children = node.childNodes, isStart, child;\r\n    if (offset === 0) {\r\n      child = children[0];\r\n      isStart = true;\r\n    } else {\r\n      child = children[offset - 1];\r\n      isStart = false;\r\n    }\r\n    if (!child) {\r\n      return range;\r\n    }\r\n    if (K(child).name === 'head') {\r\n      if (offset === 1) {\r\n        isStart = true;\r\n      }\r\n      if (offset === 2) {\r\n        isStart = false;\r\n      }\r\n      range.collapse(isStart);\r\n      return range;\r\n    }\r\n    if (child.nodeType == 1) {\r\n      var kchild = K(child), span;\r\n      if (kchild.isControl()) {\r\n        span = doc.createElement('span');\r\n        if (isStart) {\r\n          kchild.before(span);\r\n        } else {\r\n          kchild.after(span);\r\n        }\r\n        child = span;\r\n      }\r\n      _moveToElementText(range, child);\r\n      range.collapse(isStart);\r\n      if (span) {\r\n        K(span).remove();\r\n      }\r\n      return range;\r\n    }\r\n    node = child;\r\n    offset = isStart ? 0 : child.nodeValue.length;\r\n  }\r\n  var dummy = doc.createElement('span');\r\n  K(node).before(dummy);\r\n  _moveToElementText(range, dummy);\r\n  range.moveStart('character', offset);\r\n  K(dummy).remove();\r\n  return range;\r\n}\r\n\r\nfunction _toRange(rng) {\r\n  var doc, range;\r\n  function tr2td(start) {\r\n    if (K(start.node).name == 'tr') {\r\n      start.node = start.node.cells[start.offset];\r\n      start.offset = 0;\r\n    }\r\n  }\r\n  if (_IERANGE) {\r\n    if (rng.item) {\r\n      doc = _getDoc(rng.item(0));\r\n      range = new KRange(doc);\r\n      range.selectNode(rng.item(0));\r\n      return range;\r\n    }\r\n    doc = rng.parentElement().ownerDocument;\r\n    var start = _getStartEnd(rng, true),\r\n      end = _getStartEnd(rng, false);\r\n    tr2td(start);\r\n    tr2td(end);\r\n    range = new KRange(doc);\r\n    range.setStart(start.node, start.offset);\r\n    range.setEnd(end.node, end.offset);\r\n    return range;\r\n  }\r\n  var startContainer = rng.startContainer;\r\n  doc = startContainer.ownerDocument || startContainer;\r\n  range = new KRange(doc);\r\n  range.setStart(startContainer, rng.startOffset);\r\n  range.setEnd(rng.endContainer, rng.endOffset);\r\n  return range;\r\n}\r\n\r\n\r\nfunction KRange(doc) {\r\n  this.init(doc);\r\n}\r\n_extend(KRange, {\r\n  init : function(doc) {\r\n    var self = this;\r\n    self.startContainer = doc;\r\n    self.startOffset = 0;\r\n    self.endContainer = doc;\r\n    self.endOffset = 0;\r\n    self.collapsed = true;\r\n    self.doc = doc;\r\n  },\r\n  commonAncestor : function() {\r\n    function getParents(node) {\r\n      var parents = [];\r\n      while (node) {\r\n        parents.push(node);\r\n        node = node.parentNode;\r\n      }\r\n      return parents;\r\n    }\r\n    var parentsA = getParents(this.startContainer),\r\n      parentsB = getParents(this.endContainer),\r\n      i = 0, lenA = parentsA.length, lenB = parentsB.length, parentA, parentB;\r\n    while (++i) {\r\n      parentA = parentsA[lenA - i];\r\n      parentB = parentsB[lenB - i];\r\n      if (!parentA || !parentB || parentA !== parentB) {\r\n        break;\r\n      }\r\n    }\r\n    return parentsA[lenA - i + 1];\r\n  },\r\n  setStart : function(node, offset) {\r\n    var self = this, doc = self.doc;\r\n    self.startContainer = node;\r\n    self.startOffset = offset;\r\n    if (self.endContainer === doc) {\r\n      self.endContainer = node;\r\n      self.endOffset = offset;\r\n    }\r\n    return _updateCollapsed(this);\r\n  },\r\n  setEnd : function(node, offset) {\r\n    var self = this, doc = self.doc;\r\n    self.endContainer = node;\r\n    self.endOffset = offset;\r\n    if (self.startContainer === doc) {\r\n      self.startContainer = node;\r\n      self.startOffset = offset;\r\n    }\r\n    return _updateCollapsed(this);\r\n  },\r\n  setStartBefore : function(node) {\r\n    return this.setStart(node.parentNode || this.doc, K(node).index());\r\n  },\r\n  setStartAfter : function(node) {\r\n    return this.setStart(node.parentNode || this.doc, K(node).index() + 1);\r\n  },\r\n  setEndBefore : function(node) {\r\n    return this.setEnd(node.parentNode || this.doc, K(node).index());\r\n  },\r\n  setEndAfter : function(node) {\r\n    return this.setEnd(node.parentNode || this.doc, K(node).index() + 1);\r\n  },\r\n  selectNode : function(node) {\r\n    return this.setStartBefore(node).setEndAfter(node);\r\n  },\r\n  selectNodeContents : function(node) {\r\n    var knode = K(node);\r\n    if (knode.type == 3 || knode.isSingle()) {\r\n      return this.selectNode(node);\r\n    }\r\n    var children = knode.children();\r\n    if (children.length > 0) {\r\n      return this.setStartBefore(children[0]).setEndAfter(children[children.length - 1]);\r\n    }\r\n    return this.setStart(node, 0).setEnd(node, 0);\r\n  },\r\n  collapse : function(toStart) {\r\n    if (toStart) {\r\n      return this.setEnd(this.startContainer, this.startOffset);\r\n    }\r\n    return this.setStart(this.endContainer, this.endOffset);\r\n  },\r\n  compareBoundaryPoints : function(how, range) {\r\n    var rangeA = this.get(), rangeB = range.get();\r\n    if (_IERANGE) {\r\n      var arr = {};\r\n      arr[_START_TO_START] = 'StartToStart';\r\n      arr[_START_TO_END] = 'EndToStart';\r\n      arr[_END_TO_END] = 'EndToEnd';\r\n      arr[_END_TO_START] = 'StartToEnd';\r\n      var cmp = rangeA.compareEndPoints(arr[how], rangeB);\r\n      if (cmp !== 0) {\r\n        return cmp;\r\n      }\r\n      var nodeA, nodeB, nodeC, posA, posB;\r\n      if (how === _START_TO_START || how === _END_TO_START) {\r\n        nodeA = this.startContainer;\r\n        posA = this.startOffset;\r\n      }\r\n      if (how === _START_TO_END || how === _END_TO_END) {\r\n        nodeA = this.endContainer;\r\n        posA = this.endOffset;\r\n      }\r\n      if (how === _START_TO_START || how === _START_TO_END) {\r\n        nodeB = range.startContainer;\r\n        posB = range.startOffset;\r\n      }\r\n      if (how === _END_TO_END || how === _END_TO_START) {\r\n        nodeB = range.endContainer;\r\n        posB = range.endOffset;\r\n      }\r\n      if (nodeA === nodeB) {\r\n        var diff = posA - posB;\r\n        return diff > 0 ? 1 : (diff < 0 ? -1 : 0);\r\n      }\r\n      nodeC = nodeB;\r\n      while (nodeC && nodeC.parentNode !== nodeA) {\r\n        nodeC = nodeC.parentNode;\r\n      }\r\n      if (nodeC) {\r\n        return K(nodeC).index() >= posA ? -1 : 1;\r\n      }\r\n      nodeC = nodeA;\r\n      while (nodeC && nodeC.parentNode !== nodeB) {\r\n        nodeC = nodeC.parentNode;\r\n      }\r\n      if (nodeC) {\r\n        return K(nodeC).index() >= posB ? 1 : -1;\r\n      }\r\n      nodeC = K(nodeB).next();\r\n      if (nodeC && nodeC.contains(nodeA)) {\r\n        return 1;\r\n      }\r\n      nodeC = K(nodeA).next();\r\n      if (nodeC && nodeC.contains(nodeB)) {\r\n        return -1;\r\n      }\r\n    } else {\r\n      return rangeA.compareBoundaryPoints(how, rangeB);\r\n    }\r\n  },\r\n  cloneRange : function() {\r\n    return new KRange(this.doc).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset);\r\n  },\r\n  toString : function() {\r\n    var rng = this.get(), str = _IERANGE ? rng.text : rng.toString();\r\n    return str.replace(/\\r\\n|\\n|\\r/g, '');\r\n  },\r\n  cloneContents : function() {\r\n    return _copyAndDelete(this, true, false);\r\n  },\r\n  deleteContents : function() {\r\n    return _copyAndDelete(this, false, true);\r\n  },\r\n  extractContents : function() {\r\n    return _copyAndDelete(this, true, true);\r\n  },\r\n  insertNode : function(node) {\r\n    var self = this,\r\n      sc = self.startContainer, so = self.startOffset,\r\n      ec = self.endContainer, eo = self.endOffset,\r\n      firstChild, lastChild, c, nodeCount = 1;\r\n    if (node.nodeName.toLowerCase() === '#document-fragment') {\r\n      firstChild = node.firstChild;\r\n      lastChild = node.lastChild;\r\n      nodeCount = node.childNodes.length;\r\n    }\r\n    if (sc.nodeType == 1) {\r\n      c = sc.childNodes[so];\r\n      if (c) {\r\n        sc.insertBefore(node, c);\r\n        if (sc === ec) {\r\n          eo += nodeCount;\r\n        }\r\n      } else {\r\n        sc.appendChild(node);\r\n      }\r\n    } else if (sc.nodeType == 3) {\r\n      if (so === 0) {\r\n        sc.parentNode.insertBefore(node, sc);\r\n        if (sc.parentNode === ec) {\r\n          eo += nodeCount;\r\n        }\r\n      } else if (so >= sc.nodeValue.length) {\r\n        if (sc.nextSibling) {\r\n          sc.parentNode.insertBefore(node, sc.nextSibling);\r\n        } else {\r\n          sc.parentNode.appendChild(node);\r\n        }\r\n      } else {\r\n        if (so > 0) {\r\n          c = sc.splitText(so);\r\n        } else {\r\n          c = sc;\r\n        }\r\n        sc.parentNode.insertBefore(node, c);\r\n        if (sc === ec) {\r\n          ec = c;\r\n          eo -= so;\r\n        }\r\n      }\r\n    }\r\n    if (firstChild) {\r\n      self.setStartBefore(firstChild).setEndAfter(lastChild);\r\n    } else {\r\n      self.selectNode(node);\r\n    }\r\n    if (self.compareBoundaryPoints(_END_TO_END, self.cloneRange().setEnd(ec, eo)) >= 1) {\r\n      return self;\r\n    }\r\n    return self.setEnd(ec, eo);\r\n  },\r\n  surroundContents : function(node) {\r\n    node.appendChild(this.extractContents());\r\n    return this.insertNode(node).selectNode(node);\r\n  },\r\n  isControl : function() {\r\n    var self = this,\r\n      sc = self.startContainer, so = self.startOffset,\r\n      ec = self.endContainer, eo = self.endOffset, rng;\r\n    return sc.nodeType == 1 && sc === ec && so + 1 === eo && K(sc.childNodes[so]).isControl();\r\n  },\r\n  get : function(hasControlRange) {\r\n    var self = this, doc = self.doc, node, rng;\r\n    if (!_IERANGE) {\r\n      rng = doc.createRange();\r\n      try {\r\n        rng.setStart(self.startContainer, self.startOffset);\r\n        rng.setEnd(self.endContainer, self.endOffset);\r\n      } catch (e) {}\r\n      return rng;\r\n    }\r\n    if (hasControlRange && self.isControl()) {\r\n      rng = doc.body.createControlRange();\r\n      rng.addElement(self.startContainer.childNodes[self.startOffset]);\r\n      return rng;\r\n    }\r\n    var range = self.cloneRange().down();\r\n    rng = doc.body.createTextRange();\r\n    rng.setEndPoint('StartToStart', _getEndRange(range.startContainer, range.startOffset));\r\n    rng.setEndPoint('EndToStart', _getEndRange(range.endContainer, range.endOffset));\r\n    return rng;\r\n  },\r\n  html : function() {\r\n    return K(this.cloneContents()).outer();\r\n  },\r\n  down : function() {\r\n    var self = this;\r\n    function downPos(node, pos, isStart) {\r\n      if (node.nodeType != 1) {\r\n        return;\r\n      }\r\n      var children = K(node).children();\r\n      if (children.length === 0) {\r\n        return;\r\n      }\r\n      var left, right, child, offset;\r\n      if (pos > 0) {\r\n        left = children.eq(pos - 1);\r\n      }\r\n      if (pos < children.length) {\r\n        right = children.eq(pos);\r\n      }\r\n      if (left && left.type == 3) {\r\n        child = left[0];\r\n        offset = child.nodeValue.length;\r\n      }\r\n      if (right && right.type == 3) {\r\n        child = right[0];\r\n        offset = 0;\r\n      }\r\n      if (!child) {\r\n        return;\r\n      }\r\n      if (isStart) {\r\n        self.setStart(child, offset);\r\n      } else {\r\n        self.setEnd(child, offset);\r\n      }\r\n    }\r\n    downPos(self.startContainer, self.startOffset, true);\r\n    downPos(self.endContainer, self.endOffset, false);\r\n    return self;\r\n  },\r\n  up : function() {\r\n    var self = this;\r\n    function upPos(node, pos, isStart) {\r\n      if (node.nodeType != 3) {\r\n        return;\r\n      }\r\n      if (pos === 0) {\r\n        if (isStart) {\r\n          self.setStartBefore(node);\r\n        } else {\r\n          self.setEndBefore(node);\r\n        }\r\n      } else if (pos == node.nodeValue.length) {\r\n        if (isStart) {\r\n          self.setStartAfter(node);\r\n        } else {\r\n          self.setEndAfter(node);\r\n        }\r\n      }\r\n    }\r\n    upPos(self.startContainer, self.startOffset, true);\r\n    upPos(self.endContainer, self.endOffset, false);\r\n    return self;\r\n  },\r\n  enlarge : function(toBlock) {\r\n    var self = this;\r\n    self.up();\r\n    function enlargePos(node, pos, isStart) {\r\n      var knode = K(node), parent;\r\n      if (knode.type == 3 || _NOSPLIT_TAG_MAP[knode.name] || !toBlock && knode.isBlock()) {\r\n        return;\r\n      }\r\n      if (pos === 0) {\r\n        while (!knode.prev()) {\r\n          parent = knode.parent();\r\n          if (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n            break;\r\n          }\r\n          knode = parent;\r\n        }\r\n        if (isStart) {\r\n          self.setStartBefore(knode[0]);\r\n        } else {\r\n          self.setEndBefore(knode[0]);\r\n        }\r\n      } else if (pos == knode.children().length) {\r\n        while (!knode.next()) {\r\n          parent = knode.parent();\r\n          if (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n            break;\r\n          }\r\n          knode = parent;\r\n        }\r\n        if (isStart) {\r\n          self.setStartAfter(knode[0]);\r\n        } else {\r\n          self.setEndAfter(knode[0]);\r\n        }\r\n      }\r\n    }\r\n    enlargePos(self.startContainer, self.startOffset, true);\r\n    enlargePos(self.endContainer, self.endOffset, false);\r\n    return self;\r\n  },\r\n  shrink : function() {\r\n    var self = this, child, collapsed = self.collapsed;\r\n    while (self.startContainer.nodeType == 1 && (child = self.startContainer.childNodes[self.startOffset]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n      self.setStart(child, 0);\r\n    }\r\n    if (collapsed) {\r\n      return self.collapse(collapsed);\r\n    }\r\n    while (self.endContainer.nodeType == 1 && self.endOffset > 0 && (child = self.endContainer.childNodes[self.endOffset - 1]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n      self.setEnd(child, child.childNodes.length);\r\n    }\r\n    return self;\r\n  },\r\n  createBookmark : function(serialize) {\r\n    var self = this, doc = self.doc, endNode,\r\n      startNode = K('<span style=\"display:none;\"></span>', doc)[0];\r\n    startNode.id = '__kindeditor_bookmark_start_' + (_BOOKMARK_ID++) + '__';\r\n    if (!self.collapsed) {\r\n      endNode = startNode.cloneNode(true);\r\n      endNode.id = '__kindeditor_bookmark_end_' + (_BOOKMARK_ID++) + '__';\r\n    }\r\n    if (endNode) {\r\n      self.cloneRange().collapse(false).insertNode(endNode).setEndBefore(endNode);\r\n    }\r\n    self.insertNode(startNode).setStartAfter(startNode);\r\n    return {\r\n      start : serialize ? '#' + startNode.id : startNode,\r\n      end : endNode ? (serialize ? '#' + endNode.id : endNode) : null\r\n    };\r\n  },\r\n  moveToBookmark : function(bookmark) {\r\n    var self = this, doc = self.doc,\r\n      start = K(bookmark.start, doc), end = bookmark.end ? K(bookmark.end, doc) : null;\r\n    if (!start || start.length < 1) {\r\n      return self;\r\n    }\r\n    self.setStartBefore(start[0]);\r\n    start.remove();\r\n    if (end && end.length > 0) {\r\n      self.setEndBefore(end[0]);\r\n      end.remove();\r\n    } else {\r\n      self.collapse(true);\r\n    }\r\n    return self;\r\n  },\r\n  dump : function() {\r\n    console.log('--------------------');\r\n    console.log(this.startContainer.nodeType == 3 ? this.startContainer.nodeValue : this.startContainer, this.startOffset);\r\n    console.log(this.endContainer.nodeType == 3 ? this.endContainer.nodeValue : this.endContainer, this.endOffset);\r\n  }\r\n});\r\nfunction _range(mixed) {\r\n  if (!mixed.nodeName) {\r\n    return mixed.constructor === KRange ? mixed : _toRange(mixed);\r\n  }\r\n  return new KRange(mixed);\r\n}\r\nK.RangeClass = KRange;\r\nK.range = _range;\r\nK.START_TO_START = _START_TO_START;\r\nK.START_TO_END = _START_TO_END;\r\nK.END_TO_END = _END_TO_END;\r\nK.END_TO_START = _END_TO_START;\r\n\r\n\r\n\r\nfunction _nativeCommand(doc, key, val) {\r\n  try {\r\n    doc.execCommand(key, false, val);\r\n  } catch(e) {}\r\n}\r\n\r\nfunction _nativeCommandValue(doc, key) {\r\n  var val = '';\r\n  try {\r\n    val = doc.queryCommandValue(key);\r\n  } catch (e) {}\r\n  if (typeof val !== 'string') {\r\n    val = '';\r\n  }\r\n  return val;\r\n}\r\n\r\nfunction _getSel(doc) {\r\n  var win = _getWin(doc);\r\n  return _IERANGE ? doc.selection : win.getSelection();\r\n}\r\n\r\nfunction _getRng(doc) {\r\n  var sel = _getSel(doc), rng;\r\n  try {\r\n    if (sel.rangeCount > 0) {\r\n      rng = sel.getRangeAt(0);\r\n    } else {\r\n      rng = sel.createRange();\r\n    }\r\n  } catch(e) {}\r\n  if (_IERANGE && (!rng || (!rng.item && rng.parentElement().ownerDocument !== doc))) {\r\n    return null;\r\n  }\r\n  return rng;\r\n}\r\n\r\nfunction _singleKeyMap(map) {\r\n  var newMap = {}, arr, v;\r\n  _each(map, function(key, val) {\r\n    arr = key.split(',');\r\n    for (var i = 0, len = arr.length; i < len; i++) {\r\n      v = arr[i];\r\n      newMap[v] = val;\r\n    }\r\n  });\r\n  return newMap;\r\n}\r\n\r\nfunction _hasAttrOrCss(knode, map) {\r\n  return _hasAttrOrCssByKey(knode, map, '*') || _hasAttrOrCssByKey(knode, map);\r\n}\r\nfunction _hasAttrOrCssByKey(knode, map, mapKey) {\r\n  mapKey = mapKey || knode.name;\r\n  if (knode.type !== 1) {\r\n    return false;\r\n  }\r\n  var newMap = _singleKeyMap(map);\r\n  if (!newMap[mapKey]) {\r\n    return false;\r\n  }\r\n  var arr = newMap[mapKey].split(',');\r\n  for (var i = 0, len = arr.length; i < len; i++) {\r\n    var key = arr[i];\r\n    if (key === '*') {\r\n      return true;\r\n    }\r\n    var match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n    var method = match[1] ? 'css' : 'attr';\r\n    key = match[2];\r\n    var val = match[3] || '';\r\n    if (val === '' && knode[method](key) !== '') {\r\n      return true;\r\n    }\r\n    if (val !== '' && knode[method](key) === val) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction _removeAttrOrCss(knode, map) {\r\n  if (knode.type != 1) {\r\n    return;\r\n  }\r\n  _removeAttrOrCssByKey(knode, map, '*');\r\n  _removeAttrOrCssByKey(knode, map);\r\n}\r\nfunction _removeAttrOrCssByKey(knode, map, mapKey) {\r\n  mapKey = mapKey || knode.name;\r\n  if (knode.type !== 1) {\r\n    return;\r\n  }\r\n  var newMap = _singleKeyMap(map);\r\n  if (!newMap[mapKey]) {\r\n    return;\r\n  }\r\n  var arr = newMap[mapKey].split(','), allFlag = false;\r\n  for (var i = 0, len = arr.length; i < len; i++) {\r\n    var key = arr[i];\r\n    if (key === '*') {\r\n      allFlag = true;\r\n      break;\r\n    }\r\n    var match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n    key = match[2];\r\n    if (match[1]) {\r\n      key = _toCamel(key);\r\n      if (knode[0].style[key]) {\r\n        knode[0].style[key] = '';\r\n      }\r\n    } else {\r\n      knode.removeAttr(key);\r\n    }\r\n  }\r\n  if (allFlag) {\r\n    knode.remove(true);\r\n  }\r\n}\r\n\r\nfunction _getInnerNode(knode) {\r\n  var inner = knode;\r\n  while (inner.first()) {\r\n    inner = inner.first();\r\n  }\r\n  return inner;\r\n}\r\n\r\nfunction _isEmptyNode(knode) {\r\n  if (knode.type != 1 || knode.isSingle()) {\r\n    return false;\r\n  }\r\n  return knode.html().replace(/<[^>]+>/g, '') === '';\r\n}\r\n\r\n\r\n\r\n\r\nfunction _mergeWrapper(a, b) {\r\n  a = a.clone(true);\r\n  var lastA = _getInnerNode(a), childA = a, merged = false;\r\n  while (b) {\r\n    while (childA) {\r\n      if (childA.name === b.name) {\r\n        _mergeAttrs(childA, b.attr(), b.css());\r\n        merged = true;\r\n      }\r\n      childA = childA.first();\r\n    }\r\n    if (!merged) {\r\n      lastA.append(b.clone(false));\r\n    }\r\n    merged = false;\r\n    b = b.first();\r\n  }\r\n  return a;\r\n}\r\n\r\nfunction _wrapNode(knode, wrapper) {\r\n  wrapper = wrapper.clone(true);\r\n  if (knode.type == 3) {\r\n    _getInnerNode(wrapper).append(knode.clone(false));\r\n    knode.replaceWith(wrapper);\r\n    return wrapper;\r\n  }\r\n  var nodeWrapper = knode, child;\r\n  while ((child = knode.first()) && child.children().length == 1) {\r\n    knode = child;\r\n  }\r\n  child = knode.first();\r\n  var frag = knode.doc.createDocumentFragment();\r\n  while (child) {\r\n    frag.appendChild(child[0]);\r\n    child = child.next();\r\n  }\r\n  wrapper = _mergeWrapper(nodeWrapper, wrapper);\r\n  if (frag.firstChild) {\r\n    _getInnerNode(wrapper).append(frag);\r\n  }\r\n  nodeWrapper.replaceWith(wrapper);\r\n  return wrapper;\r\n}\r\n\r\nfunction _mergeAttrs(knode, attrs, styles) {\r\n  _each(attrs, function(key, val) {\r\n    if (key !== 'style') {\r\n      knode.attr(key, val);\r\n    }\r\n  });\r\n  _each(styles, function(key, val) {\r\n    knode.css(key, val);\r\n  });\r\n}\r\n\r\nfunction _inPreElement(knode) {\r\n  while (knode && knode.name != 'body') {\r\n    if (_PRE_TAG_MAP[knode.name] || knode.name == 'div' && knode.hasClass('ke-script')) {\r\n      return true;\r\n    }\r\n    knode = knode.parent();\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction KCmd(range) {\r\n  this.init(range);\r\n}\r\n_extend(KCmd, {\r\n  init : function(range) {\r\n    var self = this, doc = range.doc;\r\n    self.doc = doc;\r\n    self.win = _getWin(doc);\r\n    self.sel = _getSel(doc);\r\n    self.range = range;\r\n  },\r\n  selection : function(forceReset) {\r\n    var self = this, doc = self.doc, rng = _getRng(doc);\r\n    self.sel = _getSel(doc);\r\n    if (rng) {\r\n      self.range = _range(rng);\r\n      if (K(self.range.startContainer).name == 'html') {\r\n        self.range.selectNodeContents(doc.body).collapse(false);\r\n      }\r\n      return self;\r\n    }\r\n    if (forceReset) {\r\n      self.range.selectNodeContents(doc.body).collapse(false);\r\n    }\r\n    return self;\r\n  },\r\n  select : function(hasDummy) {\r\n    hasDummy = _undef(hasDummy, true);\r\n    var self = this, sel = self.sel, range = self.range.cloneRange().shrink(),\r\n      sc = range.startContainer, so = range.startOffset,\r\n      ec = range.endContainer, eo = range.endOffset,\r\n      doc = _getDoc(sc), win = self.win, rng, hasU200b = false;\r\n    if (hasDummy && sc.nodeType == 1 && range.collapsed) {\r\n      if (_IERANGE) {\r\n        var dummy = K('<span>&nbsp;</span>', doc);\r\n        range.insertNode(dummy[0]);\r\n        rng = doc.body.createTextRange();\r\n        try {\r\n          rng.moveToElementText(dummy[0]);\r\n        } catch(ex) {}\r\n        rng.collapse(false);\r\n        rng.select();\r\n        dummy.remove();\r\n        win.focus();\r\n        return self;\r\n      }\r\n      if (_WEBKIT) {\r\n        var children = sc.childNodes;\r\n        if (K(sc).isInline() || so > 0 && K(children[so - 1]).isInline() || children[so] && K(children[so]).isInline()) {\r\n          range.insertNode(doc.createTextNode('\\u200B'));\r\n          hasU200b = true;\r\n        }\r\n      }\r\n    }\r\n    if (_IERANGE) {\r\n      try {\r\n        rng = range.get(true);\r\n        rng.select();\r\n      } catch(e) {}\r\n    } else {\r\n      if (hasU200b) {\r\n        range.collapse(false);\r\n      }\r\n      rng = range.get(true);\r\n      sel.removeAllRanges();\r\n      sel.addRange(rng);\r\n      if (doc !== document) {\r\n        var pos = K(rng.endContainer).pos();\r\n        win.scrollTo(pos.x, pos.y);\r\n      }\r\n    }\r\n    win.focus();\r\n    return self;\r\n  },\r\n  wrap : function(val) {\r\n    var self = this, doc = self.doc, range = self.range, wrapper;\r\n    wrapper = K(val, doc);\r\n    if (range.collapsed) {\r\n      range.shrink();\r\n      range.insertNode(wrapper[0]).selectNodeContents(wrapper[0]);\r\n      return self;\r\n    }\r\n    if (wrapper.isBlock()) {\r\n      var copyWrapper = wrapper.clone(true), child = copyWrapper;\r\n      while (child.first()) {\r\n        child = child.first();\r\n      }\r\n      child.append(range.extractContents());\r\n      range.insertNode(copyWrapper[0]).selectNode(copyWrapper[0]);\r\n      return self;\r\n    }\r\n    range.enlarge();\r\n    var bookmark = range.createBookmark(), ancestor = range.commonAncestor(), isStart = false;\r\n    K(ancestor).scan(function(node) {\r\n      if (!isStart && node == bookmark.start) {\r\n        isStart = true;\r\n        return;\r\n      }\r\n      if (isStart) {\r\n        if (node == bookmark.end) {\r\n          return false;\r\n        }\r\n        var knode = K(node);\r\n        if (_inPreElement(knode)) {\r\n          return;\r\n        }\r\n        if (knode.type == 3 && _trim(node.nodeValue).length > 0) {\r\n          var parent;\r\n          while ((parent = knode.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n            knode = parent;\r\n          }\r\n          _wrapNode(knode, wrapper);\r\n        }\r\n      }\r\n    });\r\n    range.moveToBookmark(bookmark);\r\n    return self;\r\n  },\r\n  split : function(isStart, map) {\r\n    var range = this.range, doc = range.doc;\r\n    var tempRange = range.cloneRange().collapse(isStart);\r\n    var node = tempRange.startContainer, pos = tempRange.startOffset,\r\n      parent = node.nodeType == 3 ? node.parentNode : node,\r\n      needSplit = false, knode;\r\n    while (parent && parent.parentNode) {\r\n      knode = K(parent);\r\n      if (map) {\r\n        if (!knode.isStyle()) {\r\n          break;\r\n        }\r\n        if (!_hasAttrOrCss(knode, map)) {\r\n          break;\r\n        }\r\n      } else {\r\n        if (_NOSPLIT_TAG_MAP[knode.name]) {\r\n          break;\r\n        }\r\n      }\r\n      needSplit = true;\r\n      parent = parent.parentNode;\r\n    }\r\n    if (needSplit) {\r\n      var dummy = doc.createElement('span');\r\n      range.cloneRange().collapse(!isStart).insertNode(dummy);\r\n      if (isStart) {\r\n        tempRange.setStartBefore(parent.firstChild).setEnd(node, pos);\r\n      } else {\r\n        tempRange.setStart(node, pos).setEndAfter(parent.lastChild);\r\n      }\r\n      var frag = tempRange.extractContents(),\r\n        first = frag.firstChild, last = frag.lastChild;\r\n      if (isStart) {\r\n        tempRange.insertNode(frag);\r\n        range.setStartAfter(last).setEndBefore(dummy);\r\n      } else {\r\n        parent.appendChild(frag);\r\n        range.setStartBefore(dummy).setEndBefore(first);\r\n      }\r\n      var dummyParent = dummy.parentNode;\r\n      if (dummyParent == range.endContainer) {\r\n        var prev = K(dummy).prev(), next = K(dummy).next();\r\n        if (prev && next && prev.type == 3 && next.type == 3) {\r\n          range.setEnd(prev[0], prev[0].nodeValue.length);\r\n        } else if (!isStart) {\r\n          range.setEnd(range.endContainer, range.endOffset - 1);\r\n        }\r\n      }\r\n      dummyParent.removeChild(dummy);\r\n    }\r\n    return this;\r\n  },\r\n  remove : function(map) {\r\n    var self = this, doc = self.doc, range = self.range;\r\n    range.enlarge();\r\n    if (range.startOffset === 0) {\r\n      var ksc = K(range.startContainer), parent;\r\n      while ((parent = ksc.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n        ksc = parent;\r\n      }\r\n      range.setStart(ksc[0], 0);\r\n      ksc = K(range.startContainer);\r\n      if (ksc.isBlock()) {\r\n        _removeAttrOrCss(ksc, map);\r\n      }\r\n      var kscp = ksc.parent();\r\n      if (kscp && kscp.isBlock()) {\r\n        _removeAttrOrCss(kscp, map);\r\n      }\r\n    }\r\n    var sc, so;\r\n    if (range.collapsed) {\r\n      self.split(true, map);\r\n      sc = range.startContainer;\r\n      so = range.startOffset;\r\n      if (so > 0) {\r\n        var sb = K(sc.childNodes[so - 1]);\r\n        if (sb && _isEmptyNode(sb)) {\r\n          sb.remove();\r\n          range.setStart(sc, so - 1);\r\n        }\r\n      }\r\n      var sa = K(sc.childNodes[so]);\r\n      if (sa && _isEmptyNode(sa)) {\r\n        sa.remove();\r\n      }\r\n      if (_isEmptyNode(sc)) {\r\n        range.startBefore(sc);\r\n        sc.remove();\r\n      }\r\n      range.collapse(true);\r\n      return self;\r\n    }\r\n    self.split(true, map);\r\n    self.split(false, map);\r\n    var startDummy = doc.createElement('span'), endDummy = doc.createElement('span');\r\n    range.cloneRange().collapse(false).insertNode(endDummy);\r\n    range.cloneRange().collapse(true).insertNode(startDummy);\r\n    var nodeList = [], cmpStart = false;\r\n    K(range.commonAncestor()).scan(function(node) {\r\n      if (!cmpStart && node == startDummy) {\r\n        cmpStart = true;\r\n        return;\r\n      }\r\n      if (node == endDummy) {\r\n        return false;\r\n      }\r\n      if (cmpStart) {\r\n        nodeList.push(node);\r\n      }\r\n    });\r\n    K(startDummy).remove();\r\n    K(endDummy).remove();\r\n    sc = range.startContainer;\r\n    so = range.startOffset;\r\n    var ec = range.endContainer, eo = range.endOffset;\r\n    if (so > 0) {\r\n      var startBefore = K(sc.childNodes[so - 1]);\r\n      if (startBefore && _isEmptyNode(startBefore)) {\r\n        startBefore.remove();\r\n        range.setStart(sc, so - 1);\r\n        if (sc == ec) {\r\n          range.setEnd(ec, eo - 1);\r\n        }\r\n      }\r\n      var startAfter = K(sc.childNodes[so]);\r\n      if (startAfter && _isEmptyNode(startAfter)) {\r\n        startAfter.remove();\r\n        if (sc == ec) {\r\n          range.setEnd(ec, eo - 1);\r\n        }\r\n      }\r\n    }\r\n    var endAfter = K(ec.childNodes[range.endOffset]);\r\n    if (endAfter && _isEmptyNode(endAfter)) {\r\n      endAfter.remove();\r\n    }\r\n    var bookmark = range.createBookmark(true);\r\n    _each(nodeList, function(i, node) {\r\n      _removeAttrOrCss(K(node), map);\r\n    });\r\n    range.moveToBookmark(bookmark);\r\n    return self;\r\n  },\r\n  commonNode : function(map) {\r\n    var range = this.range;\r\n    var ec = range.endContainer, eo = range.endOffset,\r\n      node = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n    function find(node) {\r\n      var child = node, parent = node;\r\n      while (parent) {\r\n        if (_hasAttrOrCss(K(parent), map)) {\r\n          return K(parent);\r\n        }\r\n        parent = parent.parentNode;\r\n      }\r\n      while (child && (child = child.lastChild)) {\r\n        if (_hasAttrOrCss(K(child), map)) {\r\n          return K(child);\r\n        }\r\n      }\r\n      return null;\r\n    }\r\n    var cNode = find(node);\r\n    if (cNode) {\r\n      return cNode;\r\n    }\r\n    if (node.nodeType == 1 || (ec.nodeType == 3 && eo === 0)) {\r\n      var prev = K(node).prev();\r\n      if (prev) {\r\n        return find(prev);\r\n      }\r\n    }\r\n    return null;\r\n  },\r\n  commonAncestor : function(tagName) {\r\n    var range = this.range,\r\n      sc = range.startContainer, so = range.startOffset,\r\n      ec = range.endContainer, eo = range.endOffset,\r\n      startNode = (sc.nodeType == 3 || so === 0) ? sc : sc.childNodes[so - 1],\r\n      endNode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n    function find(node) {\r\n      while (node) {\r\n        if (node.nodeType == 1) {\r\n          if (node.tagName.toLowerCase() === tagName) {\r\n            return node;\r\n          }\r\n        }\r\n        node = node.parentNode;\r\n      }\r\n      return null;\r\n    }\r\n    var start = find(startNode), end = find(endNode);\r\n    if (start && end && start === end) {\r\n      return K(start);\r\n    }\r\n    return null;\r\n  },\r\n  state : function(key) {\r\n    var self = this, doc = self.doc, bool = false;\r\n    try {\r\n      bool = doc.queryCommandState(key);\r\n    } catch (e) {}\r\n    return bool;\r\n  },\r\n  val : function(key) {\r\n    var self = this, doc = self.doc, range = self.range;\r\n    function lc(val) {\r\n      return val.toLowerCase();\r\n    }\r\n    key = lc(key);\r\n    var val = '', knode;\r\n    if (key === 'fontfamily' || key === 'fontname') {\r\n      val = _nativeCommandValue(doc, 'fontname');\r\n      val = val.replace(/['\"]/g, '');\r\n      return lc(val);\r\n    }\r\n    if (key === 'formatblock') {\r\n      val = _nativeCommandValue(doc, key);\r\n      if (val === '') {\r\n        knode = self.commonNode({'h1,h2,h3,h4,h5,h6,p,div,pre,address' : '*'});\r\n        if (knode) {\r\n          val = knode.name;\r\n        }\r\n      }\r\n      if (val === 'Normal') {\r\n        val = 'p';\r\n      }\r\n      return lc(val);\r\n    }\r\n    if (key === 'fontsize') {\r\n      knode = self.commonNode({'*' : '.font-size'});\r\n      if (knode) {\r\n        val = knode.css('font-size');\r\n      }\r\n      return lc(val);\r\n    }\r\n    if (key === 'forecolor') {\r\n      knode = self.commonNode({'*' : '.color'});\r\n      if (knode) {\r\n        val = knode.css('color');\r\n      }\r\n      val = _toHex(val);\r\n      if (val === '') {\r\n        val = 'default';\r\n      }\r\n      return lc(val);\r\n    }\r\n    if (key === 'hilitecolor') {\r\n      knode = self.commonNode({'*' : '.background-color'});\r\n      if (knode) {\r\n        val = knode.css('background-color');\r\n      }\r\n      val = _toHex(val);\r\n      if (val === '') {\r\n        val = 'default';\r\n      }\r\n      return lc(val);\r\n    }\r\n    return val;\r\n  },\r\n  toggle : function(wrapper, map) {\r\n    var self = this;\r\n    if (self.commonNode(map)) {\r\n      self.remove(map);\r\n    } else {\r\n      self.wrap(wrapper);\r\n    }\r\n    return self.select();\r\n  },\r\n  bold : function() {\r\n    return this.toggle('<strong></strong>', {\r\n      span : '.font-weight=bold',\r\n      strong : '*',\r\n      b : '*'\r\n    });\r\n  },\r\n  italic : function() {\r\n    return this.toggle('<em></em>', {\r\n      span : '.font-style=italic',\r\n      em : '*',\r\n      i : '*'\r\n    });\r\n  },\r\n  underline : function() {\r\n    return this.toggle('<u></u>', {\r\n      span : '.text-decoration=underline',\r\n      u : '*'\r\n    });\r\n  },\r\n  strikethrough : function() {\r\n    return this.toggle('<s></s>', {\r\n      span : '.text-decoration=line-through',\r\n      s : '*'\r\n    });\r\n  },\r\n  forecolor : function(val) {\r\n    console.log('forecolor:', val)\r\n    return this.wrap('<span style=\"color:' + val + ';\"></span>').select();\r\n  },\r\n  hilitecolor : function(val) {\r\n    return this.wrap('<span style=\"background-color:' + val + ';\"></span>').select();\r\n  },\r\n  fontsize : function(val) {\r\n    return this.wrap('<span style=\"font-size:' + val + ';\"></span>').select();\r\n  },\r\n  fontname : function(val) {\r\n    console.log('fontname:', val)\r\n    return this.fontfamily(val);\r\n  },\r\n  fontfamily : function(val) {\r\n    console.log('fontfamily:', val)\r\n    return this.wrap('<span style=\"font-family:' + val + ';\"></span>').select();\r\n  },\r\n  removeformat : function() {\r\n    var map = {\r\n      '*' : '.font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent'\r\n    },\r\n    tags = _STYLE_TAG_MAP;\r\n    _each(tags, function(key, val) {\r\n      map[key] = '*';\r\n    });\r\n    this.remove(map);\r\n    return this.select();\r\n  },\r\n  inserthtml : function(val, quickMode) {\r\n    var self = this, range = self.range;\r\n    if (val === '') {\r\n      return self;\r\n    }\r\n    function pasteHtml(range, val) {\r\n      val = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + val;\r\n      var rng = range.get();\r\n      if (rng.item) {\r\n        rng.item(0).outerHTML = val;\r\n      } else {\r\n        rng.pasteHTML(val);\r\n      }\r\n      var temp = range.doc.getElementById('__kindeditor_temp_tag__');\r\n      temp.parentNode.removeChild(temp);\r\n      var newRange = _toRange(rng);\r\n      range.setEnd(newRange.endContainer, newRange.endOffset);\r\n      range.collapse(false);\r\n      self.select(false);\r\n    }\r\n    function insertHtml(range, val) {\r\n      var doc = range.doc,\r\n        frag = doc.createDocumentFragment();\r\n      K('@' + val, doc).each(function() {\r\n        frag.appendChild(this);\r\n      });\r\n      range.deleteContents();\r\n      range.insertNode(frag);\r\n      range.collapse(false);\r\n      self.select(false);\r\n    }\r\n    if (_IERANGE && quickMode) {\r\n      try {\r\n        pasteHtml(range, val);\r\n      } catch(e) {\r\n        insertHtml(range, val);\r\n      }\r\n      return self;\r\n    }\r\n    insertHtml(range, val);\r\n    return self;\r\n  },\r\n  hr : function() {\r\n    return this.inserthtml('<hr />');\r\n  },\r\n  print : function() {\r\n    this.win.print();\r\n    return this;\r\n  },\r\n  insertimage : function(url, title, width, height, border, align) {\r\n    title = _undef(title, '');\r\n    border = _undef(border, 0);\r\n    var html = '<img src=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n    if (width) {\r\n      html += 'width=\"' + _escape(width) + '\" ';\r\n    }\r\n    if (height) {\r\n      html += 'height=\"' + _escape(height) + '\" ';\r\n    }\r\n    if (title) {\r\n      html += 'title=\"' + _escape(title) + '\" ';\r\n    }\r\n    if (align) {\r\n      html += 'align=\"' + _escape(align) + '\" ';\r\n    }\r\n    html += 'alt=\"' + _escape(title) + '\" ';\r\n    html += '/>';\r\n    return this.inserthtml(html);\r\n  },\r\n  createlink : function(url, type) {\r\n    var self = this, doc = self.doc, range = self.range;\r\n    self.select();\r\n    var a = self.commonNode({ a : '*' });\r\n    if (a && !range.isControl()) {\r\n      range.selectNode(a.get());\r\n      self.select();\r\n    }\r\n    var html = '<a href=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n    if (type) {\r\n      html += ' target=\"' + _escape(type) + '\"';\r\n    }\r\n    if (range.collapsed) {\r\n      html += '>' + _escape(url) + '</a>';\r\n      return self.inserthtml(html);\r\n    }\r\n    if (range.isControl()) {\r\n      var node = K(range.startContainer.childNodes[range.startOffset]);\r\n      html += '></a>';\r\n      node.after(K(html, doc));\r\n      node.next().append(node);\r\n      range.selectNode(node[0]);\r\n      return self.select();\r\n    }\r\n    function setAttr(node, url, type) {\r\n      K(node).attr('href', url).attr('data-ke-src', url);\r\n      if (type) {\r\n        K(node).attr('target', type);\r\n      } else {\r\n        K(node).removeAttr('target');\r\n      }\r\n    }\r\n    var sc = range.startContainer, so = range.startOffset,\r\n      ec = range.endContainer, eo = range.endOffset;\r\n    if (sc.nodeType == 1 && sc === ec && so + 1 === eo) {\r\n      var child = sc.childNodes[so];\r\n      if (child.nodeName.toLowerCase() == 'a') {\r\n        setAttr(child, url, type);\r\n        return self;\r\n      }\r\n    }\r\n    _nativeCommand(doc, 'createlink', '__kindeditor_temp_url__');\r\n    K('a[href=\"__kindeditor_temp_url__\"]', doc).each(function() {\r\n      setAttr(this, url, type);\r\n    });\r\n    return self;\r\n  },\r\n  unlink : function() {\r\n    var self = this, doc = self.doc, range = self.range;\r\n    self.select();\r\n    if (range.collapsed) {\r\n      var a = self.commonNode({ a : '*' });\r\n      if (a) {\r\n        range.selectNode(a.get());\r\n        self.select();\r\n      }\r\n      _nativeCommand(doc, 'unlink', null);\r\n      if (_WEBKIT && K(range.startContainer).name === 'img') {\r\n        var parent = K(range.startContainer).parent();\r\n        if (parent.name === 'a') {\r\n          parent.remove(true);\r\n        }\r\n      }\r\n    } else {\r\n      _nativeCommand(doc, 'unlink', null);\r\n    }\r\n    return self;\r\n  }\r\n});\r\n_each(('formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n  'insertunorderedlist,indent,outdent,subscript,superscript').split(','), function(i, name) {\r\n  KCmd.prototype[name] = function(val) {\r\n    var self = this;\r\n    self.select();\r\n    _nativeCommand(self.doc, name, val);\r\n    if (_IERANGE && _inArray(name, 'justifyleft,justifycenter,justifyright,justifyfull'.split(',')) >= 0) {\r\n      self.selection();\r\n    }\r\n    if (!_IERANGE || _inArray(name, 'formatblock,selectall,insertorderedlist,insertunorderedlist'.split(',')) >= 0) {\r\n      self.selection();\r\n    }\r\n    return self;\r\n  };\r\n});\r\n_each('cut,copy,paste'.split(','), function(i, name) {\r\n  KCmd.prototype[name] = function() {\r\n    var self = this;\r\n    if (!self.doc.queryCommandSupported(name)) {\r\n      throw 'not supported';\r\n    }\r\n    self.select();\r\n    _nativeCommand(self.doc, name, null);\r\n    return self;\r\n  };\r\n});\r\nfunction _cmd(mixed) {\r\n  if (mixed.nodeName) {\r\n    var doc = _getDoc(mixed);\r\n    mixed = _range(doc).selectNodeContents(doc.body).collapse(false);\r\n  }\r\n  return new KCmd(mixed);\r\n}\r\nK.CmdClass = KCmd;\r\nK.cmd = _cmd;\r\n\r\n\r\nfunction _drag(options) {\r\n  var moveEl = options.moveEl,\r\n    moveFn = options.moveFn,\r\n    clickEl = options.clickEl || moveEl,\r\n    beforeDrag = options.beforeDrag,\r\n    iframeFix = options.iframeFix === undefined ? true : options.iframeFix;\r\n  var docs = [document];\r\n  if (iframeFix) {\r\n    K('iframe').each(function() {\r\n      var src = _formatUrl(this.src || '', 'absolute');\r\n      if (/^https?:\\/\\//.test(src)) {\r\n        return;\r\n      }\r\n      var doc;\r\n      try {\r\n        doc = _iframeDoc(this);\r\n      } catch(e) {}\r\n      if (doc) {\r\n        var pos = K(this).pos();\r\n        K(doc).data('pos-x', pos.x);\r\n        K(doc).data('pos-y', pos.y);\r\n        docs.push(doc);\r\n      }\r\n    });\r\n  }\r\n  clickEl.mousedown(function(e) {\r\n    if(e.button !== 0 && e.button !== 1) {\r\n      return;\r\n    }\r\n    e.stopPropagation();\r\n    var self = clickEl.get(),\r\n      x = _removeUnit(moveEl.css('left')),\r\n      y = _removeUnit(moveEl.css('top')),\r\n      width = moveEl.width(),\r\n      height = moveEl.height(),\r\n      pageX = e.pageX,\r\n      pageY = e.pageY;\r\n    if (beforeDrag) {\r\n      beforeDrag();\r\n    }\r\n    function moveListener(e) {\r\n      e.preventDefault();\r\n      var kdoc = K(_getDoc(e.target));\r\n      var diffX = _round((kdoc.data('pos-x') || 0) + e.pageX - pageX);\r\n      var diffY = _round((kdoc.data('pos-y') || 0) + e.pageY - pageY);\r\n      moveFn.call(clickEl, x, y, width, height, diffX, diffY);\r\n    }\r\n    function selectListener(e) {\r\n      e.preventDefault();\r\n    }\r\n    function upListener(e) {\r\n      e.preventDefault();\r\n      K(docs).unbind('mousemove', moveListener)\r\n        .unbind('mouseup', upListener)\r\n        .unbind('selectstart', selectListener);\r\n      if (self.releaseCapture) {\r\n        self.releaseCapture();\r\n      }\r\n    }\r\n    K(docs).mousemove(moveListener)\r\n      .mouseup(upListener)\r\n      .bind('selectstart', selectListener);\r\n    if (self.setCapture) {\r\n      self.setCapture();\r\n    }\r\n  });\r\n}\r\n\r\n\r\nfunction KWidget(options) {\r\n  this.init(options);\r\n}\r\n_extend(KWidget, {\r\n  init : function(options) {\r\n    var self = this;\r\n    self.name = options.name || '';\r\n    self.doc = options.doc || document;\r\n    self.win = _getWin(self.doc);\r\n    self.x = _addUnit(options.x);\r\n    self.y = _addUnit(options.y);\r\n    self.z = options.z;\r\n    self.width = _addUnit(options.width);\r\n    self.height = _addUnit(options.height);\r\n    self.div = K('<div style=\"display:block;\"></div>');\r\n    self.options = options;\r\n    self._alignEl = options.alignEl;\r\n    if (self.width) {\r\n      self.div.css('width', self.width);\r\n    }\r\n    if (self.height) {\r\n      self.div.css('height', self.height);\r\n    }\r\n    if (self.z) {\r\n      self.div.css({\r\n        position : 'absolute',\r\n        left : self.x,\r\n        top : self.y,\r\n        'z-index' : self.z\r\n      });\r\n    }\r\n    if (self.z && (self.x === undefined || self.y === undefined)) {\r\n      self.autoPos(self.width, self.height);\r\n    }\r\n    if (options.cls) {\r\n      self.div.addClass(options.cls);\r\n    }\r\n    if (options.shadowMode) {\r\n      self.div.addClass('ke-shadow');\r\n    }\r\n    if (options.css) {\r\n      self.div.css(options.css);\r\n    }\r\n    if (options.src) {\r\n      K(options.src).replaceWith(self.div);\r\n    } else {\r\n      K(self.doc.body).append(self.div);\r\n    }\r\n    if (options.html) {\r\n      self.div.html(options.html);\r\n    }\r\n    if (options.autoScroll) {\r\n      if (_IE && _V < 7 || _QUIRKS) {\r\n        var scrollPos = _getScrollPos();\r\n        K(self.win).bind('scroll', function(e) {\r\n          var pos = _getScrollPos(),\r\n            diffX = pos.x - scrollPos.x,\r\n            diffY = pos.y - scrollPos.y;\r\n          self.pos(_removeUnit(self.x) + diffX, _removeUnit(self.y) + diffY, false);\r\n        });\r\n      } else {\r\n        self.div.css('position', 'fixed');\r\n      }\r\n    }\r\n  },\r\n  pos : function(x, y, updateProp) {\r\n    var self = this;\r\n    updateProp = _undef(updateProp, true);\r\n    if (x !== null) {\r\n      x = x < 0 ? 0 : _addUnit(x);\r\n      self.div.css('left', x);\r\n      if (updateProp) {\r\n        self.x = x;\r\n      }\r\n    }\r\n    if (y !== null) {\r\n      y = y < 0 ? 0 : _addUnit(y);\r\n      self.div.css('top', y);\r\n      if (updateProp) {\r\n        self.y = y;\r\n      }\r\n    }\r\n    return self;\r\n  },\r\n  autoPos : function(width, height) {\r\n    var x, y, self = this,\r\n      w = _removeUnit(width) || 0,\r\n      h = _removeUnit(height) || 0,\r\n      scrollPos = _getScrollPos();\r\n    if (self._alignEl) {\r\n      var knode = K(self._alignEl),\r\n        pos = knode.pos(),\r\n        diffX = _round(knode[0].clientWidth / 2 - w / 2),\r\n        diffY = _round(knode[0].clientHeight / 2 - h / 2);\r\n      x = diffX < 0 ? pos.x : pos.x + diffX;\r\n      y = diffY < 0 ? pos.y : pos.y + diffY;\r\n    } else {\r\n      var docEl = _docElement(self.doc);\r\n      x = _round(scrollPos.x + (docEl.clientWidth - w) / 2);\r\n      y = _round(scrollPos.y + (docEl.clientHeight - h) / 2);\r\n    }\r\n    if (!(_IE && _V < 7 || _QUIRKS)) {\r\n      x -= scrollPos.x;\r\n      y -= scrollPos.y;\r\n    }\r\n    return self.pos(x, y);\r\n  },\r\n  remove : function() {\r\n    var self = this;\r\n    if (_IE && _V < 7 || _QUIRKS) {\r\n      K(self.win).unbind('scroll');\r\n    }\r\n    self.div.remove();\r\n    _each(self, function(i) {\r\n      self[i] = null;\r\n    });\r\n    return this;\r\n  },\r\n  show : function() {\r\n    this.div.show();\r\n    return this;\r\n  },\r\n  hide : function() {\r\n    this.div.hide();\r\n    return this;\r\n  },\r\n  draggable : function(options) {\r\n    var self = this;\r\n    options = options || {};\r\n    options.moveEl = self.div;\r\n    options.moveFn = function(x, y, width, height, diffX, diffY) {\r\n      if ((x = x + diffX) < 0) {\r\n        x = 0;\r\n      }\r\n      if ((y = y + diffY) < 0) {\r\n        y = 0;\r\n      }\r\n      self.pos(x, y);\r\n    };\r\n    _drag(options);\r\n    return self;\r\n  }\r\n});\r\nfunction _widget(options) {\r\n  return new KWidget(options);\r\n}\r\nK.WidgetClass = KWidget;\r\nK.widget = _widget;\r\n\r\n\r\nfunction _iframeDoc(iframe) {\r\n  iframe = _get(iframe);\r\n  return iframe.contentDocument || iframe.contentWindow.document;\r\n}\r\nvar html, _direction = '';\r\nif ((html = document.getElementsByTagName('html'))) {\r\n  _direction = html[0].dir;\r\n}\r\nfunction _getInitHtml(themesPath, bodyClass, cssPath, cssData) {\r\n  var arr = [\r\n    (_direction === '' ? '<html>' : '<html dir=\"' + _direction + '\">'),\r\n    '<head><meta charset=\"utf-8\" /><title></title>',\r\n    '<style>',\r\n    'html {margin:0;padding:0;}',\r\n    'body {margin:0;padding:5px;}',\r\n    'body, td {font:12px/1.5 \"sans serif\",tahoma,verdana,helvetica;}',\r\n    'body, p, div {word-wrap: break-word;}',\r\n    'p {margin:5px 0;}',\r\n    'table {border-collapse:collapse;}',\r\n    'img {border:0;}',\r\n    'noscript {display:none;}',\r\n    'table.ke-zeroborder td {border:1px dotted #AAA;}',\r\n    'img.ke-flash {',\r\n    ' border:1px solid #AAA;',\r\n    ' background-image:url(' + themesPath + 'common/flash.gif);',\r\n    ' background-position:center center;',\r\n    ' background-repeat:no-repeat;',\r\n    ' width:100px;',\r\n    ' height:100px;',\r\n    '}',\r\n    'img.ke-rm {',\r\n    ' border:1px solid #AAA;',\r\n    ' background-image:url(' + themesPath + 'common/rm.gif);',\r\n    ' background-position:center center;',\r\n    ' background-repeat:no-repeat;',\r\n    ' width:100px;',\r\n    ' height:100px;',\r\n    '}',\r\n    'img.ke-media {',\r\n    ' border:1px solid #AAA;',\r\n    ' background-image:url(' + themesPath + 'common/media.gif);',\r\n    ' background-position:center center;',\r\n    ' background-repeat:no-repeat;',\r\n    ' width:100px;',\r\n    ' height:100px;',\r\n    '}',\r\n    'img.ke-anchor {',\r\n    ' border:1px dashed #666;',\r\n    ' width:16px;',\r\n    ' height:16px;',\r\n    '}',\r\n    '.ke-script, .ke-noscript, .ke-display-none {',\r\n    ' display:none;',\r\n    ' font-size:0;',\r\n    ' width:0;',\r\n    ' height:0;',\r\n    '}',\r\n    '.ke-pagebreak {',\r\n    ' border:1px dotted #AAA;',\r\n    ' font-size:0;',\r\n    ' height:2px;',\r\n    '}',\r\n    '</style>'\r\n  ];\r\n  if (!_isArray(cssPath)) {\r\n    cssPath = [cssPath];\r\n  }\r\n  _each(cssPath, function(i, path) {\r\n    if (path) {\r\n      arr.push('<link href=\"' + path + '\" rel=\"stylesheet\" />');\r\n    }\r\n  });\r\n  if (cssData) {\r\n    arr.push('<style>' + cssData + '</style>');\r\n  }\r\n  arr.push('</head><body ' + (bodyClass ? 'class=\"' + bodyClass + '\"' : '') + '></body></html>');\r\n  return arr.join('\\n');\r\n}\r\nfunction _elementVal(knode, val) {\r\n  if (knode.hasVal()) {\r\n    if (val === undefined) {\r\n      var html = knode.val();\r\n      html = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n      return html;\r\n    }\r\n    return knode.val(val);\r\n  }\r\n  return knode.html(val);\r\n}\r\n\r\n\r\nfunction KEdit(options) {\r\n  this.init(options);\r\n}\r\n_extend(KEdit, KWidget, {\r\n  init : function(options) {\r\n    var self = this;\r\n    KEdit.parent.init.call(self, options);\r\n    self.srcElement = K(options.srcElement);\r\n    self.div.addClass('ke-edit');\r\n    self.designMode = _undef(options.designMode, true);\r\n    self.beforeGetHtml = options.beforeGetHtml;\r\n    self.beforeSetHtml = options.beforeSetHtml;\r\n    self.afterSetHtml = options.afterSetHtml;\r\n    var themesPath = _undef(options.themesPath, ''),\r\n      bodyClass = options.bodyClass,\r\n      cssPath = options.cssPath,\r\n      cssData = options.cssData,\r\n      isDocumentDomain = location.protocol != 'res:' && location.host.replace(/:\\d+/, '') !== document.domain,\r\n      srcScript = ('document.open();' +\r\n        (isDocumentDomain ? 'document.domain=\"' + document.domain + '\";' : '') +\r\n        'document.close();'),\r\n      iframeSrc = _IE ? ' src=\"javascript:void(function(){' + encodeURIComponent(srcScript) + '}())\"' : '';\r\n    self.iframe = K('<iframe class=\"ke-edit-iframe\" hidefocus=\"true\" frameborder=\"0\"' + iframeSrc + '></iframe>').css('width', '100%');\r\n    self.textarea = K('<textarea class=\"ke-edit-textarea\" hidefocus=\"true\"></textarea>').css('width', '100%');\r\n    self.tabIndex = isNaN(parseInt(options.tabIndex, 10)) ? self.srcElement.attr('tabindex') : parseInt(options.tabIndex, 10);\r\n    self.iframe.attr('tabindex', self.tabIndex);\r\n    self.textarea.attr('tabindex', self.tabIndex);\r\n    if (self.width) {\r\n      self.setWidth(self.width);\r\n    }\r\n    if (self.height) {\r\n      self.setHeight(self.height);\r\n    }\r\n    if (self.designMode) {\r\n      self.textarea.hide();\r\n    } else {\r\n      self.iframe.hide();\r\n    }\r\n    function ready() {\r\n      var doc = _iframeDoc(self.iframe);\r\n      doc.open();\r\n      if (isDocumentDomain) {\r\n        doc.domain = document.domain;\r\n      }\r\n      doc.write(_getInitHtml(themesPath, bodyClass, cssPath, cssData));\r\n      doc.close();\r\n      self.win = self.iframe[0].contentWindow;\r\n      self.doc = doc;\r\n      var cmd = _cmd(doc);\r\n      self.afterChange(function(e) {\r\n        cmd.selection();\r\n      });\r\n      if (_WEBKIT) {\r\n        K(doc).click(function(e) {\r\n          if (K(e.target).name === 'img') {\r\n            cmd.selection(true);\r\n            cmd.range.selectNode(e.target);\r\n            cmd.select();\r\n          }\r\n        });\r\n      }\r\n      if (_IE) {\r\n        self._mousedownHandler = function() {\r\n          var newRange = cmd.range.cloneRange();\r\n          newRange.shrink();\r\n          if (newRange.isControl()) {\r\n            self.blur();\r\n          }\r\n        };\r\n        K(document).mousedown(self._mousedownHandler);\r\n        K(doc).keydown(function(e) {\r\n          if (e.which == 8) {\r\n            cmd.selection();\r\n            var rng = cmd.range;\r\n            if (rng.isControl()) {\r\n              rng.collapse(true);\r\n              K(rng.startContainer.childNodes[rng.startOffset]).remove();\r\n              e.preventDefault();\r\n            }\r\n          }\r\n        });\r\n      }\r\n      self.cmd = cmd;\r\n      self.html(_elementVal(self.srcElement));\r\n      if (_IE) {\r\n        doc.body.disabled = true;\r\n        doc.body.contentEditable = true;\r\n        doc.body.removeAttribute('disabled');\r\n      } else {\r\n        doc.designMode = 'on';\r\n      }\r\n      if (options.afterCreate) {\r\n        options.afterCreate.call(self);\r\n      }\r\n    }\r\n    if (isDocumentDomain) {\r\n      self.iframe.bind('load', function(e) {\r\n        self.iframe.unbind('load');\r\n        if (_IE) {\r\n          ready();\r\n        } else {\r\n          setTimeout(ready, 0);\r\n        }\r\n      });\r\n    }\r\n    self.div.append(self.iframe);\r\n    self.div.append(self.textarea);\r\n    self.srcElement.hide();\r\n    !isDocumentDomain && ready();\r\n  },\r\n  setWidth : function(val) {\r\n    var self = this;\r\n    val = _addUnit(val);\r\n    self.width = val;\r\n    self.div.css('width', val);\r\n    return self;\r\n  },\r\n  setHeight : function(val) {\r\n    var self = this;\r\n    val = _addUnit(val);\r\n    self.height = val;\r\n    self.div.css('height', val);\r\n    self.iframe.css('height', val);\r\n    if ((_IE && _V < 8) || _QUIRKS) {\r\n      val = _addUnit(_removeUnit(val) - 2);\r\n    }\r\n    self.textarea.css('height', val);\r\n    return self;\r\n  },\r\n  remove : function() {\r\n    var self = this, doc = self.doc;\r\n    K(doc.body).unbind();\r\n    K(doc).unbind();\r\n    K(self.win).unbind();\r\n    if (self._mousedownHandler) {\r\n      K(document).unbind('mousedown', self._mousedownHandler);\r\n    }\r\n    _elementVal(self.srcElement, self.html());\r\n    self.srcElement.show();\r\n    self.iframe.unbind();\r\n    self.textarea.unbind();\r\n    KEdit.parent.remove.call(self);\r\n  },\r\n  html : function(val, isFull) {\r\n    var self = this, doc = self.doc;\r\n    if (self.designMode) {\r\n      var body = doc.body;\r\n      if (val === undefined) {\r\n        if (isFull) {\r\n          val = '<!doctype html><html>' + body.parentNode.innerHTML + '</html>';\r\n        } else {\r\n          val = body.innerHTML;\r\n        }\r\n        if (self.beforeGetHtml) {\r\n          val = self.beforeGetHtml(val);\r\n        }\r\n        if (_GECKO && val == '<br />') {\r\n          val = '';\r\n        }\r\n        return val;\r\n      }\r\n      if (self.beforeSetHtml) {\r\n        val = self.beforeSetHtml(val);\r\n      }\r\n      if (_IE && _V >= 9) {\r\n        val = val.replace(/(<.*?checked=\")checked(\".*>)/ig, '$1$2');\r\n      }\r\n      K(body).html(val);\r\n      if (self.afterSetHtml) {\r\n        self.afterSetHtml();\r\n      }\r\n      return self;\r\n    }\r\n    if (val === undefined) {\r\n      return self.textarea.val();\r\n    }\r\n    self.textarea.val(val);\r\n    return self;\r\n  },\r\n  design : function(bool) {\r\n    var self = this, val;\r\n    if (bool === undefined ? !self.designMode : bool) {\r\n      if (!self.designMode) {\r\n        val = self.html();\r\n        self.designMode = true;\r\n        self.textarea.hide();\r\n        self.html(val);\r\n        var iframe = self.iframe;\r\n        var height = _removeUnit(self.height);\r\n        iframe.height(height - 2);\r\n        iframe.show();\r\n        setTimeout(function() {\r\n          iframe.height(height);\r\n        }, 0);\r\n      }\r\n    } else {\r\n      if (self.designMode) {\r\n        val = self.html();\r\n        self.designMode = false;\r\n        self.html(val);\r\n        self.iframe.hide();\r\n        self.textarea.show();\r\n      }\r\n    }\r\n    return self.focus();\r\n  },\r\n  focus : function() {\r\n    var self = this;\r\n    self.designMode ? self.win.focus() : self.textarea[0].focus();\r\n    return self;\r\n  },\r\n  blur : function() {\r\n    var self = this;\r\n    if (_IE) {\r\n      var input = K('<input type=\"text\" style=\"float:left;width:0;height:0;padding:0;margin:0;border:0;\" value=\"\" />', self.div);\r\n      self.div.append(input);\r\n      input[0].focus();\r\n      input.remove();\r\n    } else {\r\n      self.designMode ? self.win.blur() : self.textarea[0].blur();\r\n    }\r\n    return self;\r\n  },\r\n  afterChange : function(fn) {\r\n    var self = this, doc = self.doc, body = doc.body;\r\n    K(doc).keyup(function(e) {\r\n      if (!e.ctrlKey && !e.altKey && _CHANGE_KEY_MAP[e.which]) {\r\n        fn(e);\r\n      }\r\n    });\r\n    K(doc).mouseup(fn).contextmenu(fn);\r\n    K(self.win).blur(fn);\r\n    function timeoutHandler(e) {\r\n      setTimeout(function() {\r\n        fn(e);\r\n      }, 1);\r\n    }\r\n    K(body).bind('paste', timeoutHandler);\r\n    K(body).bind('cut', timeoutHandler);\r\n    return self;\r\n  }\r\n});\r\nfunction _edit(options) {\r\n  return new KEdit(options);\r\n}\r\nK.EditClass = KEdit;\r\nK.edit = _edit;\r\nK.iframeDoc = _iframeDoc;\r\n\r\n\r\nfunction _selectToolbar(name, fn) {\r\n  var self = this,\r\n    knode = self.get(name);\r\n  if (knode) {\r\n    if (knode.hasClass('ke-disabled')) {\r\n      return;\r\n    }\r\n    fn(knode);\r\n  }\r\n}\r\n\r\n\r\nfunction KToolbar(options) {\r\n  this.init(options);\r\n}\r\n_extend(KToolbar, KWidget, {\r\n  init : function(options) {\r\n    var self = this;\r\n    KToolbar.parent.init.call(self, options);\r\n    self.disableMode = _undef(options.disableMode, false);\r\n    self.noDisableItemMap = _toMap(_undef(options.noDisableItems, []));\r\n    self._itemMap = {};\r\n    self.div.addClass('ke-toolbar').bind('contextmenu,mousedown,mousemove', function(e) {\r\n      e.preventDefault();\r\n    }).attr('unselectable', 'on');\r\n    function find(target) {\r\n      var knode = K(target);\r\n      if (knode.hasClass('ke-outline')) {\r\n        return knode;\r\n      }\r\n      if (knode.hasClass('ke-toolbar-icon')) {\r\n        return knode.parent();\r\n      }\r\n    }\r\n    function hover(e, method) {\r\n      var knode = find(e.target);\r\n      if (knode) {\r\n        if (knode.hasClass('ke-disabled')) {\r\n          return;\r\n        }\r\n        if (knode.hasClass('ke-selected')) {\r\n          return;\r\n        }\r\n        knode[method]('ke-on');\r\n      }\r\n    }\r\n    self.div.mouseover(function(e) {\r\n      hover(e, 'addClass');\r\n    })\r\n    .mouseout(function(e) {\r\n      hover(e, 'removeClass');\r\n    })\r\n    .click(function(e) {\r\n      var knode = find(e.target);\r\n      if (knode) {\r\n        if (knode.hasClass('ke-disabled')) {\r\n          return;\r\n        }\r\n        self.options.click.call(this, e, knode.attr('data-name'));\r\n      }\r\n    });\r\n  },\r\n  get : function(name) {\r\n    if (this._itemMap[name]) {\r\n      return this._itemMap[name];\r\n    }\r\n    return (this._itemMap[name] = K('span.ke-icon-' + name, this.div).parent());\r\n  },\r\n  select : function(name) {\r\n    _selectToolbar.call(this, name, function(knode) {\r\n      knode.addClass('ke-selected');\r\n    });\r\n    return self;\r\n  },\r\n  unselect : function(name) {\r\n    _selectToolbar.call(this, name, function(knode) {\r\n      knode.removeClass('ke-selected').removeClass('ke-on');\r\n    });\r\n    return self;\r\n  },\r\n  enable : function(name) {\r\n    var self = this,\r\n      knode = name.get ? name : self.get(name);\r\n    if (knode) {\r\n      knode.removeClass('ke-disabled');\r\n      knode.opacity(1);\r\n    }\r\n    return self;\r\n  },\r\n  disable : function(name) {\r\n    var self = this,\r\n      knode = name.get ? name : self.get(name);\r\n    if (knode) {\r\n      knode.removeClass('ke-selected').addClass('ke-disabled');\r\n      knode.opacity(0.5);\r\n    }\r\n    return self;\r\n  },\r\n  disableAll : function(bool, noDisableItems) {\r\n    var self = this, map = self.noDisableItemMap, item;\r\n    if (noDisableItems) {\r\n      map = _toMap(noDisableItems);\r\n    }\r\n    if (bool === undefined ? !self.disableMode : bool) {\r\n      K('span.ke-outline', self.div).each(function() {\r\n        var knode = K(this),\r\n          name = knode[0].getAttribute('data-name', 2);\r\n        if (!map[name]) {\r\n          self.disable(knode);\r\n        }\r\n      });\r\n      self.disableMode = true;\r\n    } else {\r\n      K('span.ke-outline', self.div).each(function() {\r\n        var knode = K(this),\r\n          name = knode[0].getAttribute('data-name', 2);\r\n        if (!map[name]) {\r\n          self.enable(knode);\r\n        }\r\n      });\r\n      self.disableMode = false;\r\n    }\r\n    return self;\r\n  }\r\n});\r\nfunction _toolbar(options) {\r\n  return new KToolbar(options);\r\n}\r\nK.ToolbarClass = KToolbar;\r\nK.toolbar = _toolbar;\r\n\r\n\r\n\r\nfunction KMenu(options) {\r\n  this.init(options);\r\n}\r\n_extend(KMenu, KWidget, {\r\n  init : function(options) {\r\n    var self = this;\r\n    options.z = options.z || 811213;\r\n    KMenu.parent.init.call(self, options);\r\n    self.centerLineMode = _undef(options.centerLineMode, true);\r\n    self.div.addClass('ke-menu').bind('click,mousedown', function(e){\r\n      e.stopPropagation();\r\n    }).attr('unselectable', 'on');\r\n  },\r\n  addItem : function(item) {\r\n    var self = this;\r\n    if (item.title === '-') {\r\n      self.div.append(K('<div class=\"ke-menu-separator\"></div>'));\r\n      return;\r\n    }\r\n    var itemDiv = K('<div class=\"ke-menu-item\" unselectable=\"on\"></div>'),\r\n      leftDiv = K('<div class=\"ke-inline-block ke-menu-item-left\"></div>'),\r\n      rightDiv = K('<div class=\"ke-inline-block ke-menu-item-right\"></div>'),\r\n      height = _addUnit(item.height),\r\n      iconClass = _undef(item.iconClass, '');\r\n    self.div.append(itemDiv);\r\n    if (height) {\r\n      itemDiv.css('height', height);\r\n      rightDiv.css('line-height', height);\r\n    }\r\n    var centerDiv;\r\n    if (self.centerLineMode) {\r\n      centerDiv = K('<div class=\"ke-inline-block ke-menu-item-center\"></div>');\r\n      if (height) {\r\n        centerDiv.css('height', height);\r\n      }\r\n    }\r\n    itemDiv.mouseover(function(e) {\r\n      K(this).addClass('ke-menu-item-on');\r\n      if (centerDiv) {\r\n        centerDiv.addClass('ke-menu-item-center-on');\r\n      }\r\n    })\r\n    .mouseout(function(e) {\r\n      K(this).removeClass('ke-menu-item-on');\r\n      if (centerDiv) {\r\n        centerDiv.removeClass('ke-menu-item-center-on');\r\n      }\r\n    })\r\n    .click(function(e) {\r\n      item.click.call(K(this));\r\n      e.stopPropagation();\r\n    })\r\n    .append(leftDiv);\r\n    if (centerDiv) {\r\n      itemDiv.append(centerDiv);\r\n    }\r\n    itemDiv.append(rightDiv);\r\n    if (item.checked) {\r\n      iconClass = 'ke-icon-checked';\r\n    }\r\n    if (iconClass !== '') {\r\n      leftDiv.html('<span class=\"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ' + iconClass + '\"></span>');\r\n    }\r\n    rightDiv.html(item.title);\r\n    return self;\r\n  },\r\n  remove : function() {\r\n    var self = this;\r\n    if (self.options.beforeRemove) {\r\n      self.options.beforeRemove.call(self);\r\n    }\r\n    K('.ke-menu-item', self.div[0]).unbind();\r\n    KMenu.parent.remove.call(self);\r\n    return self;\r\n  }\r\n});\r\nfunction _menu(options) {\r\n  return new KMenu(options);\r\n}\r\nK.MenuClass = KMenu;\r\nK.menu = _menu;\r\n\r\n\r\n\r\nfunction KColorPicker(options) {\r\n  this.init(options);\r\n}\r\n_extend(KColorPicker, KWidget, {\r\n  init : function(options) {\r\n    var self = this;\r\n    options.z = options.z || 811213;\r\n    KColorPicker.parent.init.call(self, options);\r\n    var colors = options.colors || [\r\n      ['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n      ['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n      ['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n      ['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n    ];\r\n    self.selectedColor = (options.selectedColor || '').toLowerCase();\r\n    self._cells = [];\r\n    self.div.addClass('ke-colorpicker').bind('click,mousedown', function(e){\r\n      e.stopPropagation();\r\n    }).attr('unselectable', 'on');\r\n    var table = self.doc.createElement('table');\r\n    self.div.append(table);\r\n    table.className = 'ke-colorpicker-table';\r\n    table.cellPadding = 0;\r\n    table.cellSpacing = 0;\r\n    table.border = 0;\r\n    var row = table.insertRow(0), cell = row.insertCell(0);\r\n    cell.colSpan = colors[0].length;\r\n    self._addAttr(cell, '', 'ke-colorpicker-cell-top');\r\n    for (var i = 0; i < colors.length; i++) {\r\n      row = table.insertRow(i + 1);\r\n      for (var j = 0; j < colors[i].length; j++) {\r\n        cell = row.insertCell(j);\r\n        self._addAttr(cell, colors[i][j], 'ke-colorpicker-cell');\r\n      }\r\n    }\r\n  },\r\n  _addAttr : function(cell, color, cls) {\r\n    var self = this;\r\n    cell = K(cell).addClass(cls);\r\n    if (self.selectedColor === color.toLowerCase()) {\r\n      cell.addClass('ke-colorpicker-cell-selected');\r\n    }\r\n    cell.attr('title', color || self.options.noColor);\r\n    cell.mouseover(function(e) {\r\n      K(this).addClass('ke-colorpicker-cell-on');\r\n    });\r\n    cell.mouseout(function(e) {\r\n      K(this).removeClass('ke-colorpicker-cell-on');\r\n    });\r\n    cell.click(function(e) {\r\n      e.stop();\r\n      self.options.click.call(K(this), color);\r\n    });\r\n    if (color) {\r\n      cell.append(K('<div class=\"ke-colorpicker-cell-color\" unselectable=\"on\"></div>').css('background-color', color));\r\n    } else {\r\n      cell.html(self.options.noColor);\r\n    }\r\n    K(cell).attr('unselectable', 'on');\r\n    self._cells.push(cell);\r\n  },\r\n  remove : function() {\r\n    var self = this;\r\n    _each(self._cells, function() {\r\n      this.unbind();\r\n    });\r\n    KColorPicker.parent.remove.call(self);\r\n    return self;\r\n  }\r\n});\r\nfunction _colorpicker(options) {\r\n  return new KColorPicker(options);\r\n}\r\nK.ColorPickerClass = KColorPicker;\r\nK.colorpicker = _colorpicker;\r\n\r\nfunction KUploadButton(options) {\r\n  \r\n  this.init(options);\r\n}\r\n_extend(KUploadButton, {\r\n  init : function(options) {\r\n    var self = this,\r\n      button = K(options.button),\r\n      fieldName = options.fieldName || 'file',\r\n      url = options.url || '',\r\n      title = button.val(),\r\n      extraParams = options.extraParams || {},\r\n      cls = button[0].className || '',\r\n      target = options.target || 'kindeditor_upload_iframe_' + new Date().getTime();\r\n    options.afterError = options.afterError || function(str) {\r\n      alert(str);\r\n    };\r\n    var hiddenElements = [];\r\n    for(var k in extraParams){\r\n      hiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n    }\r\n    var html = [\r\n      '<div class=\"ke-inline-block ' + cls + '\">',\r\n      (options.target ? '' : '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>'),\r\n      (options.form ? '<div class=\"ke-upload-area\">' : '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + url + '\">'),\r\n      '<span class=\"ke-button-common\">',\r\n      hiddenElements.join(''),\r\n      '<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + title + '\" />',\r\n      '</span>',\r\n      '<input type=\"file\" class=\"ke-upload-file\" name=\"' + fieldName + '\" tabindex=\"-1\" />',\r\n      (options.form ? '</div>' : '</form>'),\r\n      '</div>'].join('');\r\n    var div = K(html, button.doc);\r\n    button.hide();\r\n    button.before(div);\r\n    self.div = div;\r\n    self.button = button;\r\n    self.iframe = options.target ? K('iframe[name=\"' + target + '\"]') : K('iframe', div);\r\n    self.form = options.form ? K(options.form) : K('form', div);\r\n    self.fileBox = K('.ke-upload-file', div);\r\n    var width = options.width || K('.ke-button-common', div).width();\r\n    K('.ke-upload-area', div).width(width);\r\n    self.options = options;\r\n  },\r\n  submit : function(customUploadImg, attachType) {\r\n    var self = this;\r\n\r\n    // 2017-11-06 \r\n    var files = self.fileBox[0].files\r\n\r\n    // \r\n    var form = self.fileBox[0].form\r\n\r\n    if('image' === '' + attachType){\r\n      // \r\n      var client_width = form.children[1].children['client_width'].value || 0\r\n      var client_height = form.children[1].children['client_height'].value || 0\r\n\r\n      files[0].client_width = client_width\r\n      files[0].client_height = client_height\r\n    }\r\n\r\n    var insert = function(url){\r\n      var data = {error: 0, url}\r\n      self.options.afterUpload.call(self, data)\r\n      console.log('_queryAll:', _queryAll)\r\n    }\r\n    customUploadImg(files, insert, attachType)\r\n\r\n    return self\r\n\r\n    // 2017-11-06 \r\n    // var self = this,\r\n    //   iframe = self.iframe;\r\n    // iframe.bind('load', function() {\r\n    //   iframe.unbind();\r\n    //   var tempForm = document.createElement('form');\r\n    //   self.fileBox.before(tempForm);\r\n    //   K(tempForm).append(self.fileBox);\r\n    //   tempForm.reset();\r\n    //   K(tempForm).remove(true);\r\n    //   // K.iframeDoc(iframe)\r\n    //   var doc = K.iframeDoc(iframe),\r\n    //     pre = doc.getElementsByTagName('pre')[0],\r\n    //     str = '', data;\r\n    //   if (pre) {\r\n    //     str = pre.innerHTML;\r\n    //   } else {\r\n    //     str = doc.body.innerHTML;\r\n    //   }\r\n    //   str = _unescape(str);\r\n    //   iframe[0].src = 'javascript:false';\r\n    //   try {\r\n    //     data = K.json(str);\r\n    //   } catch (e) {\r\n    //     self.options.afterError.call(self, '<!doctype html><html>' + doc.body.parentNode.innerHTML + '</html>');\r\n    //   }\r\n    //   if (data) {\r\n    //     self.options.afterUpload.call(self, data);\r\n    //   }\r\n    // });\r\n    // self.form[0].submit();\r\n    // return self;\r\n  },\r\n  remove : function() {\r\n    var self = this;\r\n    if (self.fileBox) {\r\n      self.fileBox.unbind();\r\n    }\r\n    self.iframe.remove();\r\n    self.div.remove();\r\n    self.button.show();\r\n    return self;\r\n  }\r\n});\r\nfunction _uploadbutton(options) {\r\n  return new KUploadButton(options);\r\n}\r\nK.UploadButtonClass = KUploadButton;\r\nK.uploadbutton = _uploadbutton;\r\n\r\n\r\nfunction _createButton(arg) {\r\n  arg = arg || {};\r\n  var name = arg.name || '',\r\n    span = K('<span class=\"ke-button-common ke-button-outer\" title=\"' + name + '\"></span>'),\r\n    btn = K('<input class=\"ke-button-common ke-button\" type=\"button\" value=\"' + name + '\" />');\r\n  if (arg.click) {\r\n    btn.click(arg.click);\r\n  }\r\n  span.append(btn);\r\n  return span;\r\n}\r\n\r\n\r\nfunction KDialog(options) {\r\n  this.init(options);\r\n}\r\n_extend(KDialog, KWidget, {\r\n  init : function(options) {\r\n    var self = this;\r\n    var shadowMode = _undef(options.shadowMode, true);\r\n    options.z = options.z || 811213;\r\n    options.shadowMode = false;\r\n    options.autoScroll = _undef(options.autoScroll, true);\r\n    KDialog.parent.init.call(self, options);\r\n    var title = options.title,\r\n      body = K(options.body, self.doc),\r\n      previewBtn = options.previewBtn,\r\n      yesBtn = options.yesBtn,\r\n      noBtn = options.noBtn,\r\n      closeBtn = options.closeBtn,\r\n      showMask = _undef(options.showMask, true);\r\n    self.div.addClass('ke-dialog').bind('click,mousedown', function(e){\r\n      e.stopPropagation();\r\n    });\r\n    var contentDiv = K('<div class=\"ke-dialog-content\"></div>').appendTo(self.div);\r\n    if (_IE && _V < 7) {\r\n      self.iframeMask = K('<iframe src=\"about:blank\" class=\"ke-dialog-shadow\"></iframe>').appendTo(self.div);\r\n    } else if (shadowMode) {\r\n      K('<div class=\"ke-dialog-shadow\"></div>').appendTo(self.div);\r\n    }\r\n    var headerDiv = K('<div class=\"ke-dialog-header\"></div>');\r\n    contentDiv.append(headerDiv);\r\n    headerDiv.html(title);\r\n    self.closeIcon = K('<span class=\"ke-dialog-icon-close\" title=\"' + closeBtn.name + '\"></span>').click(closeBtn.click);\r\n    headerDiv.append(self.closeIcon);\r\n    self.draggable({\r\n      clickEl : headerDiv,\r\n      beforeDrag : options.beforeDrag\r\n    });\r\n    var bodyDiv = K('<div class=\"ke-dialog-body\"></div>');\r\n    contentDiv.append(bodyDiv);\r\n    bodyDiv.append(body);\r\n    var footerDiv = K('<div class=\"ke-dialog-footer\"></div>');\r\n    if (previewBtn || yesBtn || noBtn) {\r\n      contentDiv.append(footerDiv);\r\n    }\r\n    _each([\r\n      { btn : previewBtn, name : 'preview' },\r\n      { btn : yesBtn, name : 'yes' },\r\n      { btn : noBtn, name : 'no' }\r\n    ], function() {\r\n      if (this.btn) {\r\n        var button = _createButton(this.btn);\r\n        button.addClass('ke-dialog-' + this.name);\r\n        footerDiv.append(button);\r\n      }\r\n    });\r\n    if (self.height) {\r\n      bodyDiv.height(_removeUnit(self.height) - headerDiv.height() - footerDiv.height());\r\n    }\r\n    self.div.width(self.div.width());\r\n    self.div.height(self.div.height());\r\n    self.mask = null;\r\n    if (showMask) {\r\n      var docEl = _docElement(self.doc),\r\n        docWidth = Math.max(docEl.scrollWidth, docEl.clientWidth),\r\n        docHeight = Math.max(docEl.scrollHeight, docEl.clientHeight);\r\n      self.mask = _widget({\r\n        x : 0,\r\n        y : 0,\r\n        z : self.z - 1,\r\n        cls : 'ke-dialog-mask',\r\n        width : docWidth,\r\n        height : docHeight\r\n      });\r\n    }\r\n    self.autoPos(self.div.width(), self.div.height());\r\n    self.footerDiv = footerDiv;\r\n    self.bodyDiv = bodyDiv;\r\n    self.headerDiv = headerDiv;\r\n    self.isLoading = false;\r\n  },\r\n  setMaskIndex : function(z) {\r\n    var self = this;\r\n    self.mask.div.css('z-index', z);\r\n  },\r\n  showLoading : function(msg) {\r\n    msg = _undef(msg, '');\r\n    var self = this, body = self.bodyDiv;\r\n    self.loading = K('<div class=\"ke-dialog-loading\"><div class=\"ke-inline-block ke-dialog-loading-content\" style=\"margin-top:' + Math.round(body.height() / 3) + 'px;\">' + msg + '</div></div>')\r\n      .width(body.width()).height(body.height())\r\n      .css('top', self.headerDiv.height() + 'px');\r\n    body.css('visibility', 'hidden').after(self.loading);\r\n    self.isLoading = true;\r\n    return self;\r\n  },\r\n  hideLoading : function() {\r\n    this.loading && this.loading.remove();\r\n    this.bodyDiv.css('visibility', 'visible');\r\n    this.isLoading = false;\r\n    return this;\r\n  },\r\n  remove : function() {\r\n    var self = this;\r\n    if (self.options.beforeRemove) {\r\n      self.options.beforeRemove.call(self);\r\n    }\r\n    self.mask && self.mask.remove();\r\n    self.iframeMask && self.iframeMask.remove();\r\n    self.closeIcon.unbind();\r\n    K('input', self.div).unbind();\r\n    K('button', self.div).unbind();\r\n    self.footerDiv.unbind();\r\n    self.bodyDiv.unbind();\r\n    self.headerDiv.unbind();\r\n    K('iframe', self.div).each(function() {\r\n      K(this).remove();\r\n    });\r\n    KDialog.parent.remove.call(self);\r\n    return self;\r\n  }\r\n});\r\nfunction _dialog(options) {\r\n  return new KDialog(options);\r\n}\r\nK.DialogClass = KDialog;\r\nK.dialog = _dialog;\r\n\r\n\r\nfunction _tabs(options) {\r\n  var self = _widget(options),\r\n    remove = self.remove,\r\n    afterSelect = options.afterSelect,\r\n    div = self.div,\r\n    liList = [];\r\n  div.addClass('ke-tabs')\r\n    .bind('contextmenu,mousedown,mousemove', function(e) {\r\n      e.preventDefault();\r\n    });\r\n  var ul = K('<ul class=\"ke-tabs-ul ke-clearfix\"></ul>');\r\n  div.append(ul);\r\n  self.add = function(tab) {\r\n    var li = K('<li class=\"ke-tabs-li\">' + tab.title + '</li>');\r\n    li.data('tab', tab);\r\n    liList.push(li);\r\n    ul.append(li);\r\n  };\r\n  self.selectedIndex = 0;\r\n  self.select = function(index) {\r\n    self.selectedIndex = index;\r\n    _each(liList, function(i, li) {\r\n      li.unbind();\r\n      if (i === index) {\r\n        li.addClass('ke-tabs-li-selected');\r\n        K(li.data('tab').panel).show('');\r\n      } else {\r\n        li.removeClass('ke-tabs-li-selected').removeClass('ke-tabs-li-on')\r\n        .mouseover(function() {\r\n          K(this).addClass('ke-tabs-li-on');\r\n        })\r\n        .mouseout(function() {\r\n          K(this).removeClass('ke-tabs-li-on');\r\n        })\r\n        .click(function() {\r\n          self.select(i);\r\n        });\r\n        K(li.data('tab').panel).hide();\r\n      }\r\n    });\r\n    if (afterSelect) {\r\n      afterSelect.call(self, index);\r\n    }\r\n  };\r\n  self.remove = function() {\r\n    _each(liList, function() {\r\n      this.remove();\r\n    });\r\n    ul.remove();\r\n    remove.call(self);\r\n  };\r\n  return self;\r\n}\r\nK.tabs = _tabs;\r\n\r\n\r\nfunction _loadScript(url, fn) {\r\n  var head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n    script = document.createElement('script');\r\n  head.appendChild(script);\r\n  script.src = url;\r\n  script.charset = 'utf-8';\r\n  script.onload = script.onreadystatechange = function() {\r\n    if (!this.readyState || this.readyState === 'loaded') {\r\n      if (fn) {\r\n        fn();\r\n      }\r\n      script.onload = script.onreadystatechange = null;\r\n      head.removeChild(script);\r\n    }\r\n  };\r\n}\r\n\r\n\r\nfunction _chopQuery(url) {\r\n  var index = url.indexOf('?');\r\n  return index > 0 ? url.substr(0, index) : url;\r\n}\r\nfunction _loadStyle(url) {\r\n  var head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n    link = document.createElement('link'),\r\n    absoluteUrl = _chopQuery(_formatUrl(url, 'absolute'));\r\n  var links = K('link[rel=\"stylesheet\"]', head);\r\n  for (var i = 0, len = links.length; i < len; i++) {\r\n    if (_chopQuery(_formatUrl(links[i].href, 'absolute')) === absoluteUrl) {\r\n      return;\r\n    }\r\n  }\r\n  head.appendChild(link);\r\n  link.href = url;\r\n  link.rel = 'stylesheet';\r\n}\r\nfunction _ajax(url, fn, method, param, dataType) {\r\n  method = method || 'GET';\r\n  dataType = dataType || 'json';\r\n  var xhr = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');\r\n  xhr.open(method, url, true);\r\n  xhr.onreadystatechange = function () {\r\n    if (xhr.readyState == 4 && xhr.status == 200) {\r\n      if (fn) {\r\n        var data = _trim(xhr.responseText);\r\n        if (dataType == 'json') {\r\n          data = _json(data);\r\n        }\r\n        fn(data);\r\n      }\r\n    }\r\n  };\r\n  if (method == 'POST') {\r\n    var params = [];\r\n    _each(param, function(key, val) {\r\n      params.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\r\n    });\r\n    try {\r\n      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n    } catch (e) {}\r\n    xhr.send(params.join('&'));\r\n  } else {\r\n    xhr.send(null);\r\n  }\r\n}\r\nK.loadScript = _loadScript;\r\nK.loadStyle = _loadStyle;\r\nK.ajax = _ajax;\r\n\r\n\r\nvar _plugins = {};\r\nfunction _plugin(name, fn) {\r\n  if (name === undefined) {\r\n    return _plugins;\r\n  }\r\n  if (!fn) {\r\n    return _plugins[name];\r\n  }\r\n  _plugins[name] = fn;\r\n}\r\nvar _language = {};\r\nfunction _parseLangKey(key) {\r\n  var match, ns = 'core';\r\n  if ((match = /^(\\w+)\\.(\\w+)$/.exec(key))) {\r\n    ns = match[1];\r\n    key = match[2];\r\n  }\r\n  return { ns : ns, key : key };\r\n}\r\nfunction _lang(mixed, langType) {\r\n  langType = langType === undefined ? K.options.langType : langType;\r\n  if (typeof mixed === 'string') {\r\n    if (!_language[langType]) {\r\n      return 'no language';\r\n    }\r\n    var pos = mixed.length - 1;\r\n    if (mixed.substr(pos) === '.') {\r\n      return _language[langType][mixed.substr(0, pos)];\r\n    }\r\n    var obj = _parseLangKey(mixed);\r\n    return _language[langType][obj.ns][obj.key];\r\n  }\r\n  _each(mixed, function(key, val) {\r\n    var obj = _parseLangKey(key);\r\n    if (!_language[langType]) {\r\n      _language[langType] = {};\r\n    }\r\n    if (!_language[langType][obj.ns]) {\r\n      _language[langType][obj.ns] = {};\r\n    }\r\n    _language[langType][obj.ns][obj.key] = val;\r\n  });\r\n}\r\n\r\n\r\nfunction _getImageFromRange(range, fn) {\r\n  if (range.collapsed) {\r\n    return;\r\n  }\r\n  range = range.cloneRange().up();\r\n  var sc = range.startContainer, so = range.startOffset;\r\n  if (!_WEBKIT && !range.isControl()) {\r\n    return;\r\n  }\r\n  var img = K(sc.childNodes[so]);\r\n  if (!img || img.name != 'img') {\r\n    return;\r\n  }\r\n  if (fn(img)) {\r\n    return img;\r\n  }\r\n}\r\nfunction _bindContextmenuEvent() {\r\n  var self = this, doc = self.edit.doc;\r\n  K(doc).contextmenu(function(e) {\r\n    if (self.menu) {\r\n      self.hideMenu();\r\n    }\r\n    if (!self.useContextmenu) {\r\n      e.preventDefault();\r\n      return;\r\n    }\r\n    if (self._contextmenus.length === 0) {\r\n      return;\r\n    }\r\n    var maxWidth = 0, items = [];\r\n    _each(self._contextmenus, function() {\r\n      if (this.title == '-') {\r\n        items.push(this);\r\n        return;\r\n      }\r\n      if (this.cond && this.cond()) {\r\n        items.push(this);\r\n        if (this.width && this.width > maxWidth) {\r\n          maxWidth = this.width;\r\n        }\r\n      }\r\n    });\r\n    while (items.length > 0 && items[0].title == '-') {\r\n      items.shift();\r\n    }\r\n    while (items.length > 0 && items[items.length - 1].title == '-') {\r\n      items.pop();\r\n    }\r\n    var prevItem = null;\r\n    _each(items, function(i) {\r\n      if (this.title == '-' && prevItem.title == '-') {\r\n        delete items[i];\r\n      }\r\n      prevItem = this;\r\n    });\r\n    if (items.length > 0) {\r\n      e.preventDefault();\r\n      var pos = K(self.edit.iframe).pos(),\r\n        menu = _menu({\r\n          x : pos.x + e.clientX,\r\n          y : pos.y + e.clientY,\r\n          width : maxWidth,\r\n          css : { visibility: 'hidden' },\r\n          shadowMode : self.shadowMode\r\n        });\r\n      _each(items, function() {\r\n        if (this.title) {\r\n          menu.addItem(this);\r\n        }\r\n      });\r\n      var docEl = _docElement(menu.doc),\r\n        menuHeight = menu.div.height();\r\n      if (e.clientY + menuHeight >= docEl.clientHeight - 100) {\r\n        menu.pos(menu.x, _removeUnit(menu.y) - menuHeight);\r\n      }\r\n      menu.div.css('visibility', 'visible');\r\n      self.menu = menu;\r\n    }\r\n  });\r\n}\r\nfunction _bindNewlineEvent() {\r\n  var self = this, doc = self.edit.doc, newlineTag = self.newlineTag;\r\n  if (_IE && newlineTag !== 'br') {\r\n    return;\r\n  }\r\n  if (_GECKO && _V < 3 && newlineTag !== 'p') {\r\n    return;\r\n  }\r\n  if (_OPERA && _V < 9) {\r\n    return;\r\n  }\r\n  var brSkipTagMap = _toMap('h1,h2,h3,h4,h5,h6,pre,li'),\r\n    pSkipTagMap = _toMap('p,h1,h2,h3,h4,h5,h6,pre,li,blockquote');\r\n  function getAncestorTagName(range) {\r\n    var ancestor = K(range.commonAncestor());\r\n    while (ancestor) {\r\n      if (ancestor.type == 1 && !ancestor.isStyle()) {\r\n        break;\r\n      }\r\n      ancestor = ancestor.parent();\r\n    }\r\n    return ancestor.name;\r\n  }\r\n  K(doc).keydown(function(e) {\r\n    if (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n      return;\r\n    }\r\n    self.cmd.selection();\r\n    var tagName = getAncestorTagName(self.cmd.range);\r\n    if (tagName == 'marquee' || tagName == 'select') {\r\n      return;\r\n    }\r\n    if (newlineTag === 'br' && !brSkipTagMap[tagName]) {\r\n      e.preventDefault();\r\n      self.insertHtml('<br />' + (_IE && _V < 9 ? '' : '\\u200B'));\r\n      return;\r\n    }\r\n    if (!pSkipTagMap[tagName]) {\r\n      _nativeCommand(doc, 'formatblock', '<p>');\r\n    }\r\n  });\r\n  K(doc).keyup(function(e) {\r\n    if (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n      return;\r\n    }\r\n    if (newlineTag == 'br') {\r\n      return;\r\n    }\r\n    if (_GECKO) {\r\n      var root = self.cmd.commonAncestor('p');\r\n      var a = self.cmd.commonAncestor('a');\r\n      if (a && a.text() == '') {\r\n        a.remove(true);\r\n        self.cmd.range.selectNodeContents(root[0]).collapse(true);\r\n        self.cmd.select();\r\n      }\r\n      return;\r\n    }\r\n    self.cmd.selection();\r\n    var tagName = getAncestorTagName(self.cmd.range);\r\n    if (tagName == 'marquee' || tagName == 'select') {\r\n      return;\r\n    }\r\n    if (!pSkipTagMap[tagName]) {\r\n      _nativeCommand(doc, 'formatblock', '<p>');\r\n    }\r\n    var div = self.cmd.commonAncestor('div');\r\n    if (div) {\r\n      var p = K('<p></p>'),\r\n        child = div[0].firstChild;\r\n      while (child) {\r\n        var next = child.nextSibling;\r\n        p.append(child);\r\n        child = next;\r\n      }\r\n      div.before(p);\r\n      div.remove();\r\n      self.cmd.range.selectNodeContents(p[0]);\r\n      self.cmd.select();\r\n    }\r\n  });\r\n}\r\nfunction _bindTabEvent() {\r\n  var self = this, doc = self.edit.doc;\r\n  K(doc).keydown(function(e) {\r\n    if (e.which == 9) {\r\n      e.preventDefault();\r\n      if (self.afterTab) {\r\n        self.afterTab.call(self, e);\r\n        return;\r\n      }\r\n      var cmd = self.cmd, range = cmd.range;\r\n      range.shrink();\r\n      if (range.collapsed && range.startContainer.nodeType == 1) {\r\n        range.insertNode(K('@&nbsp;', doc)[0]);\r\n        cmd.select();\r\n      }\r\n      self.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\r\n    }\r\n  });\r\n}\r\nfunction _bindFocusEvent() {\r\n  var self = this;\r\n  K(self.edit.textarea[0], self.edit.win).focus(function(e) {\r\n    if (self.afterFocus) {\r\n      self.afterFocus.call(self, e);\r\n    }\r\n  }).blur(function(e) {\r\n    if (self.afterBlur) {\r\n      self.afterBlur.call(self, e);\r\n    }\r\n  });\r\n}\r\nfunction _removeBookmarkTag(html) {\r\n  return _trim(html.replace(/<span [^>]*id=\"?__kindeditor_bookmark_\\w+_\\d+__\"?[^>]*><\\/span>/ig, ''));\r\n}\r\nfunction _removeTempTag(html) {\r\n  return html.replace(/<div[^>]+class=\"?__kindeditor_paste__\"?[^>]*>[\\s\\S]*?<\\/div>/ig, '');\r\n}\r\nfunction _addBookmarkToStack(stack, bookmark) {\r\n  if (stack.length === 0) {\r\n    stack.push(bookmark);\r\n    return;\r\n  }\r\n  var prev = stack[stack.length - 1];\r\n  if (_removeBookmarkTag(bookmark.html) !== _removeBookmarkTag(prev.html)) {\r\n    stack.push(bookmark);\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction _undoToRedo(fromStack, toStack) {\r\n  var self = this, edit = self.edit,\r\n    body = edit.doc.body,\r\n    range, bookmark;\r\n  if (fromStack.length === 0) {\r\n    return self;\r\n  }\r\n  if (edit.designMode) {\r\n    range = self.cmd.range;\r\n    bookmark = range.createBookmark(true);\r\n    bookmark.html = body.innerHTML;\r\n  } else {\r\n    bookmark = {\r\n      html : body.innerHTML\r\n    };\r\n  }\r\n  _addBookmarkToStack(toStack, bookmark);\r\n  var prev = fromStack.pop();\r\n  if (_removeBookmarkTag(bookmark.html) === _removeBookmarkTag(prev.html) && fromStack.length > 0) {\r\n    prev = fromStack.pop();\r\n  }\r\n  if (edit.designMode) {\r\n    edit.html(prev.html);\r\n    if (prev.start) {\r\n      range.moveToBookmark(prev);\r\n      self.select();\r\n    }\r\n  } else {\r\n    K(body).html(_removeBookmarkTag(prev.html));\r\n  }\r\n  return self;\r\n}\r\nfunction KEditor(options) {\r\n  var self = this;\r\n  self.options = {};\r\n  function setOption(key, val) {\r\n    if (KEditor.prototype[key] === undefined) {\r\n      self[key] = val;\r\n    }\r\n    self.options[key] = val;\r\n  }\r\n  _each(options, function(key, val) {\r\n    setOption(key, options[key]);\r\n  });\r\n  _each(K.options, function(key, val) {\r\n    if (self[key] === undefined) {\r\n      setOption(key, val);\r\n    }\r\n  });\r\n  var se = K(self.srcElement || '<textarea/>');\r\n  if (!self.width) {\r\n    self.width = se[0].style.width || se.width();\r\n  }\r\n  if (!self.height) {\r\n    self.height = se[0].style.height || se.height();\r\n  }\r\n  setOption('width', _undef(self.width, self.minWidth));\r\n  setOption('height', _undef(self.height, self.minHeight));\r\n  setOption('width', _addUnit(self.width));\r\n  setOption('height', _addUnit(self.height));\r\n  if (_MOBILE && (!_IOS || _V < 534)) {\r\n    self.designMode = false;\r\n  }\r\n  self.srcElement = se;\r\n  self.initContent = '';\r\n  self.plugin = {};\r\n  self.isCreated = false;\r\n  self._handlers = {};\r\n  self._contextmenus = [];\r\n  self._undoStack = [];\r\n  self._redoStack = [];\r\n  self._firstAddBookmark = true;\r\n  self.menu = self.contextmenu = null;\r\n  self.dialogs = [];\r\n}\r\nKEditor.prototype = {\r\n  lang : function(mixed) {\r\n    return _lang(mixed, this.langType);\r\n  },\r\n  loadPlugin : function(name, fn) {\r\n    var self = this;\r\n    var _pluginStatus = this._pluginStatus;\r\n    if (!_pluginStatus) {\r\n      _pluginStatus = this._pluginStatus = {};\r\n    }\r\n    if (_plugins[name]) {\r\n      if (!_isFunction(_plugins[name])) {\r\n        setTimeout(function() {\r\n          self.loadPlugin(name, fn);\r\n        }, 100);\r\n        return self;\r\n      }\r\n      if(!_pluginStatus[name]) {\r\n        _plugins[name].call(self, KindEditor);\r\n        _pluginStatus[name] = 'inited';\r\n      }\r\n      if (fn) {\r\n        fn.call(self);\r\n      }\r\n      return self;\r\n    }\r\n    _plugins[name] = 'loading';\r\n    _loadScript(self.pluginsPath + name + '/' + name + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n      setTimeout(function() {\r\n        if (_plugins[name]) {\r\n          self.loadPlugin(name, fn);\r\n        }\r\n      }, 0);\r\n    });\r\n    return self;\r\n  },\r\n  handler : function(key, fn) {\r\n    var self = this;\r\n    if (!self._handlers[key]) {\r\n      self._handlers[key] = [];\r\n    }\r\n    if (_isFunction(fn)) {\r\n      self._handlers[key].push(fn);\r\n      return self;\r\n    }\r\n    _each(self._handlers[key], function() {\r\n      fn = this.call(self, fn);\r\n    });\r\n    return fn;\r\n  },\r\n  clickToolbar : function(name, fn) {\r\n    var self = this, key = 'clickToolbar' + name;\r\n    if (fn === undefined) {\r\n      if (self._handlers[key]) {\r\n        return self.handler(key);\r\n      }\r\n      self.loadPlugin(name, function() {\r\n        self.handler(key);\r\n      });\r\n      return self;\r\n    }\r\n    return self.handler(key, fn);\r\n  },\r\n  updateState : function() {\r\n    var self = this;\r\n    _each(('justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,' +\r\n      'subscript,superscript,bold,italic,underline,strikethrough').split(','), function(i, name) {\r\n      self.cmd.state(name) ? self.toolbar.select(name) : self.toolbar.unselect(name);\r\n    });\r\n    return self;\r\n  },\r\n  addContextmenu : function(item) {\r\n    this._contextmenus.push(item);\r\n    return this;\r\n  },\r\n  afterCreate : function(fn) {\r\n    return this.handler('afterCreate', fn);\r\n  },\r\n  beforeRemove : function(fn) {\r\n    return this.handler('beforeRemove', fn);\r\n  },\r\n  beforeGetHtml : function(fn) {\r\n    return this.handler('beforeGetHtml', fn);\r\n  },\r\n  beforeSetHtml : function(fn) {\r\n    return this.handler('beforeSetHtml', fn);\r\n  },\r\n  afterSetHtml : function(fn) {\r\n    return this.handler('afterSetHtml', fn);\r\n  },\r\n  create : function() {\r\n    var self = this, fullscreenMode = self.fullscreenMode;\r\n    if (self.isCreated) {\r\n      return self;\r\n    }\r\n    if (self.srcElement.data('kindeditor')) {\r\n      return self;\r\n    }\r\n    self.srcElement.data('kindeditor', 'true');\r\n    if (fullscreenMode) {\r\n      _docElement().style.overflow = 'hidden';\r\n    } else {\r\n      _docElement().style.overflow = '';\r\n    }\r\n    var width = fullscreenMode ? _docElement().clientWidth + 'px' : self.width,\r\n      height = fullscreenMode ? _docElement().clientHeight + 'px' : self.height;\r\n    if ((_IE && _V < 8) || _QUIRKS) {\r\n      height = _addUnit(_removeUnit(height) + 2);\r\n    }\r\n    var container = self.container = K(self.layout);\r\n    if (fullscreenMode) {\r\n      K(document.body).append(container);\r\n    } else {\r\n      self.srcElement.before(container);\r\n    }\r\n    var toolbarDiv = K('.toolbar', container),\r\n      editDiv = K('.edit', container),\r\n      statusbar = self.statusbar = K('.statusbar', container);\r\n    container.removeClass('container')\r\n      .addClass('ke-container ke-container-' + self.themeType).css('width', width);\r\n    if (fullscreenMode) {\r\n      container.css({\r\n        position : 'absolute',\r\n        left : 0,\r\n        top : 0,\r\n        'z-index' : 811211\r\n      });\r\n      if (!_GECKO) {\r\n        self._scrollPos = _getScrollPos();\r\n      }\r\n      window.scrollTo(0, 0);\r\n      K(document.body).css({\r\n        'height' : '1px',\r\n        'overflow' : 'hidden'\r\n      });\r\n      K(document.body.parentNode).css('overflow', 'hidden');\r\n      self._fullscreenExecuted = true;\r\n    } else {\r\n      if (self._fullscreenExecuted) {\r\n        K(document.body).css({\r\n          'height' : '',\r\n          'overflow' : ''\r\n        });\r\n        K(document.body.parentNode).css('overflow', '');\r\n      }\r\n      if (self._scrollPos) {\r\n        window.scrollTo(self._scrollPos.x, self._scrollPos.y);\r\n      }\r\n    }\r\n    var htmlList = [];\r\n    K.each(self.items, function(i, name) {\r\n      if (name == '|') {\r\n        htmlList.push('<span class=\"ke-inline-block ke-separator\"></span>');\r\n      } else if (name == '/') {\r\n        htmlList.push('<div class=\"ke-hr\"></div>');\r\n      } else {\r\n        htmlList.push('<span class=\"ke-outline\" data-name=\"' + name + '\" title=\"' + self.lang(name) + '\" unselectable=\"on\">');\r\n        htmlList.push('<span class=\"ke-toolbar-icon ke-toolbar-icon-url ke-icon-' + name + '\" unselectable=\"on\"></span></span>');\r\n      }\r\n    });\r\n    var toolbar = self.toolbar = _toolbar({\r\n      src : toolbarDiv,\r\n      html : htmlList.join(''),\r\n      noDisableItems : self.noDisableItems,\r\n      click : function(e, name) {\r\n        e.stop();\r\n        if (self.menu) {\r\n          var menuName = self.menu.name;\r\n          self.hideMenu();\r\n          if (menuName === name) {\r\n            return;\r\n          }\r\n        }\r\n        self.clickToolbar(name);\r\n      }\r\n    });\r\n    var editHeight = _removeUnit(height) - toolbar.div.height();\r\n    var edit = self.edit = _edit({\r\n      height : editHeight > 0 && _removeUnit(height) > self.minHeight ? editHeight : self.minHeight,\r\n      src : editDiv,\r\n      srcElement : self.srcElement,\r\n      designMode : self.designMode,\r\n      themesPath : self.themesPath,\r\n      bodyClass : self.bodyClass,\r\n      cssPath : self.cssPath,\r\n      cssData : self.cssData,\r\n      beforeGetHtml : function(html) {\r\n        html = self.beforeGetHtml(html);\r\n        html = _removeBookmarkTag(_removeTempTag(html));\r\n        return _formatHtml(html, self.filterMode ? self.htmlTags : null, self.urlType, self.wellFormatMode, self.indentChar);\r\n      },\r\n      beforeSetHtml : function(html) {\r\n        html = _formatHtml(html, self.filterMode ? self.htmlTags : null, '', false);\r\n        return self.beforeSetHtml(html);\r\n      },\r\n      afterSetHtml : function() {\r\n        self.edit = edit = this;\r\n        self.afterSetHtml();\r\n      },\r\n      afterCreate : function() {\r\n        self.edit = edit = this;\r\n        self.cmd = edit.cmd;\r\n        self._docMousedownFn = function(e) {\r\n          if (self.menu) {\r\n            self.hideMenu();\r\n          }\r\n        };\r\n        K(edit.doc, document).mousedown(self._docMousedownFn);\r\n        _bindContextmenuEvent.call(self);\r\n        _bindNewlineEvent.call(self);\r\n        _bindTabEvent.call(self);\r\n        _bindFocusEvent.call(self);\r\n        edit.afterChange(function(e) {\r\n          if (!edit.designMode) {\r\n            return;\r\n          }\r\n          self.updateState();\r\n          self.addBookmark();\r\n          if (self.options.afterChange) {\r\n            self.options.afterChange.call(self);\r\n          }\r\n        });\r\n        edit.textarea.keyup(function(e) {\r\n          if (!e.ctrlKey && !e.altKey && _INPUT_KEY_MAP[e.which]) {\r\n            if (self.options.afterChange) {\r\n              self.options.afterChange.call(self);\r\n            }\r\n          }\r\n        });\r\n        if (self.readonlyMode) {\r\n          self.readonly();\r\n        }\r\n        self.isCreated = true;\r\n        if (self.initContent === '') {\r\n          self.initContent = self.html();\r\n        }\r\n        if (self._undoStack.length > 0) {\r\n          var prev = self._undoStack.pop();\r\n          if (prev.start) {\r\n            self.html(prev.html);\r\n            edit.cmd.range.moveToBookmark(prev);\r\n            self.select();\r\n          }\r\n        }\r\n        self.afterCreate();\r\n        if (self.options.afterCreate) {\r\n          self.options.afterCreate.call(self);\r\n        }\r\n      }\r\n    });\r\n    statusbar.removeClass('statusbar').addClass('ke-statusbar')\r\n      .append('<span class=\"ke-inline-block ke-statusbar-center-icon\"></span>')\r\n      .append('<span class=\"ke-inline-block ke-statusbar-right-icon\"></span>');\r\n    if (self._fullscreenResizeHandler) {\r\n      K(window).unbind('resize', self._fullscreenResizeHandler);\r\n      self._fullscreenResizeHandler = null;\r\n    }\r\n    function initResize() {\r\n      if (statusbar.height() === 0) {\r\n        setTimeout(initResize, 100);\r\n        return;\r\n      }\r\n      self.resize(width, height, false);\r\n    }\r\n    initResize();\r\n    if (fullscreenMode) {\r\n      self._fullscreenResizeHandler = function(e) {\r\n        if (self.isCreated) {\r\n          self.resize(_docElement().clientWidth, _docElement().clientHeight, false);\r\n        }\r\n      };\r\n      K(window).bind('resize', self._fullscreenResizeHandler);\r\n      toolbar.select('fullscreen');\r\n      statusbar.first().css('visibility', 'hidden');\r\n      statusbar.last().css('visibility', 'hidden');\r\n    } else {\r\n      if (_GECKO) {\r\n        K(window).bind('scroll', function(e) {\r\n          self._scrollPos = _getScrollPos();\r\n        });\r\n      }\r\n      if (self.resizeType > 0) {\r\n        _drag({\r\n          moveEl : container,\r\n          clickEl : statusbar,\r\n          moveFn : function(x, y, width, height, diffX, diffY) {\r\n            height += diffY;\r\n            self.resize(null, height);\r\n          }\r\n        });\r\n      } else {\r\n        statusbar.first().css('visibility', 'hidden');\r\n      }\r\n      if (self.resizeType === 2) {\r\n        _drag({\r\n          moveEl : container,\r\n          clickEl : statusbar.last(),\r\n          moveFn : function(x, y, width, height, diffX, diffY) {\r\n            width += diffX;\r\n            height += diffY;\r\n            self.resize(width, height);\r\n          }\r\n        });\r\n      } else {\r\n        statusbar.last().css('visibility', 'hidden');\r\n      }\r\n    }\r\n    return self;\r\n  },\r\n  remove : function() {\r\n    var self = this;\r\n    if (!self.isCreated) {\r\n      return self;\r\n    }\r\n    self.beforeRemove();\r\n    self.srcElement.data('kindeditor', '');\r\n    if (self.menu) {\r\n      self.hideMenu();\r\n    }\r\n    _each(self.dialogs, function() {\r\n      self.hideDialog();\r\n    });\r\n    K(document).unbind('mousedown', self._docMousedownFn);\r\n    self.toolbar.remove();\r\n    self.edit.remove();\r\n    self.statusbar.last().unbind();\r\n    self.statusbar.unbind();\r\n    self.container.remove();\r\n    self.container = self.toolbar = self.edit = self.menu = null;\r\n    self.dialogs = [];\r\n    self.isCreated = false;\r\n    return self;\r\n  },\r\n  resize : function(width, height, updateProp) {\r\n    var self = this;\r\n    updateProp = _undef(updateProp, true);\r\n    if (width) {\r\n      if (!/%/.test(width)) {\r\n        width = _removeUnit(width);\r\n        width = width < self.minWidth ? self.minWidth : width;\r\n      }\r\n      self.container.css('width', _addUnit(width));\r\n      if (updateProp) {\r\n        self.width = _addUnit(width);\r\n      }\r\n    }\r\n    if (height) {\r\n      height = _removeUnit(height);\r\n      var editHeight = _removeUnit(height) - self.toolbar.div.height() - self.statusbar.height();\r\n      editHeight = editHeight < self.minHeight ? self.minHeight : editHeight;\r\n      self.edit.setHeight(editHeight);\r\n      if (updateProp) {\r\n        self.height = _addUnit(height);\r\n      }\r\n    }\r\n    return self;\r\n  },\r\n  select : function() {\r\n    this.isCreated && this.cmd.select();\r\n    return this;\r\n  },\r\n  html : function(val) {\r\n    var self = this;\r\n    if (val === undefined) {\r\n      return self.isCreated ? self.edit.html() : _elementVal(self.srcElement);\r\n    }\r\n    self.isCreated ? self.edit.html(val) : _elementVal(self.srcElement, val);\r\n    if (self.isCreated) {\r\n      self.cmd.selection();\r\n    }\r\n    return self;\r\n  },\r\n  fullHtml : function() {\r\n    return this.isCreated ? this.edit.html(undefined, true) : '';\r\n  },\r\n  text : function(val) {\r\n    var self = this;\r\n    if (val === undefined) {\r\n      return _trim(self.html().replace(/<(?!img|embed).*?>/ig, '').replace(/&nbsp;/ig, ' '));\r\n    } else {\r\n      return self.html(_escape(val));\r\n    }\r\n  },\r\n  isEmpty : function() {\r\n    return _trim(this.text().replace(/\\r\\n|\\n|\\r/, '')) === '';\r\n  },\r\n  isDirty : function() {\r\n    return _trim(this.initContent.replace(/\\r\\n|\\n|\\r|t/g, '')) !== _trim(this.html().replace(/\\r\\n|\\n|\\r|t/g, ''));\r\n  },\r\n  selectedHtml : function() {\r\n    var val = this.isCreated ? this.cmd.range.html() : '';\r\n    val = _removeBookmarkTag(_removeTempTag(val));\r\n    return val;\r\n  },\r\n  count : function(mode) {\r\n    var self = this;\r\n    mode = (mode || 'html').toLowerCase();\r\n    if (mode === 'html') {\r\n      return self.html().length;\r\n    }\r\n    if (mode === 'text') {\r\n      return self.text().replace(/<(?:img|embed).*?>/ig, 'K').replace(/\\r\\n|\\n|\\r/g, '').length;\r\n    }\r\n    return 0;\r\n  },\r\n  exec : function(key) {\r\n    key = key.toLowerCase();\r\n    var self = this, cmd = self.cmd,\r\n      changeFlag = _inArray(key, 'selectall,copy,paste,print'.split(',')) < 0;\r\n    if (changeFlag) {\r\n      self.addBookmark(false);\r\n    }\r\n    cmd[key].apply(cmd, _toArray(arguments, 1));\r\n    if (changeFlag) {\r\n      self.updateState();\r\n      self.addBookmark(false);\r\n      if (self.options.afterChange) {\r\n        self.options.afterChange.call(self);\r\n      }\r\n    }\r\n    return self;\r\n  },\r\n  insertHtml : function(val, quickMode) {\r\n    if (!this.isCreated) {\r\n      return this;\r\n    }\r\n    val = this.beforeSetHtml(val);\r\n    this.exec('inserthtml', val, quickMode);\r\n    return this;\r\n  },\r\n  appendHtml : function(val) {\r\n    this.html(this.html() + val);\r\n    if (this.isCreated) {\r\n      var cmd = this.cmd;\r\n      cmd.range.selectNodeContents(cmd.doc.body).collapse(false);\r\n      cmd.select();\r\n    }\r\n    return this;\r\n  },\r\n  sync : function() {\r\n    _elementVal(this.srcElement, this.html());\r\n    return this;\r\n  },\r\n  focus : function() {\r\n    this.isCreated ? this.edit.focus() : this.srcElement[0].focus();\r\n    return this;\r\n  },\r\n  blur : function() {\r\n    this.isCreated ? this.edit.blur() : this.srcElement[0].blur();\r\n    return this;\r\n  },\r\n  addBookmark : function(checkSize) {\r\n    checkSize = _undef(checkSize, true);\r\n    var self = this, edit = self.edit,\r\n      body = edit.doc.body,\r\n      html = _removeTempTag(body.innerHTML), bookmark;\r\n    if (checkSize && self._undoStack.length > 0) {\r\n      var prev = self._undoStack[self._undoStack.length - 1];\r\n      if (Math.abs(html.length - _removeBookmarkTag(prev.html).length) < self.minChangeSize) {\r\n        return self;\r\n      }\r\n    }\r\n    if (edit.designMode && !self._firstAddBookmark) {\r\n      var range = self.cmd.range;\r\n      bookmark = range.createBookmark(true);\r\n      bookmark.html = _removeTempTag(body.innerHTML);\r\n      range.moveToBookmark(bookmark);\r\n    } else {\r\n      bookmark = {\r\n        html : html\r\n      };\r\n    }\r\n    self._firstAddBookmark = false;\r\n    _addBookmarkToStack(self._undoStack, bookmark);\r\n    return self;\r\n  },\r\n  undo : function() {\r\n    return _undoToRedo.call(this, this._undoStack, this._redoStack);\r\n  },\r\n  redo : function() {\r\n    return _undoToRedo.call(this, this._redoStack, this._undoStack);\r\n  },\r\n  fullscreen : function(bool) {\r\n    this.fullscreenMode = (bool === undefined ? !this.fullscreenMode : bool);\r\n    this.addBookmark(false);\r\n    return this.remove().create();\r\n  },\r\n  readonly : function(isReadonly) {\r\n    isReadonly = _undef(isReadonly, true);\r\n    var self = this, edit = self.edit, doc = edit.doc;\r\n    if (self.designMode) {\r\n      self.toolbar.disableAll(isReadonly, []);\r\n    } else {\r\n      _each(self.noDisableItems, function() {\r\n        self.toolbar[isReadonly ? 'disable' : 'enable'](this);\r\n      });\r\n    }\r\n    if (_IE) {\r\n      doc.body.contentEditable = !isReadonly;\r\n    } else {\r\n      doc.designMode = isReadonly ? 'off' : 'on';\r\n    }\r\n    edit.textarea[0].disabled = isReadonly;\r\n  },\r\n  createMenu : function(options) {\r\n    var self = this,\r\n      name = options.name,\r\n      knode = self.toolbar.get(name),\r\n      pos = knode.pos();\r\n    options.x = pos.x;\r\n    options.y = pos.y + knode.height();\r\n    options.z = self.options.zIndex;\r\n    options.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n    if (options.selectedColor !== undefined) {\r\n      options.cls = 'ke-colorpicker-' + self.themeType;\r\n      options.noColor = self.lang('noColor');\r\n      self.menu = _colorpicker(options);\r\n    } else {\r\n      options.cls = 'ke-menu-' + self.themeType;\r\n      options.centerLineMode = false;\r\n      self.menu = _menu(options);\r\n    }\r\n    return self.menu;\r\n  },\r\n  hideMenu : function() {\r\n    this.menu.remove();\r\n    this.menu = null;\r\n    return this;\r\n  },\r\n  hideContextmenu : function() {\r\n    this.contextmenu.remove();\r\n    this.contextmenu = null;\r\n    return this;\r\n  },\r\n  createDialog : function(options) {\r\n    var self = this, name = options.name;\r\n    options.z = self.options.zIndex;\r\n    options.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n    options.closeBtn = _undef(options.closeBtn, {\r\n      name : self.lang('close'),\r\n      click : function(e) {\r\n        self.hideDialog();\r\n        if (_IE && self.cmd) {\r\n          self.cmd.select();\r\n        }\r\n      }\r\n    });\r\n    options.noBtn = _undef(options.noBtn, {\r\n      name : self.lang(options.yesBtn ? 'no' : 'close'),\r\n      click : function(e) {\r\n        self.hideDialog();\r\n        if (_IE && self.cmd) {\r\n          self.cmd.select();\r\n        }\r\n      }\r\n    });\r\n    if (self.dialogAlignType != 'page') {\r\n      options.alignEl = self.container;\r\n    }\r\n    options.cls = 'ke-dialog-' + self.themeType;\r\n    if (self.dialogs.length > 0) {\r\n      var firstDialog = self.dialogs[0],\r\n        parentDialog = self.dialogs[self.dialogs.length - 1];\r\n      firstDialog.setMaskIndex(parentDialog.z + 2);\r\n      options.z = parentDialog.z + 3;\r\n      options.showMask = false;\r\n    }\r\n    var dialog = _dialog(options);\r\n    self.dialogs.push(dialog);\r\n    return dialog;\r\n  },\r\n  hideDialog : function() {\r\n    var self = this;\r\n    if (self.dialogs.length > 0) {\r\n      self.dialogs.pop().remove();\r\n    }\r\n    if (self.dialogs.length > 0) {\r\n      var firstDialog = self.dialogs[0],\r\n        parentDialog = self.dialogs[self.dialogs.length - 1];\r\n      firstDialog.setMaskIndex(parentDialog.z - 1);\r\n    }\r\n    return self;\r\n  },\r\n  errorDialog : function(html) {\r\n    var self = this;\r\n    var dialog = self.createDialog({\r\n      width : 750,\r\n      title : self.lang('uploadError'),\r\n      body : '<div style=\"padding:10px 20px;\"><iframe frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe></div>'\r\n    });\r\n    var iframe = K('iframe', dialog.div), doc = K.iframeDoc(iframe);\r\n    doc.open();\r\n    doc.write(html);\r\n    doc.close();\r\n    K(doc.body).css('background-color', '#FFF');\r\n    iframe[0].contentWindow.focus();\r\n    return self;\r\n  }\r\n};\r\nfunction _editor(options) {\r\n  return new KEditor(options);\r\n}\r\nvar _instances = [];\r\nfunction _create(expr, options) {\r\n  options = options || {};\r\n  options.basePath = _undef(options.basePath, K.basePath);\r\n  options.themesPath = _undef(options.themesPath, options.basePath + 'themes/');\r\n  options.langPath = _undef(options.langPath, options.basePath + 'lang/');\r\n  options.pluginsPath = _undef(options.pluginsPath, options.basePath + 'plugins/');\r\n  if (_undef(options.loadStyleMode, K.options.loadStyleMode)) {\r\n    var themeType = _undef(options.themeType, K.options.themeType);\r\n    _loadStyle(options.themesPath + 'default/default.css');\r\n    _loadStyle(options.themesPath + themeType + '/' + themeType + '.css');\r\n  }\r\n  function create(editor) {\r\n    _each(_plugins, function(name, fn) {\r\n      if (_isFunction(fn)) {\r\n        fn.call(editor, KindEditor);\r\n        if (!editor._pluginStatus) {\r\n          editor._pluginStatus = {};\r\n        }\r\n        editor._pluginStatus[name] = 'inited';\r\n      }\r\n    });\r\n    return editor.create();\r\n  }\r\n  var knode = K(expr);\r\n  if (!knode || knode.length === 0) {\r\n    return;\r\n  }\r\n  if (knode.length > 1) {\r\n    knode.each(function() {\r\n      _create(this, options);\r\n    });\r\n    return _instances[0];\r\n  }\r\n  options.srcElement = knode[0];\r\n  var editor = new KEditor(options);\r\n  _instances.push(editor);\r\n  if (_language[editor.langType]) {\r\n    return create(editor);\r\n  }\r\n  _loadScript(editor.langPath + editor.langType + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n    create(editor);\r\n  });\r\n  return editor;\r\n}\r\nfunction _eachEditor(expr, fn) {\r\n  K(expr).each(function(i, el) {\r\n    K.each(_instances, function(j, editor) {\r\n      if (editor && editor.srcElement[0] == el) {\r\n        fn.call(editor, j);\r\n        return false;\r\n      }\r\n    });\r\n  });\r\n}\r\nK.remove = function(expr) {\r\n  _eachEditor(expr, function(i) {\r\n    this.remove();\r\n    _instances.splice(i, 1);\r\n  });\r\n};\r\nK.sync = function(expr) {\r\n  _eachEditor(expr, function() {\r\n    this.sync();\r\n  });\r\n};\r\nK.html = function(expr, val) {\r\n  _eachEditor(expr, function() {\r\n    this.html(val);\r\n  });\r\n};\r\nK.insertHtml = function(expr, val) {\r\n  _eachEditor(expr, function() {\r\n    this.insertHtml(val);\r\n  });\r\n};\r\nK.appendHtml = function(expr, val) {\r\n  _eachEditor(expr, function() {\r\n    this.appendHtml(val);\r\n  });\r\n};\r\n\r\n\r\nif (_IE && _V < 7) {\r\n  _nativeCommand(document, 'BackgroundImageCache', true);\r\n}\r\nK.EditorClass = KEditor;\r\nK.editor = _editor;\r\nK.create = _create;\r\nK.instances = _instances;\r\nK.plugin = _plugin;\r\nK.lang = _lang;\r\n\r\n\r\n_plugin('core', function(K) {\r\n  var self = this,\r\n    shortcutKeys = {\r\n      undo : 'Z', redo : 'Y', bold : 'B', italic : 'I', underline : 'U', print : 'P', selectall : 'A'\r\n    };\r\n  self.afterSetHtml(function() {\r\n    if (self.options.afterChange) {\r\n      self.options.afterChange.call(self);\r\n    }\r\n  });\r\n  self.afterCreate(function() {\r\n    if (self.syncType != 'form') {\r\n      return;\r\n    }\r\n    var el = K(self.srcElement), hasForm = false;\r\n    while ((el = el.parent())) {\r\n      if (el.name == 'form') {\r\n        hasForm = true;\r\n        break;\r\n      }\r\n    }\r\n    if (hasForm) {\r\n      el.bind('submit', function(e) {\r\n        self.sync();\r\n        K(window).bind('unload', function() {\r\n          self.edit.textarea.remove();\r\n        });\r\n      });\r\n      var resetBtn = K('[type=\"reset\"]', el);\r\n      resetBtn.click(function() {\r\n        self.html(self.initContent);\r\n        self.cmd.selection();\r\n      });\r\n      self.beforeRemove(function() {\r\n        el.unbind();\r\n        resetBtn.unbind();\r\n      });\r\n    }\r\n  });\r\n  self.clickToolbar('source', function() {\r\n    if (self.edit.designMode) {\r\n      self.toolbar.disableAll(true);\r\n      self.edit.design(false);\r\n      self.toolbar.select('source');\r\n    } else {\r\n      self.toolbar.disableAll(false);\r\n      self.edit.design(true);\r\n      self.toolbar.unselect('source');\r\n      if (_GECKO) {\r\n        setTimeout(function() {\r\n          self.cmd.selection();\r\n        }, 0);\r\n      } else {\r\n        self.cmd.selection();\r\n      }\r\n    }\r\n    self.designMode = self.edit.designMode;\r\n  });\r\n  self.afterCreate(function() {\r\n    if (!self.designMode) {\r\n      self.toolbar.disableAll(true).select('source');\r\n    }\r\n  });\r\n  self.clickToolbar('fullscreen', function() {\r\n    self.fullscreen();\r\n  });\r\n  if (self.fullscreenShortcut) {\r\n    var loaded = false;\r\n    self.afterCreate(function() {\r\n      K(self.edit.doc, self.edit.textarea).keyup(function(e) {\r\n        if (e.which == 27) {\r\n          setTimeout(function() {\r\n            self.fullscreen();\r\n          }, 0);\r\n        }\r\n      });\r\n      if (loaded) {\r\n        if (_IE && !self.designMode) {\r\n          return;\r\n        }\r\n        self.focus();\r\n      }\r\n      if (!loaded) {\r\n        loaded = true;\r\n      }\r\n    });\r\n  }\r\n  _each('undo,redo'.split(','), function(i, name) {\r\n    if (shortcutKeys[name]) {\r\n      self.afterCreate(function() {\r\n        _ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n          self.clickToolbar(name);\r\n        });\r\n      });\r\n    }\r\n    self.clickToolbar(name, function() {\r\n      self[name]();\r\n    });\r\n  });\r\n  self.clickToolbar('formatblock', function() {\r\n    var blocks = self.lang('formatblock.formatBlock'),\r\n      heights = {\r\n        h1 : 28,\r\n        h2 : 24,\r\n        h3 : 18,\r\n        H4 : 14,\r\n        p : 12\r\n      },\r\n      curVal = self.cmd.val('formatblock'),\r\n      menu = self.createMenu({\r\n        name : 'formatblock',\r\n        width : self.langType == 'en' ? 200 : 150\r\n      });\r\n    _each(blocks, function(key, val) {\r\n      var style = 'font-size:' + heights[key] + 'px;';\r\n      if (key.charAt(0) === 'h') {\r\n        style += 'font-weight:bold;';\r\n      }\r\n      menu.addItem({\r\n        title : '<span style=\"' + style + '\" unselectable=\"on\">' + val + '</span>',\r\n        height : heights[key] + 12,\r\n        checked : (curVal === key || curVal === val),\r\n        click : function() {\r\n          self.select().exec('formatblock', '<' + key + '>').hideMenu();\r\n        }\r\n      });\r\n    });\r\n  });\r\n  self.clickToolbar('fontname', function() {\r\n    var curVal = self.cmd.val('fontname'),\r\n      menu = self.createMenu({\r\n        name : 'fontname',\r\n        width : 150\r\n      });\r\n    _each(self.lang('fontname.fontName'), function(key, val) {\r\n      menu.addItem({\r\n        title : '<span style=\"font-family: ' + key + ';\" unselectable=\"on\">' + val + '</span>',\r\n        checked : (curVal === key.toLowerCase() || curVal === val.toLowerCase()),\r\n        click : function() {\r\n          self.exec('fontname', key).hideMenu();\r\n        }\r\n      });\r\n    });\r\n  });\r\n  self.clickToolbar('fontsize', function() {\r\n    var curVal = self.cmd.val('fontsize'),\r\n      menu = self.createMenu({\r\n        name : 'fontsize',\r\n        width : 150\r\n      });\r\n    _each(self.fontSizeTable, function(i, val) {\r\n      menu.addItem({\r\n        title : '<span style=\"font-size:' + val + ';\" unselectable=\"on\">' + val + '</span>',\r\n        height : _removeUnit(val) + 12,\r\n        checked : curVal === val,\r\n        click : function() {\r\n          self.exec('fontsize', val).hideMenu();\r\n        }\r\n      });\r\n    });\r\n  });\r\n  _each('forecolor,hilitecolor'.split(','), function(i, name) {\r\n    self.clickToolbar(name, function() {\r\n      self.createMenu({\r\n        name : name,\r\n        selectedColor : self.cmd.val(name) || 'default',\r\n        colors : self.colorTable,\r\n        click : function(color) {\r\n          self.exec(name, color).hideMenu();\r\n        }\r\n      });\r\n    });\r\n  });\r\n  _each(('cut,copy,paste').split(','), function(i, name) {\r\n    self.clickToolbar(name, function() {\r\n      self.focus();\r\n      try {\r\n        self.exec(name, null);\r\n      } catch(e) {\r\n        alert(self.lang(name + 'Error'));\r\n      }\r\n    });\r\n  });\r\n  self.clickToolbar('about', function() {\r\n    var html = '<div style=\"margin:20px;\">' +\r\n      '<div>KindEditor ' + _VERSION + '</div>' +\r\n      '<div>Copyright &copy; <a href=\"http://www.kindsoft.net/\" target=\"_blank\">kindsoft.net</a> All rights reserved.</div>' +\r\n      '</div>';\r\n    self.createDialog({\r\n      name : 'about',\r\n      width : 350,\r\n      title : self.lang('about'),\r\n      body : html\r\n    });\r\n  });\r\n  self.plugin.getSelectedLink = function() {\r\n    return self.cmd.commonAncestor('a');\r\n  };\r\n  self.plugin.getSelectedImage = function() {\r\n    return _getImageFromRange(self.edit.cmd.range, function(img) {\r\n      return !/^ke-\\w+$/i.test(img[0].className);\r\n    });\r\n  };\r\n  self.plugin.getSelectedFlash = function() {\r\n    return _getImageFromRange(self.edit.cmd.range, function(img) {\r\n      return img[0].className == 'ke-flash';\r\n    });\r\n  };\r\n  self.plugin.getSelectedMedia = function() {\r\n    return _getImageFromRange(self.edit.cmd.range, function(img) {\r\n      return img[0].className == 'ke-media' || img[0].className == 'ke-rm';\r\n    });\r\n  };\r\n  self.plugin.getSelectedAnchor = function() {\r\n    return _getImageFromRange(self.edit.cmd.range, function(img) {\r\n      return img[0].className == 'ke-anchor';\r\n    });\r\n  };\r\n  _each('link,image,flash,media,anchor'.split(','), function(i, name) {\r\n    var uName = name.charAt(0).toUpperCase() + name.substr(1);\r\n    _each('edit,delete'.split(','), function(j, val) {\r\n      self.addContextmenu({\r\n        title : self.lang(val + uName),\r\n        click : function() {\r\n          self.loadPlugin(name, function() {\r\n            self.plugin[name][val]();\r\n            self.hideMenu();\r\n          });\r\n        },\r\n        cond : self.plugin['getSelected' + uName],\r\n        width : 150,\r\n        iconClass : val == 'edit' ? 'ke-icon-' + name : undefined\r\n      });\r\n    });\r\n    self.addContextmenu({ title : '-' });\r\n  });\r\n  self.plugin.getSelectedTable = function() {\r\n    return self.cmd.commonAncestor('table');\r\n  };\r\n  self.plugin.getSelectedRow = function() {\r\n    return self.cmd.commonAncestor('tr');\r\n  };\r\n  self.plugin.getSelectedCell = function() {\r\n    return self.cmd.commonAncestor('td');\r\n  };\r\n  _each(('prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,' +\r\n  'rowsplit,colsplit,coldelete,rowdelete,insert,delete').split(','), function(i, val) {\r\n    var cond = _inArray(val, ['prop', 'delete']) < 0 ? self.plugin.getSelectedCell : self.plugin.getSelectedTable;\r\n    self.addContextmenu({\r\n      title : self.lang('table' + val),\r\n      click : function() {\r\n        self.loadPlugin('table', function() {\r\n          self.plugin.table[val]();\r\n          self.hideMenu();\r\n        });\r\n      },\r\n      cond : cond,\r\n      width : 170,\r\n      iconClass : 'ke-icon-table' + val\r\n    });\r\n  });\r\n  self.addContextmenu({ title : '-' });\r\n  _each(('selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n    'insertunorderedlist,indent,outdent,subscript,superscript,hr,print,' +\r\n    'bold,italic,underline,strikethrough,removeformat,unlink').split(','), function(i, name) {\r\n    if (shortcutKeys[name]) {\r\n      self.afterCreate(function() {\r\n        _ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n          self.cmd.selection();\r\n          self.clickToolbar(name);\r\n        });\r\n      });\r\n    }\r\n    self.clickToolbar(name, function() {\r\n      self.focus().exec(name, null);\r\n    });\r\n  });\r\n  self.afterCreate(function() {\r\n    var doc = self.edit.doc, cmd, bookmark, div,\r\n      cls = '__kindeditor_paste__', pasting = false;\r\n    function movePastedData() {\r\n      cmd.range.moveToBookmark(bookmark);\r\n      cmd.select();\r\n      if (_WEBKIT) {\r\n        K('div.' + cls, div).each(function() {\r\n          K(this).after('<br />').remove(true);\r\n        });\r\n        K('span.Apple-style-span', div).remove(true);\r\n        K('span.Apple-tab-span', div).remove(true);\r\n        K('span[style]', div).each(function() {\r\n          if (K(this).css('white-space') == 'nowrap') {\r\n            K(this).remove(true);\r\n          }\r\n        });\r\n        K('meta', div).remove();\r\n      }\r\n      var html = div[0].innerHTML;\r\n      div.remove();\r\n      if (html === '') {\r\n        return;\r\n      }\r\n      if (_WEBKIT) {\r\n        html = html.replace(/(<br>)\\1/ig, '$1');\r\n      }\r\n      if (self.pasteType === 2) {\r\n        html = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n        if (/schemas-microsoft-com|worddocument|mso-\\w+/i.test(html)) {\r\n          html = _clearMsWord(html, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n        } else {\r\n          html = _formatHtml(html, self.filterMode ? self.htmlTags : null);\r\n          html = self.beforeSetHtml(html);\r\n        }\r\n      }\r\n      if (self.pasteType === 1) {\r\n        html = html.replace(/&nbsp;/ig, ' ');\r\n        html = html.replace(/\\n\\s*\\n/g, '\\n');\r\n        html = html.replace(/<br[^>]*>/ig, '\\n');\r\n        html = html.replace(/<\\/p><p[^>]*>/ig, '\\n');\r\n        html = html.replace(/<[^>]+>/g, '');\r\n        html = html.replace(/ {2}/g, ' &nbsp;');\r\n        if (self.newlineTag == 'p') {\r\n          if (/\\n/.test(html)) {\r\n            html = html.replace(/^/, '<p>').replace(/$/, '<br /></p>').replace(/\\n/g, '<br /></p><p>');\r\n          }\r\n        } else {\r\n          html = html.replace(/\\n/g, '<br />$&');\r\n        }\r\n      }\r\n      self.insertHtml(html, true);\r\n    }\r\n    K(doc.body).bind('paste', function(e){\r\n      if (self.pasteType === 0) {\r\n        e.stop();\r\n        return;\r\n      }\r\n      if (pasting) {\r\n        return;\r\n      }\r\n      pasting = true;\r\n      K('div.' + cls, doc).remove();\r\n      cmd = self.cmd.selection();\r\n      bookmark = cmd.range.createBookmark();\r\n      div = K('<div class=\"' + cls + '\"></div>', doc).css({\r\n        position : 'absolute',\r\n        width : '1px',\r\n        height : '1px',\r\n        overflow : 'hidden',\r\n        left : '-1981px',\r\n        top : K(bookmark.start).pos().y + 'px',\r\n        'white-space' : 'nowrap'\r\n      });\r\n      K(doc.body).append(div);\r\n      if (_IE) {\r\n        var rng = cmd.range.get(true);\r\n        rng.moveToElementText(div[0]);\r\n        rng.select();\r\n        rng.execCommand('paste');\r\n        e.preventDefault();\r\n      } else {\r\n        cmd.range.selectNodeContents(div[0]);\r\n        cmd.select();\r\n        div[0].tabIndex = -1;\r\n        div[0].focus();\r\n      }\r\n      setTimeout(function() {\r\n        movePastedData();\r\n        pasting = false;\r\n      }, 0);\r\n    });\r\n  });\r\n  self.beforeGetHtml(function(html) {\r\n    if (_IE && _V <= 8) {\r\n      html = html.replace(/<div\\s+[^>]*data-ke-input-tag=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, tag) {\r\n        return unescape(tag);\r\n      });\r\n      html = html.replace(/(<input)((?:\\s+[^>]*)?>)/ig, function($0, $1, $2) {\r\n        if (!/\\s+type=\"[^\"]+\"/i.test($0)) {\r\n          return $1 + ' type=\"text\"' + $2;\r\n        }\r\n        return $0;\r\n      });\r\n    }\r\n    return html.replace(/(<(?:noscript|noscript\\s[^>]*)>)([\\s\\S]*?)(<\\/noscript>)/ig, function($0, $1, $2, $3) {\r\n      return $1 + _unescape($2).replace(/\\s+/g, ' ') + $3;\r\n    })\r\n    .replace(/<img[^>]*class=\"?ke-(flash|rm|media)\"?[^>]*>/ig, function(full) {\r\n      var imgAttrs = _getAttrList(full);\r\n      var styles = _getCssList(imgAttrs.style || '');\r\n      var attrs = _mediaAttrs(imgAttrs['data-ke-tag']);\r\n      var width = _undef(styles.width, '');\r\n      var height = _undef(styles.height, '');\r\n      if (/px/i.test(width)) {\r\n        width = _removeUnit(width);\r\n      }\r\n      if (/px/i.test(height)) {\r\n        height = _removeUnit(height);\r\n      }\r\n      attrs.width = _undef(imgAttrs.width, width);\r\n      attrs.height = _undef(imgAttrs.height, height);\r\n      return _mediaEmbed(attrs);\r\n    })\r\n    .replace(/<img[^>]*class=\"?ke-anchor\"?[^>]*>/ig, function(full) {\r\n      var imgAttrs = _getAttrList(full);\r\n      return '<a name=\"' + unescape(imgAttrs['data-ke-name']) + '\"></a>';\r\n    })\r\n    .replace(/<div\\s+[^>]*data-ke-script-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n      return '<script' + unescape(attr) + '>' + unescape(code) + '</script>';\r\n    })\r\n    .replace(/<div\\s+[^>]*data-ke-noscript-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n      return '<noscript' + unescape(attr) + '>' + unescape(code) + '</noscript>';\r\n    })\r\n    .replace(/(<[^>]*)data-ke-src=\"([^\"]*)\"([^>]*>)/ig, function(full, start, src, end) {\r\n      full = full.replace(/(\\s+(?:href|src)=\")[^\"]*(\")/i, function($0, $1, $2) {\r\n        return $1 + _unescape(src) + $2;\r\n      });\r\n      full = full.replace(/\\s+data-ke-src=\"[^\"]*\"/i, '');\r\n      return full;\r\n    })\r\n    .replace(/(<[^>]+\\s)data-ke-(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n      return start + end;\r\n    });\r\n  });\r\n  self.beforeSetHtml(function(html) {\r\n    if (_IE && _V <= 8) {\r\n      html = html.replace(/<input[^>]*>|<(select|button)[^>]*>[\\s\\S]*?<\\/\\1>/ig, function(full) {\r\n        var attrs = _getAttrList(full);\r\n        var styles = _getCssList(attrs.style || '');\r\n        if (styles.display == 'none') {\r\n          return '<div class=\"ke-display-none\" data-ke-input-tag=\"' + escape(full) + '\"></div>';\r\n        }\r\n        return full;\r\n      });\r\n    }\r\n    return html.replace(/<embed[^>]*type=\"([^\"]+)\"[^>]*>(?:<\\/embed>)?/ig, function(full) {\r\n      var attrs = _getAttrList(full);\r\n      attrs.src = _undef(attrs.src, '');\r\n      attrs.width = _undef(attrs.width, 0);\r\n      attrs.height = _undef(attrs.height, 0);\r\n      return _mediaImg(self.themesPath + 'common/blank.gif', attrs);\r\n    })\r\n    .replace(/<a[^>]*name=\"([^\"]+)\"[^>]*>(?:<\\/a>)?/ig, function(full) {\r\n      var attrs = _getAttrList(full);\r\n      if (attrs.href !== undefined) {\r\n        return full;\r\n      }\r\n      return '<img class=\"ke-anchor\" src=\"' + self.themesPath + 'common/anchor.gif\" data-ke-name=\"' + escape(attrs.name) + '\" />';\r\n    })\r\n    .replace(/<script([^>]*)>([\\s\\S]*?)<\\/script>/ig, function(full, attr, code) {\r\n      return '<div class=\"ke-script\" data-ke-script-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n    })\r\n    .replace(/<noscript([^>]*)>([\\s\\S]*?)<\\/noscript>/ig, function(full, attr, code) {\r\n      return '<div class=\"ke-noscript\" data-ke-noscript-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n    })\r\n    .replace(/(<[^>]*)(href|src)=\"([^\"]*)\"([^>]*>)/ig, function(full, start, key, src, end) {\r\n      if (full.match(/\\sdata-ke-src=\"[^\"]*\"/i)) {\r\n        return full;\r\n      }\r\n      full = start + key + '=\"' + src + '\"' + ' data-ke-src=\"' + _escape(src) + '\"' + end;\r\n      return full;\r\n    })\r\n    .replace(/(<[^>]+\\s)(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n      return start + 'data-ke-' + end;\r\n    })\r\n    .replace(/<table[^>]*\\s+border=\"0\"[^>]*>/ig, function(full) {\r\n      if (full.indexOf('ke-zeroborder') >= 0) {\r\n        return full;\r\n      }\r\n      return _addClassToTag(full, 'ke-zeroborder');\r\n    });\r\n  });\r\n});\r\n\r\n\r\n})(window);\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.lang({\r\n  source : 'Source',\r\n  preview : 'Preview',\r\n  undo : 'Undo(Ctrl+Z)',\r\n  redo : 'Redo(Ctrl+Y)',\r\n  cut : 'Cut(Ctrl+X)',\r\n  copy : 'Copy(Ctrl+C)',\r\n  paste : 'Paste(Ctrl+V)',\r\n  plainpaste : 'Paste as plain text',\r\n  wordpaste : 'Paste from Word',\r\n  selectall : 'Select all',\r\n  justifyleft : 'Align left',\r\n  justifycenter : 'Align center',\r\n  justifyright : 'Align right',\r\n  justifyfull : 'Align full',\r\n  insertorderedlist : 'Ordered list',\r\n  insertunorderedlist : 'Unordered list',\r\n  indent : 'Increase indent',\r\n  outdent : 'Decrease indent',\r\n  subscript : 'Subscript',\r\n  superscript : 'Superscript',\r\n  formatblock : 'Paragraph format',\r\n  fontname : 'Font family',\r\n  fontsize : 'Font size',\r\n  forecolor : 'Text color',\r\n  hilitecolor : 'Highlight color',\r\n  bold : 'Bold(Ctrl+B)',\r\n  italic : 'Italic(Ctrl+I)',\r\n  underline : 'Underline(Ctrl+U)',\r\n  strikethrough : 'Strikethrough',\r\n  removeformat : 'Remove format',\r\n  image : 'Image',\r\n  multiimage : 'Multi image',\r\n  flash : 'Flash',\r\n  media : 'Embeded media',\r\n  table : 'Table',\r\n  tablecell : 'Cell',\r\n  hr : 'Insert horizontal line',\r\n  emoticons : 'Insert emoticon',\r\n  link : 'Link',\r\n  unlink : 'Unlink',\r\n  fullscreen : 'Toggle fullscreen mode',\r\n  about : 'About',\r\n  print : 'Print',\r\n  filemanager : 'File Manager',\r\n  code : 'Insert code',\r\n  map : 'Google Maps',\r\n  baidumap : 'Baidu Maps',\r\n  lineheight : 'Line height',\r\n  clearhtml : 'Clear HTML code',\r\n  pagebreak : 'Insert Page Break',\r\n  quickformat : 'Quick Format',\r\n  insertfile : 'Insert file',\r\n  template : 'Insert Template',\r\n  anchor : 'Anchor',\r\n  yes : 'OK',\r\n  no : 'Cancel',\r\n  close : 'Close',\r\n  editImage : 'Image properties',\r\n  deleteImage : 'Delete image',\r\n  editFlash : 'Flash properties',\r\n  deleteFlash : 'Delete flash',\r\n  editMedia : 'Media properties',\r\n  deleteMedia : 'Delete media',\r\n  editLink : 'Link properties',\r\n  deleteLink : 'Unlink',\r\n  editAnchor : 'Anchor properties',\r\n  deleteAnchor : 'Delete Anchor',\r\n  tableprop : 'Table properties',\r\n  tablecellprop : 'Cell properties',\r\n  tableinsert : 'Insert table',\r\n  tabledelete : 'Delete table',\r\n  tablecolinsertleft : 'Insert column left',\r\n  tablecolinsertright : 'Insert column right',\r\n  tablerowinsertabove : 'Insert row above',\r\n  tablerowinsertbelow : 'Insert row below',\r\n  tablerowmerge : 'Merge down',\r\n  tablecolmerge : 'Merge right',\r\n  tablerowsplit : 'Split row',\r\n  tablecolsplit : 'Split column',\r\n  tablecoldelete : 'Delete column',\r\n  tablerowdelete : 'Delete row',\r\n  noColor : 'Default',\r\n  pleaseSelectFile : 'Please select file.',\r\n  invalidImg : \"Please type valid URL.\\nAllowed file extension: jpg,gif,bmp,png\",\r\n  invalidMedia : \"Please type valid URL.\\nAllowed file extension: swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb\",\r\n  invalidWidth : \"The width must be number.\",\r\n  invalidHeight : \"The height must be number.\",\r\n  invalidBorder : \"The border must be number.\",\r\n  invalidUrl : \"Please type valid URL.\",\r\n  invalidRows : 'Invalid rows.',\r\n  invalidCols : 'Invalid columns.',\r\n  invalidPadding : 'The padding must be number.',\r\n  invalidSpacing : 'The spacing must be number.',\r\n  invalidJson : 'Invalid JSON string.',\r\n  uploadSuccess : 'Upload success.',\r\n  cutError : 'Currently not supported by your browser, use keyboard shortcut(Ctrl+X) instead.',\r\n  copyError : 'Currently not supported by your browser, use keyboard shortcut(Ctrl+C) instead.',\r\n  pasteError : 'Currently not supported by your browser, use keyboard shortcut(Ctrl+V) instead.',\r\n  ajaxLoading : 'Loading ...',\r\n  uploadLoading : 'Uploading ...',\r\n  uploadError : 'Upload Error',\r\n  'plainpaste.comment' : 'Use keyboard shortcut(Ctrl+V) to paste the text into the window.',\r\n  'wordpaste.comment' : 'Use keyboard shortcut(Ctrl+V) to paste the text into the window.',\r\n  'code.pleaseInput' : 'Please input code.',\r\n  'link.url' : 'URL',\r\n  'link.linkType' : 'Target',\r\n  'link.newWindow' : 'New window',\r\n  'link.selfWindow' : 'Same window',\r\n  'flash.url' : 'URL',\r\n  'flash.width' : 'Width',\r\n  'flash.height' : 'Height',\r\n  'flash.upload' : 'Upload',\r\n  'flash.viewServer' : 'Browse',\r\n  'media.url' : 'URL',\r\n  'media.width' : 'Width',\r\n  'media.height' : 'Height',\r\n  'media.autostart' : 'Auto start',\r\n  'media.upload' : 'Upload',\r\n  'media.viewServer' : 'Browse',\r\n  'image.remoteImage' : 'Insert URL',\r\n  'image.localImage' : 'Upload',\r\n  'image.remoteUrl' : 'URL',\r\n  'image.localUrl' : 'File',\r\n  'image.size' : 'Size',\r\n  'image.width' : 'Width',\r\n  'image.height' : 'Height',\r\n  'image.resetSize' : 'Reset dimensions',\r\n  'image.align' : 'Align',\r\n  'image.defaultAlign' : 'Default',\r\n  'image.leftAlign' : 'Left',\r\n  'image.rightAlign' : 'Right',\r\n  'image.imgTitle' : 'Title',\r\n  'image.upload' : 'Browse',\r\n  'image.viewServer' : 'Browse',\r\n  'multiimage.uploadDesc' : 'Allows users to upload <%=uploadLimit%> images, single image size not exceeding <%=sizeLimit%>',\r\n  'multiimage.startUpload' : 'Start upload',\r\n  'multiimage.clearAll' : 'Clear all',\r\n  'multiimage.insertAll' : 'Insert all',\r\n  'multiimage.queueLimitExceeded' : 'Queue limit exceeded.',\r\n  'multiimage.fileExceedsSizeLimit' : 'File exceeds size limit.',\r\n  'multiimage.zeroByteFile' : 'Zero byte file.',\r\n  'multiimage.invalidFiletype' : 'Invalid file type.',\r\n  'multiimage.unknownError' : 'Unknown upload error.',\r\n  'multiimage.pending' : 'Pending ...',\r\n  'multiimage.uploadError' : 'Upload error',\r\n  'filemanager.emptyFolder' : 'Blank',\r\n  'filemanager.moveup' : 'Parent folder',\r\n  'filemanager.viewType' : 'Display: ',\r\n  'filemanager.viewImage' : 'Thumbnails',\r\n  'filemanager.listImage' : 'List',\r\n  'filemanager.orderType' : 'Sorting: ',\r\n  'filemanager.fileName' : 'By name',\r\n  'filemanager.fileSize' : 'By size',\r\n  'filemanager.fileType' : 'By type',\r\n  'insertfile.url' : 'URL',\r\n  'insertfile.title' : 'Title',\r\n  'insertfile.upload' : 'Upload',\r\n  'insertfile.viewServer' : 'Browse',\r\n  'table.cells' : 'Cells',\r\n  'table.rows' : 'Rows',\r\n  'table.cols' : 'Columns',\r\n  'table.size' : 'Dimensions',\r\n  'table.width' : 'Width',\r\n  'table.height' : 'Height',\r\n  'table.percent' : '%',\r\n  'table.px' : 'px',\r\n  'table.space' : 'Space',\r\n  'table.padding' : 'Padding',\r\n  'table.spacing' : 'Spacing',\r\n  'table.align' : 'Align',\r\n  'table.textAlign' : 'Horizontal',\r\n  'table.verticalAlign' : 'Vertical',\r\n  'table.alignDefault' : 'Default',\r\n  'table.alignLeft' : 'Left',\r\n  'table.alignCenter' : 'Center',\r\n  'table.alignRight' : 'Right',\r\n  'table.alignTop' : 'Top',\r\n  'table.alignMiddle' : 'Middle',\r\n  'table.alignBottom' : 'Bottom',\r\n  'table.alignBaseline' : 'Baseline',\r\n  'table.border' : 'Border',\r\n  'table.borderWidth' : 'Width',\r\n  'table.borderColor' : 'Color',\r\n  'table.backgroundColor' : 'Background',\r\n  'map.address' : 'Address: ',\r\n  'map.search' : 'Search',\r\n  'baidumap.address' : 'Address: ',\r\n  'baidumap.search' : 'Search',\r\n  'baidumap.insertDynamicMap' : 'Dynamic Map',\r\n  'anchor.name' : 'Anchor name',\r\n  'formatblock.formatBlock' : {\r\n    h1 : 'Heading 1',\r\n    h2 : 'Heading 2',\r\n    h3 : 'Heading 3',\r\n    h4 : 'Heading 4',\r\n    p : 'Normal'\r\n  },\r\n  'fontname.fontName' : {\r\n    'Arial' : 'Arial',\r\n    'Arial Black' : 'Arial Black',\r\n    'Comic Sans MS' : 'Comic Sans MS',\r\n    'Courier New' : 'Courier New',\r\n    'Garamond' : 'Garamond',\r\n    'Georgia' : 'Georgia',\r\n    'Tahoma' : 'Tahoma',\r\n    'Times New Roman' : 'Times New Roman',\r\n    'Trebuchet MS' : 'Trebuchet MS',\r\n    'Verdana' : 'Verdana'\r\n  },\r\n  'lineheight.lineHeight' : [\r\n    {'1' : 'Line height 1'},\r\n    {'1.5' : 'Line height 1.5'},\r\n    {'2' : 'Line height 2'},\r\n    {'2.5' : 'Line height 2.5'},\r\n    {'3' : 'Line height 3'}\r\n  ],\r\n  'template.selectTemplate' : 'Template',\r\n  'template.replaceContent' : 'Replace current content',\r\n  'template.fileList' : {\r\n    '1.html' : 'Image and Text',\r\n    '2.html' : 'Table',\r\n    '3.html' : 'List'\r\n  }\r\n}, 'en');\r\nKindEditor.each(KindEditor.options.items, function(i, name) {\r\n  if (name == 'baidumap') {\r\n    KindEditor.options.items[i] = 'map';\r\n  }\r\n});\r\nKindEditor.options.langType = 'en';\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('anchor', function(K) {\r\n  var self = this, name = 'anchor', lang = self.lang(name + '.');\r\n  self.plugin.anchor = {\r\n    edit : function() {\r\n      var html = ['<div style=\"padding:20px;\">',\r\n          '<div class=\"ke-dialog-row\">',\r\n          '<label for=\"keName\">' + lang.name + '</label>',\r\n          '<input class=\"ke-input-text\" type=\"text\" id=\"keName\" name=\"name\" value=\"\" style=\"width:100px;\" />',\r\n          '</div>',\r\n          '</div>'].join('');\r\n      var dialog = self.createDialog({\r\n        name : name,\r\n        width : 300,\r\n        title : self.lang(name),\r\n        body : html,\r\n        yesBtn : {\r\n          name : self.lang('yes'),\r\n          click : function(e) {\r\n            self.insertHtml('<a name=\"' + nameBox.val() + '\">').hideDialog().focus();\r\n          }\r\n        }\r\n      });\r\n      var div = dialog.div,\r\n        nameBox = K('input[name=\"name\"]', div);\r\n      var img = self.plugin.getSelectedAnchor();\r\n      if (img) {\r\n        nameBox.val(unescape(img.attr('data-ke-name')));\r\n      }\r\n      nameBox[0].focus();\r\n      nameBox[0].select();\r\n    },\r\n    'delete' : function() {\r\n      self.plugin.getSelectedAnchor().remove();\r\n    }\r\n  };\r\n  self.clickToolbar(name, self.plugin.anchor.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('autoheight', function(K) {\r\n  var self = this;\r\n  if (!self.autoHeightMode) {\r\n    return;\r\n  }\r\n  var minHeight;\r\n  function hideScroll() {\r\n    var edit = self.edit;\r\n    var body = edit.doc.body;\r\n    edit.iframe[0].scroll = 'no';\r\n    body.style.overflowY = 'hidden';\r\n  }\r\n  function resetHeight() {\r\n    if(self.fullscreenMode){\r\n      return;\r\n    }\r\n    var edit = self.edit;\r\n    var body = edit.doc.body;\r\n    edit.iframe.height(minHeight);\r\n    self.resize(null, Math.max((K.IE ? body.scrollHeight : body.offsetHeight) + 76, minHeight));\r\n  }\r\n  function init() {\r\n    minHeight = K.removeUnit(self.height);\r\n    self.edit.afterChange(resetHeight);\r\n    if(!self.fullscreenMode){\r\n      hideScroll();\r\n    }\r\n    resetHeight();\r\n  }\r\n  if (self.isCreated) {\r\n    init();\r\n  } else {\r\n    self.afterCreate(init);\r\n  }\r\n});\r\n/*\r\n* \r\n* bodyiframe\r\n* bodyiframebody\r\n* \r\n* chromefirefoxIE9IE8\r\n* */\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\n\r\nKindEditor.plugin('baidumap', function(K) {\r\n  var self = this, name = 'baidumap', lang = self.lang(name + '.');\r\n  var mapWidth = K.undef(self.mapWidth, 558);\r\n  var mapHeight = K.undef(self.mapHeight, 360);\r\n  self.clickToolbar(name, function() {\r\n    var html = ['<div style=\"padding:10px 20px;\">',\r\n      '<div class=\"ke-header\">',\r\n      '<div class=\"ke-left\">',\r\n      lang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n      '<span class=\"ke-button-common ke-button-outer\">',\r\n      '<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n      '</span>',\r\n      '</div>',\r\n      '<div class=\"ke-right\">',\r\n      '<input type=\"checkbox\" id=\"keInsertDynamicMap\" name=\"insertDynamicMap\" value=\"1\" /> <label for=\"keInsertDynamicMap\">' + lang.insertDynamicMap + '</label>',\r\n      '</div>',\r\n      '<div class=\"ke-clearfix\"></div>',\r\n      '</div>',\r\n      '<div class=\"ke-map\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></div>',\r\n      '</div>'].join('');\r\n    var dialog = self.createDialog({\r\n      name : name,\r\n      width : mapWidth + 42,\r\n      title : self.lang(name),\r\n      body : html,\r\n      yesBtn : {\r\n        name : self.lang('yes'),\r\n        click : function(e) {\r\n          var map = win.map;\r\n          var centerObj = map.getCenter();\r\n          var center = centerObj.lng + ',' + centerObj.lat;\r\n          var zoom = map.getZoom();\r\n          var url = [checkbox[0].checked ? self.pluginsPath + 'baidumap/index.html' : 'https://api.map.baidu.com/staticimage',\r\n            '?center=' + encodeURIComponent(center),\r\n            '&zoom=' + encodeURIComponent(zoom),\r\n            '&width=' + mapWidth,\r\n            '&height=' + mapHeight,\r\n            '&markers=' + encodeURIComponent(center),\r\n            '&markerStyles=' + encodeURIComponent('l,A')].join('');\r\n          if (checkbox[0].checked) {\r\n            self.insertHtml('<iframe src=\"' + url + '\" frameborder=\"0\" style=\"width:' + (mapWidth + 2) + 'px;height:' + (mapHeight + 2) + 'px;\"></iframe>');\r\n          } else {\r\n            self.exec('insertimage', url);\r\n          }\r\n          self.hideDialog().focus();\r\n        }\r\n      },\r\n      beforeRemove : function() {\r\n        searchBtn.remove();\r\n        if (doc) {\r\n          doc.write('');\r\n        }\r\n        iframe.remove();\r\n      }\r\n    });\r\n    var div = dialog.div,\r\n      addressBox = K('[name=\"address\"]', div),\r\n      searchBtn = K('[name=\"searchBtn\"]', div),\r\n      checkbox = K('[name=\"insertDynamicMap\"]', dialog.div),\r\n      win, doc;\r\n    var iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'baidumap/map.html\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></iframe>');\r\n    function ready() {\r\n      win = iframe[0].contentWindow;\r\n      doc = K.iframeDoc(iframe);\r\n    }\r\n    iframe.bind('load', function() {\r\n      iframe.unbind('load');\r\n      if (K.IE) {\r\n        ready();\r\n      } else {\r\n        setTimeout(ready, 0);\r\n      }\r\n    });\r\n    K('.ke-map', div).replaceWith(iframe);\r\n    searchBtn.click(function() {\r\n      win.search(addressBox.val());\r\n    });\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\n\r\nKindEditor.plugin('map', function(K) {\r\n  var self = this, name = 'map', lang = self.lang(name + '.');\r\n  self.clickToolbar(name, function() {\r\n    var html = ['<div style=\"padding:10px 20px;\">',\r\n      '<div class=\"ke-dialog-row\">',\r\n      lang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n      '<span class=\"ke-button-common ke-button-outer\">',\r\n      '<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n      '</span>',\r\n      '</div>',\r\n      '<div class=\"ke-map\" style=\"width:558px;height:360px;\"></div>',\r\n      '</div>'].join('');\r\n    var dialog = self.createDialog({\r\n      name : name,\r\n      width : 600,\r\n      title : self.lang(name),\r\n      body : html,\r\n      yesBtn : {\r\n        name : self.lang('yes'),\r\n        click : function(e) {\r\n          var geocoder = win.geocoder,\r\n            map = win.map,\r\n            center = map.getCenter().lat() + ',' + map.getCenter().lng(),\r\n            zoom = map.getZoom(),\r\n            maptype = map.getMapTypeId(),\r\n            url = 'http://maps.googleapis.com/maps/api/staticmap';\r\n            url += '?center=' + encodeURIComponent(center);\r\n            url += '&zoom=' + encodeURIComponent(zoom);\r\n            url += '&size=558x360';\r\n            url += '&maptype=' + encodeURIComponent(maptype);\r\n            url += '&markers=' + encodeURIComponent(center);\r\n            url += '&language=' + self.langType;\r\n            url += '&sensor=false';\r\n          self.exec('insertimage', url).hideDialog().focus();\r\n        }\r\n      },\r\n      beforeRemove : function() {\r\n        searchBtn.remove();\r\n        if (doc) {\r\n          doc.write('');\r\n        }\r\n        iframe.remove();\r\n      }\r\n    });\r\n    var div = dialog.div,\r\n      addressBox = K('[name=\"address\"]', div),\r\n      searchBtn = K('[name=\"searchBtn\"]', div),\r\n      win, doc;\r\n    var iframeHtml = ['<!doctype html><html><head>',\r\n      '<meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />',\r\n      '<style>',\r\n      ' html { height: 100% }',\r\n      ' body { height: 100%; margin: 0; padding: 0; background-color: #FFF }',\r\n      ' #map_canvas { height: 100% }',\r\n      '</style>',\r\n      '<script src=\"http://maps.googleapis.com/maps/api/js?sensor=false&language=' + self.langType + '\"></script>',\r\n      '<script>',\r\n      'var map, geocoder;',\r\n      'function initialize() {',\r\n      ' var latlng = new google.maps.LatLng(31.230393, 121.473704);',\r\n      ' var options = {',\r\n      '   zoom: 11,',\r\n      '   center: latlng,',\r\n      '   disableDefaultUI: true,',\r\n      '   panControl: true,',\r\n      '   zoomControl: true,',\r\n      '   mapTypeControl: true,',\r\n      '   scaleControl: true,',\r\n      '   streetViewControl: false,',\r\n      '   overviewMapControl: true,',\r\n      '   mapTypeId: google.maps.MapTypeId.ROADMAP',\r\n      ' };',\r\n      ' map = new google.maps.Map(document.getElementById(\"map_canvas\"), options);',\r\n      ' geocoder = new google.maps.Geocoder();',\r\n      ' geocoder.geocode({latLng: latlng}, function(results, status) {',\r\n      '   if (status == google.maps.GeocoderStatus.OK) {',\r\n      '     if (results[3]) {',\r\n      '       parent.document.getElementById(\"kindeditor_plugin_map_address\").value = results[3].formatted_address;',\r\n      '     }',\r\n      '   }',\r\n      ' });',\r\n      '}',\r\n      'function search(address) {',\r\n      ' if (!map) return;',\r\n      ' geocoder.geocode({address : address}, function(results, status) {',\r\n      '   if (status == google.maps.GeocoderStatus.OK) {',\r\n      '     map.setZoom(11);',\r\n      '     map.setCenter(results[0].geometry.location);',\r\n      '     var marker = new google.maps.Marker({',\r\n      '       map: map,',\r\n      '       position: results[0].geometry.location',\r\n      '     });',\r\n      '   } else {',\r\n      '     alert(\"Invalid address: \" + address);',\r\n      '   }',\r\n      ' });',\r\n      '}',\r\n      '</script>',\r\n      '</head>',\r\n      '<body onload=\"initialize();\">',\r\n      '<div id=\"map_canvas\" style=\"width:100%; height:100%\"></div>',\r\n      '</body></html>'].join('\\n');\r\n    var iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'map/map.html\" style=\"width:558px;height:360px;\"></iframe>');\r\n    function ready() {\r\n      win = iframe[0].contentWindow;\r\n      doc = K.iframeDoc(iframe);\r\n    }\r\n    iframe.bind('load', function() {\r\n      iframe.unbind('load');\r\n      if (K.IE) {\r\n        ready();\r\n      } else {\r\n        setTimeout(ready, 0);\r\n      }\r\n    });\r\n    K('.ke-map', div).replaceWith(iframe);\r\n    searchBtn.click(function() {\r\n      win.search(addressBox.val());\r\n    });\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('clearhtml', function(K) {\r\n  var self = this, name = 'clearhtml';\r\n  self.clickToolbar(name, function() {\r\n    self.focus();\r\n    var html = self.html();\r\n    html = html.replace(/(<script[^>]*>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n    html = html.replace(/(<style[^>]*>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n    html = K.formatHtml(html, {\r\n      a : ['href', 'target'],\r\n      embed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n      img : ['src', 'width', 'height', 'border', 'alt', 'title', '.width', '.height'],\r\n      table : ['border'],\r\n      'td,th' : ['rowspan', 'colspan'],\r\n      'div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : []\r\n    });\r\n    self.html(html);\r\n    self.cmd.selection(true);\r\n    self.addBookmark();\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\n\r\n\r\nKindEditor.plugin('code', function(K) {\r\n  var self = this, name = 'code';\r\n  self.clickToolbar(name, function() {\r\n    var lang = self.lang(name + '.'),\r\n      html = ['<div style=\"padding:10px 20px;\">',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<select class=\"ke-code-type\">',\r\n        '<option value=\"js\">JavaScript</option>',\r\n        '<option value=\"html\">HTML</option>',\r\n        '<option value=\"css\">CSS</option>',\r\n        '<option value=\"php\">PHP</option>',\r\n        '<option value=\"pl\">Perl</option>',\r\n        '<option value=\"py\">Python</option>',\r\n        '<option value=\"rb\">Ruby</option>',\r\n        '<option value=\"java\">Java</option>',\r\n        '<option value=\"vb\">ASP/VB</option>',\r\n        '<option value=\"cpp\">C/C++</option>',\r\n        '<option value=\"cs\">C#</option>',\r\n        '<option value=\"xml\">XML</option>',\r\n        '<option value=\"bsh\">Shell</option>',\r\n        '<option value=\"\">Other</option>',\r\n        '</select>',\r\n        '</div>',\r\n        '<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>',\r\n        '</div>'].join(''),\r\n      dialog = self.createDialog({\r\n        name : name,\r\n        width : 450,\r\n        title : self.lang(name),\r\n        body : html,\r\n        yesBtn : {\r\n          name : self.lang('yes'),\r\n          click : function(e) {\r\n            var type = K('.ke-code-type', dialog.div).val(),\r\n              code = textarea.val(),\r\n              cls = type === '' ? '' :  ' lang-' + type,\r\n              html = '<pre class=\"prettyprint' + cls + '\">\\n' + K.escape(code) + '</pre> ';\r\n            if (K.trim(code) === '') {\r\n              alert(lang.pleaseInput);\r\n              textarea[0].focus();\r\n              return;\r\n            }\r\n            self.insertHtml(html).hideDialog().focus();\r\n          }\r\n        }\r\n      }),\r\n      textarea = K('textarea', dialog.div);\r\n    textarea[0].focus();\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('emoticons', function(K) {\r\n  var self = this, name = 'emoticons',\r\n    path =  (self.emoticonsPath || self.pluginsPath + 'emoticons/images/'),\r\n    allowPreview = self.allowPreviewEmoticons === undefined ? true : self.allowPreviewEmoticons,\r\n    currentPageNum = 1;\r\n  self.clickToolbar(name, function() {\r\n    var rows = 5, cols = 9, total = 135, startNum = 0,\r\n      cells = rows * cols, pages = Math.ceil(total / cells),\r\n      colsHalf = Math.floor(cols / 2),\r\n      wrapperDiv = K('<div class=\"ke-plugin-emoticons\"></div>'),\r\n      elements = [],\r\n      menu = self.createMenu({\r\n        name : name,\r\n        beforeRemove : function() {\r\n          removeEvent();\r\n        }\r\n      });\r\n    menu.div.append(wrapperDiv);\r\n    var previewDiv, previewImg;\r\n    if (allowPreview) {\r\n      previewDiv = K('<div class=\"ke-preview\"></div>').css('right', 0);\r\n      previewImg = K('<img class=\"ke-preview-img\" src=\"' + path + startNum + '.gif\" />');\r\n      wrapperDiv.append(previewDiv);\r\n      previewDiv.append(previewImg);\r\n    }\r\n    function bindCellEvent(cell, j, num) {\r\n      if (previewDiv) {\r\n        cell.mouseover(function() {\r\n          if (j > colsHalf) {\r\n            previewDiv.css('left', 0);\r\n            previewDiv.css('right', '');\r\n          } else {\r\n            previewDiv.css('left', '');\r\n            previewDiv.css('right', 0);\r\n          }\r\n          previewImg.attr('src', path + num + '.gif');\r\n          K(this).addClass('ke-on');\r\n        });\r\n      } else {\r\n        cell.mouseover(function() {\r\n          K(this).addClass('ke-on');\r\n        });\r\n      }\r\n      cell.mouseout(function() {\r\n        K(this).removeClass('ke-on');\r\n      });\r\n      cell.click(function(e) {\r\n        self.insertHtml('<img src=\"' + path + num + '.gif\" border=\"0\" alt=\"\" />').hideMenu().focus();\r\n        e.stop();\r\n      });\r\n    }\r\n    function createEmoticonsTable(pageNum, parentDiv) {\r\n      var table = document.createElement('table');\r\n      parentDiv.append(table);\r\n      if (previewDiv) {\r\n        K(table).mouseover(function() {\r\n          previewDiv.show('block');\r\n        });\r\n        K(table).mouseout(function() {\r\n          previewDiv.hide();\r\n        });\r\n        elements.push(K(table));\r\n      }\r\n      table.className = 'ke-table';\r\n      table.cellPadding = 0;\r\n      table.cellSpacing = 0;\r\n      table.border = 0;\r\n      var num = (pageNum - 1) * cells + startNum;\r\n      for (var i = 0; i < rows; i++) {\r\n        var row = table.insertRow(i);\r\n        for (var j = 0; j < cols; j++) {\r\n          var cell = K(row.insertCell(j));\r\n          cell.addClass('ke-cell');\r\n          bindCellEvent(cell, j, num);\r\n          var span = K('<span class=\"ke-img\"></span>')\r\n            .css('background-position', '-' + (24 * num) + 'px 0px')\r\n            .css('background-image', 'url(' + path + 'static.gif)');\r\n          cell.append(span);\r\n          elements.push(cell);\r\n          num++;\r\n        }\r\n      }\r\n      return table;\r\n    }\r\n    var table = createEmoticonsTable(currentPageNum, wrapperDiv);\r\n    function removeEvent() {\r\n      K.each(elements, function() {\r\n        this.unbind();\r\n      });\r\n    }\r\n    var pageDiv;\r\n    function bindPageEvent(el, pageNum) {\r\n      el.click(function(e) {\r\n        removeEvent();\r\n        table.parentNode.removeChild(table);\r\n        pageDiv.remove();\r\n        table = createEmoticonsTable(pageNum, wrapperDiv);\r\n        createPageTable(pageNum);\r\n        currentPageNum = pageNum;\r\n        e.stop();\r\n      });\r\n    }\r\n    function createPageTable(currentPageNum) {\r\n      pageDiv = K('<div class=\"ke-page\"></div>');\r\n      wrapperDiv.append(pageDiv);\r\n      for (var pageNum = 1; pageNum <= pages; pageNum++) {\r\n        if (currentPageNum !== pageNum) {\r\n          var a = K('<a href=\"javascript:;\">[' + pageNum + ']</a>');\r\n          bindPageEvent(a, pageNum);\r\n          pageDiv.append(a);\r\n          elements.push(a);\r\n        } else {\r\n          pageDiv.append(K('@[' + pageNum + ']'));\r\n        }\r\n        pageDiv.append(K('@&nbsp;'));\r\n      }\r\n    }\r\n    createPageTable(currentPageNum);\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('filemanager', function(K) {\r\n  var self = this, name = 'filemanager',\r\n    fileManagerJson = K.undef(self.fileManagerJson, self.basePath + 'php/file_manager_json.php'),\r\n    imgPath = self.pluginsPath + name + '/images/',\r\n    lang = self.lang(name + '.');\r\n  function makeFileTitle(filename, filesize, datetime) {\r\n    return filename + ' (' + Math.ceil(filesize / 1024) + 'KB, ' + datetime + ')';\r\n  }\r\n  function bindTitle(el, data) {\r\n    if (data.is_dir) {\r\n      el.attr('title', data.filename);\r\n    } else {\r\n      el.attr('title', makeFileTitle(data.filename, data.filesize, data.datetime));\r\n    }\r\n  }\r\n  self.plugin.filemanagerDialog = function(options) {\r\n    var width = K.undef(options.width, 650),\r\n      height = K.undef(options.height, 510),\r\n      dirName = K.undef(options.dirName, ''),\r\n      viewType = K.undef(options.viewType, 'VIEW').toUpperCase(),\r\n      clickFn = options.clickFn;\r\n    var html = [\r\n      '<div style=\"padding:10px 20px;\">',\r\n      '<div class=\"ke-plugin-filemanager-header\">',\r\n      '<div class=\"ke-left\">',\r\n      '<img class=\"ke-inline-block\" name=\"moveupImg\" src=\"' + imgPath + 'go-up.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"\" /> ',\r\n      '<a class=\"ke-inline-block\" name=\"moveupLink\" href=\"javascript:;\">' + lang.moveup + '</a>',\r\n      '</div>',\r\n      '<div class=\"ke-right\">',\r\n      lang.viewType + ' <select class=\"ke-inline-block\" name=\"viewType\">',\r\n      '<option value=\"VIEW\">' + lang.viewImage + '</option>',\r\n      '<option value=\"LIST\">' + lang.listImage + '</option>',\r\n      '</select> ',\r\n      lang.orderType + ' <select class=\"ke-inline-block\" name=\"orderType\">',\r\n      '<option value=\"NAME\">' + lang.fileName + '</option>',\r\n      '<option value=\"SIZE\">' + lang.fileSize + '</option>',\r\n      '<option value=\"TYPE\">' + lang.fileType + '</option>',\r\n      '</select>',\r\n      '</div>',\r\n      '<div class=\"ke-clearfix\"></div>',\r\n      '</div>',\r\n      '<div class=\"ke-plugin-filemanager-body\"></div>',\r\n      '</div>'\r\n    ].join('');\r\n    var dialog = self.createDialog({\r\n      name : name,\r\n      width : width,\r\n      height : height,\r\n      title : self.lang(name),\r\n      body : html\r\n    }),\r\n    div = dialog.div,\r\n    bodyDiv = K('.ke-plugin-filemanager-body', div),\r\n    moveupImg = K('[name=\"moveupImg\"]', div),\r\n    moveupLink = K('[name=\"moveupLink\"]', div),\r\n    viewServerBtn = K('[name=\"viewServer\"]', div),\r\n    viewTypeBox = K('[name=\"viewType\"]', div),\r\n    orderTypeBox = K('[name=\"orderType\"]', div);\r\n    function reloadPage(path, order, func) {\r\n      var param = 'path=' + path + '&order=' + order + '&dir=' + dirName;\r\n      dialog.showLoading(self.lang('ajaxLoading'));\r\n      K.ajax(K.addParam(fileManagerJson, param + '&' + new Date().getTime()), function(data) {\r\n        dialog.hideLoading();\r\n        func(data);\r\n      });\r\n    }\r\n    var elList = [];\r\n    function bindEvent(el, result, data, createFunc) {\r\n      var fileUrl = K.formatUrl(result.current_url + data.filename, 'absolute'),\r\n        dirPath = encodeURIComponent(result.current_dir_path + data.filename + '/');\r\n      if (data.is_dir) {\r\n        el.click(function(e) {\r\n          reloadPage(dirPath, orderTypeBox.val(), createFunc);\r\n        });\r\n      } else if (data.is_photo) {\r\n        el.click(function(e) {\r\n          clickFn.call(this, fileUrl, data.filename);\r\n        });\r\n      } else {\r\n        el.click(function(e) {\r\n          clickFn.call(this, fileUrl, data.filename);\r\n        });\r\n      }\r\n      elList.push(el);\r\n    }\r\n    function createCommon(result, createFunc) {\r\n      K.each(elList, function() {\r\n        this.unbind();\r\n      });\r\n      moveupLink.unbind();\r\n      viewTypeBox.unbind();\r\n      orderTypeBox.unbind();\r\n      if (result.current_dir_path) {\r\n        moveupLink.click(function(e) {\r\n          reloadPage(result.moveup_dir_path, orderTypeBox.val(), createFunc);\r\n        });\r\n      }\r\n      function changeFunc() {\r\n        if (viewTypeBox.val() == 'VIEW') {\r\n          reloadPage(result.current_dir_path, orderTypeBox.val(), createView);\r\n        } else {\r\n          reloadPage(result.current_dir_path, orderTypeBox.val(), createList);\r\n        }\r\n      }\r\n      viewTypeBox.change(changeFunc);\r\n      orderTypeBox.change(changeFunc);\r\n      bodyDiv.html('');\r\n    }\r\n    function createList(result) {\r\n      createCommon(result, createList);\r\n      var table = document.createElement('table');\r\n      table.className = 'ke-table';\r\n      table.cellPadding = 0;\r\n      table.cellSpacing = 0;\r\n      table.border = 0;\r\n      bodyDiv.append(table);\r\n      var fileList = result.file_list;\r\n      for (var i = 0, len = fileList.length; i < len; i++) {\r\n        var data = fileList[i], row = K(table.insertRow(i));\r\n        row.mouseover(function(e) {\r\n          K(this).addClass('ke-on');\r\n        })\r\n        .mouseout(function(e) {\r\n          K(this).removeClass('ke-on');\r\n        });\r\n        var iconUrl = imgPath + (data.is_dir ? 'folder-16.gif' : 'file-16.gif'),\r\n          img = K('<img src=\"' + iconUrl + '\" width=\"16\" height=\"16\" alt=\"' + data.filename + '\" align=\"absmiddle\" />'),\r\n          cell0 = K(row[0].insertCell(0)).addClass('ke-cell ke-name').append(img).append(document.createTextNode(' ' + data.filename));\r\n        if (!data.is_dir || data.has_file) {\r\n          row.css('cursor', 'pointer');\r\n          cell0.attr('title', data.filename);\r\n          bindEvent(cell0, result, data, createList);\r\n        } else {\r\n          cell0.attr('title', lang.emptyFolder);\r\n        }\r\n        K(row[0].insertCell(1)).addClass('ke-cell ke-size').html(data.is_dir ? '-' : Math.ceil(data.filesize / 1024) + 'KB');\r\n        K(row[0].insertCell(2)).addClass('ke-cell ke-datetime').html(data.datetime);\r\n      }\r\n    }\r\n    function createView(result) {\r\n      createCommon(result, createView);\r\n      var fileList = result.file_list;\r\n      for (var i = 0, len = fileList.length; i < len; i++) {\r\n        var data = fileList[i],\r\n          div = K('<div class=\"ke-inline-block ke-item\"></div>');\r\n        bodyDiv.append(div);\r\n        var photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n          .mouseover(function(e) {\r\n            K(this).addClass('ke-on');\r\n          })\r\n          .mouseout(function(e) {\r\n            K(this).removeClass('ke-on');\r\n          });\r\n        div.append(photoDiv);\r\n        var fileUrl = result.current_url + data.filename,\r\n          iconUrl = data.is_dir ? imgPath + 'folder-64.gif' : (data.is_photo ? fileUrl : imgPath + 'file-64.gif');\r\n        var img = K('<img src=\"' + iconUrl + '\" width=\"80\" height=\"80\" alt=\"' + data.filename + '\" />');\r\n        if (!data.is_dir || data.has_file) {\r\n          photoDiv.css('cursor', 'pointer');\r\n          bindTitle(photoDiv, data);\r\n          bindEvent(photoDiv, result, data, createView);\r\n        } else {\r\n          photoDiv.attr('title', lang.emptyFolder);\r\n        }\r\n        photoDiv.append(img);\r\n        div.append('<div class=\"ke-name\" title=\"' + data.filename + '\">' + data.filename + '</div>');\r\n      }\r\n    }\r\n    viewTypeBox.val(viewType);\r\n    reloadPage('', orderTypeBox.val(), viewType == 'VIEW' ? createView : createList);\r\n    return dialog;\r\n  }\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('flash', function(K) {\r\n  var self = this, name = 'flash', lang = self.lang(name + '.'),\r\n    allowFlashUpload = K.undef(self.allowFlashUpload, true),\r\n    allowFileManager = K.undef(self.allowFileManager, false),\r\n    formatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n    extraParams = K.undef(self.extraFileUploadParams, {}),\r\n    filePostName = K.undef(self.filePostName, 'imgFile'),\r\n    uploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n  self.plugin.flash = {\r\n    edit : function() {\r\n      var html = [\r\n        '<div style=\"padding:20px;\">',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n        '<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n        '<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n        '<span class=\"ke-button-common ke-button-outer\">',\r\n        '<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n        '</span>',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n        '<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" /> ',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n        '<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" /> ',\r\n        '</div>',\r\n        '</div>'\r\n      ].join('');\r\n      var dialog = self.createDialog({\r\n        name : name,\r\n        width : 450,\r\n        title : self.lang(name),\r\n        body : html,\r\n        yesBtn : {\r\n          name : self.lang('yes'),\r\n          click : function(e) {\r\n            var url = K.trim(urlBox.val()),\r\n              width = widthBox.val(),\r\n              height = heightBox.val();\r\n            if (url == 'http://' || K.invalidUrl(url)) {\r\n              alert(self.lang('invalidUrl'));\r\n              urlBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(width)) {\r\n              alert(self.lang('invalidWidth'));\r\n              widthBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(height)) {\r\n              alert(self.lang('invalidHeight'));\r\n              heightBox[0].focus();\r\n              return;\r\n            }\r\n            var html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n                src : url,\r\n                type : K.mediaType('.swf'),\r\n                width : width,\r\n                height : height,\r\n                quality : 'high'\r\n              });\r\n            self.insertHtml(html).hideDialog().focus();\r\n          }\r\n        }\r\n      }),\r\n      div = dialog.div,\r\n      urlBox = K('[name=\"url\"]', div),\r\n      viewServerBtn = K('[name=\"viewServer\"]', div),\r\n      widthBox = K('[name=\"width\"]', div),\r\n      heightBox = K('[name=\"height\"]', div);\r\n      urlBox.val('http://');\r\n      if (allowFlashUpload) {\r\n        var uploadbutton = K.uploadbutton({\r\n          button : K('.ke-upload-button', div)[0],\r\n          fieldName : filePostName,\r\n          extraParams : extraParams,\r\n          url : K.addParam(uploadJson, 'dir=flash'),\r\n          afterUpload : function(data) {\r\n            dialog.hideLoading();\r\n            if (data.error === 0) {\r\n              var url = data.url;\r\n              if (formatUploadUrl) {\r\n                url = K.formatUrl(url, 'absolute');\r\n              }\r\n              urlBox.val(url);\r\n              if (self.afterUpload) {\r\n                self.afterUpload.call(self, url, data, name);\r\n              }\r\n              alert(self.lang('uploadSuccess'));\r\n            } else {\r\n              alert(data.message);\r\n            }\r\n          },\r\n          afterError : function(html) {\r\n            dialog.hideLoading();\r\n            self.errorDialog(html);\r\n          }\r\n        });\r\n        uploadbutton.fileBox.change(function(e) {\r\n          dialog.showLoading(self.lang('uploadLoading'));\r\n          uploadbutton.submit(K.undef(self.customUploadImg, null), 'flash');\r\n        });\r\n      } else {\r\n        K('.ke-upload-button', div).hide();\r\n      }\r\n      if (allowFileManager) {\r\n        viewServerBtn.click(function(e) {\r\n          self.loadPlugin('filemanager', function() {\r\n            self.plugin.filemanagerDialog({\r\n              viewType : 'LIST',\r\n              dirName : 'flash',\r\n              clickFn : function(url, title) {\r\n                if (self.dialogs.length > 1) {\r\n                  K('[name=\"url\"]', div).val(url);\r\n                  if (self.afterSelectFile) {\r\n                    self.afterSelectFile.call(self, url);\r\n                  }\r\n                  self.hideDialog();\r\n                }\r\n              }\r\n            });\r\n          });\r\n        });\r\n      } else {\r\n        viewServerBtn.hide();\r\n      }\r\n      var img = self.plugin.getSelectedFlash();\r\n      if (img) {\r\n        var attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n        urlBox.val(attrs.src);\r\n        widthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n        heightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n      }\r\n      urlBox[0].focus();\r\n      urlBox[0].select();\r\n    },\r\n    'delete' : function() {\r\n      self.plugin.getSelectedFlash().remove();\r\n      self.addBookmark();\r\n    }\r\n  };\r\n  self.clickToolbar(name, self.plugin.flash.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('image', function(K) {\r\n  var self = this, name = 'image',\r\n    allowImageUpload = K.undef(self.allowImageUpload, true),\r\n    allowImageRemote = K.undef(self.allowImageRemote, true),\r\n    formatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n    allowFileManager = K.undef(self.allowFileManager, false),\r\n    uploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n    imageTabIndex = K.undef(self.imageTabIndex, 0),\r\n    imgPath = self.pluginsPath + 'image/images/',\r\n    extraParams = K.undef(self.extraFileUploadParams, {}),\r\n    filePostName = K.undef(self.filePostName, 'imgFile'),\r\n    fillDescAfterUploadImage = K.undef(self.fillDescAfterUploadImage, false),\r\n    lang = self.lang(name + '.');\r\n\r\n  self.plugin.imageDialog = function(options) {\r\n    var imageUrl = options.imageUrl,\r\n      imageWidth = K.undef(options.imageWidth, ''),\r\n      imageHeight = K.undef(options.imageHeight, ''),\r\n      imageTitle = K.undef(options.imageTitle, ''),\r\n      imageAlign = K.undef(options.imageAlign, ''),\r\n      showRemote = K.undef(options.showRemote, true),\r\n      showLocal = K.undef(options.showLocal, true),\r\n      tabIndex = K.undef(options.tabIndex, 0),\r\n      clickFn = options.clickFn;\r\n    var target = 'kindeditor_upload_iframe_' + new Date().getTime();\r\n    var hiddenElements = [];\r\n    for(var k in extraParams){\r\n      hiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n    }\r\n    var html = [\r\n      '<div style=\"padding:20px;\">',\r\n      '<div class=\"tabs\"></div>',\r\n      '<div class=\"tab1\" style=\"display:none;\">',\r\n      '<div class=\"ke-dialog-row\">',\r\n      '<label for=\"remoteUrl\" style=\"width:60px;\">' + lang.remoteUrl + '</label>',\r\n      '<input type=\"text\" id=\"remoteUrl\" class=\"ke-input-text\" name=\"url\" value=\"\" style=\"width:200px;\" /> &nbsp;',\r\n      '<span class=\"ke-button-common ke-button-outer\">',\r\n      '<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n      '</span>',\r\n      '</div>',\r\n      '<div class=\"ke-dialog-row\">',\r\n      '<label for=\"remoteWidth\" style=\"width:60px;\">' + lang.size + '</label>',\r\n      lang.width + ' <input type=\"text\" id=\"remoteWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> ',\r\n      lang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> ',\r\n      '<img class=\"ke-refresh-btn\" src=\"' + imgPath + 'refresh.png\" width=\"16\" height=\"16\" alt=\"\" style=\"cursor:pointer;\" title=\"' + lang.resetSize + '\" />',\r\n      '</div>',\r\n      '<div class=\"ke-dialog-row\">',\r\n      '<label style=\"width:60px;\">' + lang.align + '</label>',\r\n      '<input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"\" checked=\"checked\" /> <img name=\"defaultImg\" src=\"' + imgPath + 'align_top.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n      ' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"left\" /> <img name=\"leftImg\" src=\"' + imgPath + 'align_left.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n      ' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"right\" /> <img name=\"rightImg\" src=\"' + imgPath + 'align_right.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n      '</div>',\r\n      '<div class=\"ke-dialog-row\">',\r\n      '<label for=\"remoteTitle\" style=\"width:60px;\">' + lang.imgTitle + '</label>',\r\n      '<input type=\"text\" id=\"remoteTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:200px;\" />',\r\n      '</div>',\r\n      '</div>',\r\n      '<div class=\"tab2\" style=\"display:none;\">',\r\n      '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>',\r\n      '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + K.addParam(uploadJson, 'dir=image') + '\">',\r\n\r\n      //  2017-11-03\r\n      // '<div class=\"ke-dialog-row\">',\r\n      // hiddenElements.join(''),\r\n      // '<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n      // '<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n      // '<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n      // '</div>',\r\n\r\n      //  2017-11-03\r\n     '<div class=\"ke-dialog-row\">',\r\n      '<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n      '<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n      '<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n      '</div>',\r\n      '<div class=\"ke-dialog-row\"><label style=\"width:60px;\">' + lang.size + '</label>' + lang.width + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"client_width\" value=\"\" maxlength=\"4\" /> ' + lang.height + '</label> <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"client_height\" value=\"\" maxlength=\"4\" />  </div>',\r\n\r\n      '</form>',\r\n      '</div>',\r\n      '</div>'\r\n    ].join('');\r\n    var dialogWidth = showLocal || allowFileManager ? 450 : 400,\r\n      dialogHeight = showLocal && showRemote ? 300 : 250;\r\n    var dialog = self.createDialog({\r\n      name : name,\r\n      width : dialogWidth,\r\n      height : dialogHeight,\r\n      title : self.lang(name),\r\n      body : html,\r\n      yesBtn : {\r\n        name : self.lang('yes'),\r\n        click : function(e) {\r\n          if (dialog.isLoading) {\r\n            return;\r\n          }\r\n          if (showLocal && showRemote && tabs && tabs.selectedIndex === 1 || !showRemote) {\r\n            if (uploadbutton.fileBox.val() == '') {\r\n              alert(self.lang('pleaseSelectFile'));\r\n              return;\r\n            }\r\n            dialog.showLoading(self.lang('uploadLoading'));\r\n            // uploadbutton.submit()\r\n            // 2017-11-06  K.undef(self.customUploadImg, null)\r\n            uploadbutton.submit(K.undef(self.customUploadImg, null), 'image');\r\n            localUrlBox.val('');\r\n            return;\r\n          }\r\n          var url = K.trim(urlBox.val()),\r\n            width = widthBox.val(),\r\n            height = heightBox.val(),\r\n            title = titleBox.val(),\r\n            align = '';\r\n          alignBox.each(function() {\r\n            if (this.checked) {\r\n              align = this.value;\r\n              return false;\r\n            }\r\n          });\r\n          if (url == 'http://' || K.invalidUrl(url)) {\r\n            alert(self.lang('invalidUrl'));\r\n            urlBox[0].focus();\r\n            return;\r\n          }\r\n          if (!/^\\d*$/.test(width)) {\r\n            alert(self.lang('invalidWidth'));\r\n            widthBox[0].focus();\r\n            return;\r\n          }\r\n          if (!/^\\d*$/.test(height)) {\r\n            alert(self.lang('invalidHeight'));\r\n            heightBox[0].focus();\r\n            return;\r\n          }\r\n          clickFn.call(self, url, title, width, height, 0, align);\r\n        }\r\n      },\r\n      beforeRemove : function() {\r\n        viewServerBtn.unbind();\r\n        widthBox.unbind();\r\n        heightBox.unbind();\r\n        refreshBtn.unbind();\r\n      }\r\n    }),\r\n    div = dialog.div;\r\n    var urlBox = K('[name=\"url\"]', div),\r\n      localUrlBox = K('[name=\"localUrl\"]', div),\r\n      viewServerBtn = K('[name=\"viewServer\"]', div),\r\n      widthBox = K('.tab1 [name=\"width\"]', div),\r\n      heightBox = K('.tab1 [name=\"height\"]', div),\r\n      refreshBtn = K('.ke-refresh-btn', div),\r\n      titleBox = K('.tab1 [name=\"title\"]', div),\r\n      alignBox = K('.tab1 [name=\"align\"]', div);\r\n    var tabs;\r\n    if (showRemote && showLocal) {\r\n      tabs = K.tabs({\r\n        src : K('.tabs', div),\r\n        afterSelect : function(i) {}\r\n      });\r\n      tabs.add({\r\n        title : lang.remoteImage,\r\n        panel : K('.tab1', div)\r\n      });\r\n      tabs.add({\r\n        title : lang.localImage,\r\n        panel : K('.tab2', div)\r\n      });\r\n      tabs.select(tabIndex);\r\n    } else if (showRemote) {\r\n      K('.tab1', div).show();\r\n    } else if (showLocal) {\r\n      K('.tab2', div).show();\r\n    }\r\n    var uploadbutton = K.uploadbutton({\r\n      button : K('.ke-upload-button', div)[0],\r\n      fieldName : filePostName,\r\n      form : K('.ke-form', div),\r\n      target : target,\r\n      width: 60,\r\n      afterUpload : function(data) {\r\n        dialog.hideLoading();\r\n        if (data.error === 0) {\r\n          var url = data.url;\r\n          if (formatUploadUrl) {\r\n            url = K.formatUrl(url, 'absolute');\r\n          }\r\n          if (self.afterUpload) {\r\n            self.afterUpload.call(self, url, data, name);\r\n          }\r\n          if (!fillDescAfterUploadImage) {\r\n            clickFn.call(self, url, data.title, data.width, data.height, data.border, data.align);\r\n          } else {\r\n            K(\".ke-dialog-row #remoteUrl\", div).val(url);\r\n            K(\".ke-tabs-li\", div)[0].click();\r\n            K(\".ke-refresh-btn\", div).click();\r\n          }\r\n        } else {\r\n          alert(data.message);\r\n        }\r\n      },\r\n      afterError : function(html) {\r\n        dialog.hideLoading();\r\n        self.errorDialog(html);\r\n      }\r\n    });\r\n    uploadbutton.fileBox.change(function(e) {\r\n      localUrlBox.val(uploadbutton.fileBox.val());\r\n    });\r\n    if (allowFileManager) {\r\n      viewServerBtn.click(function(e) {\r\n        self.loadPlugin('filemanager', function() {\r\n          self.plugin.filemanagerDialog({\r\n            viewType : 'VIEW',\r\n            dirName : 'image',\r\n            clickFn : function(url, title) {\r\n              if (self.dialogs.length > 1) {\r\n                K('[name=\"url\"]', div).val(url);\r\n                if (self.afterSelectFile) {\r\n                  self.afterSelectFile.call(self, url);\r\n                }\r\n                self.hideDialog();\r\n              }\r\n            }\r\n          });\r\n        });\r\n      });\r\n    } else {\r\n      viewServerBtn.hide();\r\n    }\r\n    var originalWidth = 0, originalHeight = 0;\r\n    function setSize(width, height) {\r\n      widthBox.val(width);\r\n      heightBox.val(height);\r\n      originalWidth = width;\r\n      originalHeight = height;\r\n    }\r\n    refreshBtn.click(function(e) {\r\n      var tempImg = K('<img src=\"' + urlBox.val() + '\" />', document).css({\r\n        position : 'absolute',\r\n        visibility : 'hidden',\r\n        top : 0,\r\n        left : '-1000px'\r\n      });\r\n      tempImg.bind('load', function() {\r\n        setSize(tempImg.width(), tempImg.height());\r\n        tempImg.remove();\r\n      });\r\n      K(document.body).append(tempImg);\r\n    });\r\n    widthBox.change(function(e) {\r\n      if (originalWidth > 0) {\r\n        heightBox.val(Math.round(originalHeight / originalWidth * parseInt(this.value, 10)));\r\n      }\r\n    });\r\n    heightBox.change(function(e) {\r\n      if (originalHeight > 0) {\r\n        widthBox.val(Math.round(originalWidth / originalHeight * parseInt(this.value, 10)));\r\n      }\r\n    });\r\n    urlBox.val(options.imageUrl);\r\n    setSize(options.imageWidth, options.imageHeight);\r\n    titleBox.val(options.imageTitle);\r\n    alignBox.each(function() {\r\n      if (this.value === options.imageAlign) {\r\n        this.checked = true;\r\n        return false;\r\n      }\r\n    });\r\n    if (showRemote && tabIndex === 0) {\r\n      urlBox[0].focus();\r\n      urlBox[0].select();\r\n    }\r\n    return dialog;\r\n  };\r\n  self.plugin.image = {\r\n    edit : function() {\r\n      var img = self.plugin.getSelectedImage();\r\n      self.plugin.imageDialog({\r\n        imageUrl : img ? img.attr('data-ke-src') : 'http://',\r\n        imageWidth : img ? img.width() : '',\r\n        imageHeight : img ? img.height() : '',\r\n        imageTitle : img ? img.attr('title') : '',\r\n        imageAlign : img ? img.attr('align') : '',\r\n        showRemote : allowImageRemote,\r\n        showLocal : allowImageUpload,\r\n        tabIndex: img ? 0 : imageTabIndex,\r\n        clickFn : function(url, title, width, height, border, align) {\r\n          if (img) {\r\n            img.attr('src', url);\r\n            img.attr('data-ke-src', url);\r\n            img.attr('width', width);\r\n            img.attr('height', height);\r\n            img.attr('title', title);\r\n            img.attr('align', align);\r\n            img.attr('alt', title);\r\n          } else {\r\n            self.exec('insertimage', url, title, width, height, border, align);\r\n          }\r\n          setTimeout(function() {\r\n            self.hideDialog().focus();\r\n          }, 0);\r\n        }\r\n      });\r\n    },\r\n    'delete' : function() {\r\n      var target = self.plugin.getSelectedImage();\r\n      if (target.parent().name == 'a') {\r\n        target = target.parent();\r\n      }\r\n      target.remove();\r\n      self.addBookmark();\r\n    }\r\n  };\r\n  self.clickToolbar(name, self.plugin.image.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('insertfile', function(K) {\r\n  var self = this, name = 'insertfile',\r\n    allowFileUpload = K.undef(self.allowFileUpload, true),\r\n    allowFileManager = K.undef(self.allowFileManager, false),\r\n    formatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n    uploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n    extraParams = K.undef(self.extraFileUploadParams, {}),\r\n    filePostName = K.undef(self.filePostName, 'imgFile'),\r\n    lang = self.lang(name + '.');\r\n  self.plugin.fileDialog = function(options) {\r\n    var fileUrl = K.undef(options.fileUrl, 'http://'),\r\n      fileTitle = K.undef(options.fileTitle, ''),\r\n      clickFn = options.clickFn;\r\n    var html = [\r\n      '<div style=\"padding:20px;\">',\r\n      '<div class=\"ke-dialog-row\">',\r\n      '<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n      '<input type=\"text\" id=\"keUrl\" name=\"url\" class=\"ke-input-text\" style=\"width:160px;\" /> &nbsp;',\r\n      '<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n      '<span class=\"ke-button-common ke-button-outer\">',\r\n      '<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n      '</span>',\r\n      '</div>',\r\n      '<div class=\"ke-dialog-row\">',\r\n      '<label for=\"keTitle\" style=\"width:60px;\">' + lang.title + '</label>',\r\n      '<input type=\"text\" id=\"keTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:160px;\" /></div>',\r\n      '</div>',\r\n      '</form>',\r\n      '</div>'\r\n      ].join('');\r\n    var dialog = self.createDialog({\r\n      name : name,\r\n      width : 450,\r\n      title : self.lang(name),\r\n      body : html,\r\n      yesBtn : {\r\n        name : self.lang('yes'),\r\n        click : function(e) {\r\n          var url = K.trim(urlBox.val()),\r\n            title = titleBox.val();\r\n          if (url == 'http://' || K.invalidUrl(url)) {\r\n            alert(self.lang('invalidUrl'));\r\n            urlBox[0].focus();\r\n            return;\r\n          }\r\n          if (K.trim(title) === '') {\r\n            title = url;\r\n          }\r\n          clickFn.call(self, url, title);\r\n        }\r\n      }\r\n    }),\r\n    div = dialog.div;\r\n    var urlBox = K('[name=\"url\"]', div),\r\n      viewServerBtn = K('[name=\"viewServer\"]', div),\r\n      titleBox = K('[name=\"title\"]', div);\r\n    if (allowFileUpload) {\r\n      var uploadbutton = K.uploadbutton({\r\n        button : K('.ke-upload-button', div)[0],\r\n        fieldName : filePostName,\r\n        url : K.addParam(uploadJson, 'dir=file'),\r\n        extraParams : extraParams,\r\n        afterUpload : function(data) {\r\n          dialog.hideLoading();\r\n          if (data.error === 0) {\r\n            var url = data.url;\r\n            if (formatUploadUrl) {\r\n              url = K.formatUrl(url, 'absolute');\r\n            }\r\n            urlBox.val(url);\r\n            if (self.afterUpload) {\r\n              self.afterUpload.call(self, url, data, name);\r\n            }\r\n            alert(self.lang('uploadSuccess'));\r\n          } else {\r\n            alert(data.message);\r\n          }\r\n        },\r\n        afterError : function(html) {\r\n          dialog.hideLoading();\r\n          self.errorDialog(html);\r\n        }\r\n      });\r\n      uploadbutton.fileBox.change(function(e) {\r\n        dialog.showLoading(self.lang('uploadLoading'));\r\n        uploadbutton.submit(K.undef(self.customUploadImg, null), 'file');\r\n      });\r\n    } else {\r\n      K('.ke-upload-button', div).hide();\r\n    }\r\n    if (allowFileManager) {\r\n      viewServerBtn.click(function(e) {\r\n        self.loadPlugin('filemanager', function() {\r\n          self.plugin.filemanagerDialog({\r\n            viewType : 'LIST',\r\n            dirName : 'file',\r\n            clickFn : function(url, title) {\r\n              if (self.dialogs.length > 1) {\r\n                K('[name=\"url\"]', div).val(url);\r\n                if (self.afterSelectFile) {\r\n                  self.afterSelectFile.call(self, url);\r\n                }\r\n                self.hideDialog();\r\n              }\r\n            }\r\n          });\r\n        });\r\n      });\r\n    } else {\r\n      viewServerBtn.hide();\r\n    }\r\n    urlBox.val(fileUrl);\r\n    titleBox.val(fileTitle);\r\n    urlBox[0].focus();\r\n    urlBox[0].select();\r\n  };\r\n  self.clickToolbar(name, function() {\r\n    self.plugin.fileDialog({\r\n      clickFn : function(url, title) {\r\n        var html = '<a class=\"ke-insertfile\" href=\"' + url + '\" data-ke-src=\"' + url + '\" target=\"_blank\">' + title + '</a>';\r\n        self.insertHtml(html).hideDialog().focus();\r\n      }\r\n    });\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('lineheight', function(K) {\r\n  var self = this, name = 'lineheight', lang = self.lang(name + '.');\r\n  self.clickToolbar(name, function() {\r\n    var curVal = '', commonNode = self.cmd.commonNode({'*' : '.line-height'});\r\n    if (commonNode) {\r\n      curVal = commonNode.css('line-height');\r\n    }\r\n    var menu = self.createMenu({\r\n      name : name,\r\n      width : 150\r\n    });\r\n    K.each(lang.lineHeight, function(i, row) {\r\n      K.each(row, function(key, val) {\r\n        menu.addItem({\r\n          title : val,\r\n          checked : curVal === key,\r\n          click : function() {\r\n            self.cmd.toggle('<span style=\"line-height:' + key + ';\"></span>', {\r\n              span : '.line-height=' + key\r\n            });\r\n            self.updateState();\r\n            self.addBookmark();\r\n            self.hideMenu();\r\n          }\r\n        });\r\n      });\r\n    });\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('link', function(K) {\r\n  var self = this, name = 'link';\r\n  self.plugin.link = {\r\n    edit : function() {\r\n      var lang = self.lang(name + '.'),\r\n        html = '<div style=\"padding:20px;\">' +\r\n          '<div class=\"ke-dialog-row\">' +\r\n          '<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>' +\r\n          '<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:260px;\" /></div>' +\r\n          '<div class=\"ke-dialog-row\"\">' +\r\n          '<label for=\"keType\" style=\"width:60px;\">' + lang.linkType + '</label>' +\r\n          '<select id=\"keType\" name=\"type\"></select>' +\r\n          '</div>' +\r\n          '</div>',\r\n        dialog = self.createDialog({\r\n          name : name,\r\n          width : 450,\r\n          title : self.lang(name),\r\n          body : html,\r\n          yesBtn : {\r\n            name : self.lang('yes'),\r\n            click : function(e) {\r\n              var url = K.trim(urlBox.val());\r\n              if (url == 'http://' || K.invalidUrl(url)) {\r\n                alert(self.lang('invalidUrl'));\r\n                urlBox[0].focus();\r\n                return;\r\n              }\r\n              self.exec('createlink', url, typeBox.val()).hideDialog().focus();\r\n            }\r\n          }\r\n        }),\r\n        div = dialog.div,\r\n        urlBox = K('input[name=\"url\"]', div),\r\n        typeBox = K('select[name=\"type\"]', div);\r\n      urlBox.val('http://');\r\n      typeBox[0].options[0] = new Option(lang.newWindow, '_blank');\r\n      typeBox[0].options[1] = new Option(lang.selfWindow, '');\r\n      self.cmd.selection();\r\n      var a = self.plugin.getSelectedLink();\r\n      if (a) {\r\n        self.cmd.range.selectNode(a[0]);\r\n        self.cmd.select();\r\n        urlBox.val(a.attr('data-ke-src'));\r\n        typeBox.val(a.attr('target'));\r\n      }\r\n      urlBox[0].focus();\r\n      urlBox[0].select();\r\n    },\r\n    'delete' : function() {\r\n      self.exec('unlink', null);\r\n    }\r\n  };\r\n  self.clickToolbar(name, self.plugin.link.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('media', function(K) {\r\n  var self = this, name = 'media', lang = self.lang(name + '.'),\r\n    allowMediaUpload = K.undef(self.allowMediaUpload, true),\r\n    allowFileManager = K.undef(self.allowFileManager, false),\r\n    formatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n    extraParams = K.undef(self.extraFileUploadParams, {}),\r\n    filePostName = K.undef(self.filePostName, 'imgFile'),\r\n    uploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n  self.plugin.media = {\r\n    edit : function() {\r\n      var html = [\r\n        '<div style=\"padding:20px;\">',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n        '<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n        '<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n        '<span class=\"ke-button-common ke-button-outer\">',\r\n        '<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n        '</span>',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n        '<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" />',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n        '<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" />',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keAutostart\">' + lang.autostart + '</label>',\r\n        '<input type=\"checkbox\" id=\"keAutostart\" name=\"autostart\" value=\"\" /> ',\r\n        '</div>',\r\n        '</div>'\r\n      ].join('');\r\n      var dialog = self.createDialog({\r\n        name : name,\r\n        width : 450,\r\n        height : 230,\r\n        title : self.lang(name),\r\n        body : html,\r\n        yesBtn : {\r\n          name : self.lang('yes'),\r\n          click : function(e) {\r\n            var url = K.trim(urlBox.val()),\r\n              width = widthBox.val(),\r\n              height = heightBox.val();\r\n            if (url == 'http://' || K.invalidUrl(url)) {\r\n              alert(self.lang('invalidUrl'));\r\n              urlBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(width)) {\r\n              alert(self.lang('invalidWidth'));\r\n              widthBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(height)) {\r\n              alert(self.lang('invalidHeight'));\r\n              heightBox[0].focus();\r\n              return;\r\n            }\r\n            var html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n                src : url,\r\n                type : K.mediaType(url),\r\n                width : width,\r\n                height : height,\r\n                autostart : autostartBox[0].checked ? 'true' : 'false',\r\n                loop : 'true'\r\n              });\r\n            self.insertHtml(html).hideDialog().focus();\r\n          }\r\n        }\r\n      }),\r\n      div = dialog.div,\r\n      urlBox = K('[name=\"url\"]', div),\r\n      viewServerBtn = K('[name=\"viewServer\"]', div),\r\n      widthBox = K('[name=\"width\"]', div),\r\n      heightBox = K('[name=\"height\"]', div),\r\n      autostartBox = K('[name=\"autostart\"]', div);\r\n      urlBox.val('http://');\r\n      if (allowMediaUpload) {\r\n        var uploadbutton = K.uploadbutton({\r\n          button : K('.ke-upload-button', div)[0],\r\n          fieldName : filePostName,\r\n          extraParams : extraParams,\r\n          url : K.addParam(uploadJson, 'dir=media'),\r\n          afterUpload : function(data) {\r\n            dialog.hideLoading();\r\n            if (data.error === 0) {\r\n              var url = data.url;\r\n              if (formatUploadUrl) {\r\n                url = K.formatUrl(url, 'absolute');\r\n              }\r\n              urlBox.val(url);\r\n              if (self.afterUpload) {\r\n                self.afterUpload.call(self, url, data, name);\r\n              }\r\n              alert(self.lang('uploadSuccess'));\r\n            } else {\r\n              alert(data.message);\r\n            }\r\n          },\r\n          afterError : function(html) {\r\n            dialog.hideLoading();\r\n            self.errorDialog(html);\r\n          }\r\n        });\r\n        uploadbutton.fileBox.change(function(e) {\r\n          dialog.showLoading(self.lang('uploadLoading'));\r\n          uploadbutton.submit(K.undef(self.customUploadImg, null), 'media');\r\n        });\r\n      } else {\r\n        K('.ke-upload-button', div).hide();\r\n      }\r\n      if (allowFileManager) {\r\n        viewServerBtn.click(function(e) {\r\n          self.loadPlugin('filemanager', function() {\r\n            self.plugin.filemanagerDialog({\r\n              viewType : 'LIST',\r\n              dirName : 'media',\r\n              clickFn : function(url, title) {\r\n                if (self.dialogs.length > 1) {\r\n                  K('[name=\"url\"]', div).val(url);\r\n                  if (self.afterSelectFile) {\r\n                    self.afterSelectFile.call(self, url);\r\n                  }\r\n                  self.hideDialog();\r\n                }\r\n              }\r\n            });\r\n          });\r\n        });\r\n      } else {\r\n        viewServerBtn.hide();\r\n      }\r\n      var img = self.plugin.getSelectedMedia();\r\n      if (img) {\r\n        var attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n        urlBox.val(attrs.src);\r\n        widthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n        heightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n        autostartBox[0].checked = (attrs.autostart === 'true');\r\n      }\r\n      urlBox[0].focus();\r\n      urlBox[0].select();\r\n    },\r\n    'delete' : function() {\r\n      self.plugin.getSelectedMedia().remove();\r\n      self.addBookmark();\r\n    }\r\n  };\r\n  self.clickToolbar(name, self.plugin.media.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n(function(K) {\r\nfunction KSWFUpload(options) {\r\n  this.init(options);\r\n}\r\nK.extend(KSWFUpload, {\r\n  init : function(options) {\r\n    var self = this;\r\n    options.afterError = options.afterError || function(str) {\r\n      alert(str);\r\n    };\r\n    self.options = options;\r\n    self.progressbars = {};\r\n    self.div = K(options.container).html([\r\n      '<div class=\"ke-swfupload\">',\r\n      '<div class=\"ke-swfupload-top\">',\r\n      '<div class=\"ke-inline-block ke-swfupload-button\">',\r\n      '<input type=\"button\" value=\"Browse\" />',\r\n      '</div>',\r\n      '<div class=\"ke-inline-block ke-swfupload-desc\">' + options.uploadDesc + '</div>',\r\n      '<span class=\"ke-button-common ke-button-outer ke-swfupload-startupload\">',\r\n      '<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + options.startButtonValue + '\" />',\r\n      '</span>',\r\n      '</div>',\r\n      '<div class=\"ke-swfupload-body\"></div>',\r\n      '</div>'\r\n    ].join(''));\r\n    self.bodyDiv = K('.ke-swfupload-body', self.div);\r\n    function showError(itemDiv, msg) {\r\n      K('.ke-status > div', itemDiv).hide();\r\n      K('.ke-message', itemDiv).addClass('ke-error').show().html(K.escape(msg));\r\n    }\r\n    var settings = {\r\n      debug : false,\r\n      upload_url : options.uploadUrl,\r\n      flash_url : options.flashUrl,\r\n      file_post_name : options.filePostName,\r\n      button_placeholder : K('.ke-swfupload-button > input', self.div)[0],\r\n      button_image_url: options.buttonImageUrl,\r\n      button_width: options.buttonWidth,\r\n      button_height: options.buttonHeight,\r\n      button_cursor : SWFUpload.CURSOR.HAND,\r\n      file_types : options.fileTypes,\r\n      file_types_description : options.fileTypesDesc,\r\n      file_upload_limit : options.fileUploadLimit,\r\n      file_size_limit : options.fileSizeLimit,\r\n      post_params : options.postParams,\r\n      file_queued_handler : function(file) {\r\n        file.url = self.options.fileIconUrl;\r\n        self.appendFile(file);\r\n      },\r\n      file_queue_error_handler : function(file, errorCode, message) {\r\n        var errorName = '';\r\n        switch (errorCode) {\r\n          case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:\r\n            errorName = options.queueLimitExceeded;\r\n            break;\r\n          case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:\r\n            errorName = options.fileExceedsSizeLimit;\r\n            break;\r\n          case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:\r\n            errorName = options.zeroByteFile;\r\n            break;\r\n          case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:\r\n            errorName = options.invalidFiletype;\r\n            break;\r\n          default:\r\n            errorName = options.unknownError;\r\n            break;\r\n        }\r\n        K.DEBUG && alert(errorName);\r\n      },\r\n      upload_start_handler : function(file) {\r\n        var self = this;\r\n        var itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv);\r\n        K('.ke-status > div', itemDiv).hide();\r\n        K('.ke-progressbar', itemDiv).show();\r\n      },\r\n      upload_progress_handler : function(file, bytesLoaded, bytesTotal) {\r\n        var percent = Math.round(bytesLoaded * 100 / bytesTotal);\r\n        var progressbar = self.progressbars[file.id];\r\n        progressbar.bar.css('width', Math.round(percent * 80 / 100) + 'px');\r\n        progressbar.percent.html(percent + '%');\r\n      },\r\n      upload_error_handler : function(file, errorCode, message) {\r\n        if (file && file.filestatus == SWFUpload.FILE_STATUS.ERROR) {\r\n          var itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n          showError(itemDiv, self.options.errorMessage);\r\n        }\r\n      },\r\n      upload_success_handler : function(file, serverData) {\r\n        var itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n        var data = {};\r\n        try {\r\n          data = K.json(serverData);\r\n        } catch (e) {\r\n          self.options.afterError.call(this, '<!doctype html><html>' + serverData + '</html>');\r\n        }\r\n        if (data.error !== 0) {\r\n          showError(itemDiv, K.DEBUG ? data.message : self.options.errorMessage);\r\n          return;\r\n        }\r\n        file.url = data.url;\r\n        K('.ke-img', itemDiv).attr('src', file.url).attr('data-status', file.filestatus).data('data', data);\r\n        K('.ke-status > div', itemDiv).hide();\r\n      }\r\n    };\r\n    self.swfu = new SWFUpload(settings);\r\n    K('.ke-swfupload-startupload input', self.div).click(function() {\r\n      self.swfu.startUpload();\r\n    });\r\n  },\r\n  getUrlList : function() {\r\n    var list = [];\r\n    K('.ke-img', self.bodyDiv).each(function() {\r\n      var img = K(this);\r\n      var status = img.attr('data-status');\r\n      if (status == SWFUpload.FILE_STATUS.COMPLETE) {\r\n        list.push(img.data('data'));\r\n      }\r\n    });\r\n    return list;\r\n  },\r\n  removeFile : function(fileId) {\r\n    var self = this;\r\n    self.swfu.cancelUpload(fileId);\r\n    var itemDiv = K('div[data-id=\"' + fileId + '\"]', self.bodyDiv);\r\n    K('.ke-photo', itemDiv).unbind();\r\n    K('.ke-delete', itemDiv).unbind();\r\n    itemDiv.remove();\r\n  },\r\n  removeFiles : function() {\r\n    var self = this;\r\n    K('.ke-item', self.bodyDiv).each(function() {\r\n      self.removeFile(K(this).attr('data-id'));\r\n    });\r\n  },\r\n  appendFile : function(file) {\r\n    var self = this;\r\n    var itemDiv = K('<div class=\"ke-inline-block ke-item\" data-id=\"' + file.id + '\"></div>');\r\n    self.bodyDiv.append(itemDiv);\r\n    var photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n      .mouseover(function(e) {\r\n        K(this).addClass('ke-on');\r\n      })\r\n      .mouseout(function(e) {\r\n        K(this).removeClass('ke-on');\r\n      });\r\n    itemDiv.append(photoDiv);\r\n    var img = K('<img src=\"' + file.url + '\" class=\"ke-img\" data-status=\"' + file.filestatus + '\" width=\"80\" height=\"80\" alt=\"' + file.name + '\" />');\r\n    photoDiv.append(img);\r\n    K('<span class=\"ke-delete\"></span>').appendTo(photoDiv).click(function() {\r\n      self.removeFile(file.id);\r\n    });\r\n    var statusDiv = K('<div class=\"ke-status\"></div>').appendTo(photoDiv);\r\n    K(['<div class=\"ke-progressbar\">',\r\n      '<div class=\"ke-progressbar-bar\"><div class=\"ke-progressbar-bar-inner\"></div></div>',\r\n      '<div class=\"ke-progressbar-percent\">0%</div></div>'].join('')).hide().appendTo(statusDiv);\r\n    K('<div class=\"ke-message\">' + self.options.pendingMessage + '</div>').appendTo(statusDiv);\r\n    itemDiv.append('<div class=\"ke-name\">' + file.name + '</div>');\r\n    self.progressbars[file.id] = {\r\n      bar : K('.ke-progressbar-bar-inner', photoDiv),\r\n      percent : K('.ke-progressbar-percent', photoDiv)\r\n    };\r\n  },\r\n  remove : function() {\r\n    this.removeFiles();\r\n    this.swfu.destroy();\r\n    this.div.html('');\r\n  }\r\n});\r\nK.swfupload = function(element, options) {\r\n  return new KSWFUpload(element, options);\r\n};\r\n})(KindEditor);\r\nKindEditor.plugin('multiimage', function(K) {\r\n  var self = this, name = 'multiimage',\r\n    formatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n    uploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n    imgPath = self.pluginsPath + 'multiimage/images/',\r\n    imageSizeLimit = K.undef(self.imageSizeLimit, '1MB'),\r\n    imageFileTypes = K.undef(self.imageFileTypes, '*.jpg;*.gif;*.png'),\r\n    imageUploadLimit = K.undef(self.imageUploadLimit, 20),\r\n    filePostName = K.undef(self.filePostName, 'imgFile'),\r\n    lang = self.lang(name + '.');\r\n  self.plugin.multiImageDialog = function(options) {\r\n    var clickFn = options.clickFn,\r\n      uploadDesc = K.tmpl(lang.uploadDesc, {uploadLimit : imageUploadLimit, sizeLimit : imageSizeLimit});\r\n    var html = [\r\n      '<div style=\"padding:20px;\">',\r\n      '<div class=\"swfupload\">',\r\n      '</div>',\r\n      '</div>'\r\n    ].join('');\r\n    var dialog = self.createDialog({\r\n      name : name,\r\n      width : 650,\r\n      height : 510,\r\n      title : self.lang(name),\r\n      body : html,\r\n      previewBtn : {\r\n        name : lang.insertAll,\r\n        click : function(e) {\r\n          clickFn.call(self, swfupload.getUrlList());\r\n        }\r\n      },\r\n      yesBtn : {\r\n        name : lang.clearAll,\r\n        click : function(e) {\r\n          swfupload.removeFiles();\r\n        }\r\n      },\r\n      beforeRemove : function() {\r\n        if (!K.IE || K.V <= 8) {\r\n          swfupload.remove();\r\n        }\r\n      }\r\n    }),\r\n    div = dialog.div;\r\n    var swfupload = K.swfupload({\r\n      container : K('.swfupload', div),\r\n      buttonImageUrl : imgPath + (self.langType == 'zh-CN' ? 'select-files-zh-CN.png' : 'select-files-en.png'),\r\n      buttonWidth : self.langType == 'zh-CN' ? 72 : 88,\r\n      buttonHeight : 23,\r\n      fileIconUrl : imgPath + 'image.png',\r\n      uploadDesc : uploadDesc,\r\n      startButtonValue : lang.startUpload,\r\n      uploadUrl : K.addParam(uploadJson, 'dir=image'),\r\n      flashUrl : imgPath + 'swfupload.swf',\r\n      filePostName : filePostName,\r\n      fileTypes : '*.jpg;*.jpeg;*.gif;*.png;*.bmp',\r\n      fileTypesDesc : 'Image Files',\r\n      fileUploadLimit : imageUploadLimit,\r\n      fileSizeLimit : imageSizeLimit,\r\n      postParams :  K.undef(self.extraFileUploadParams, {}),\r\n      queueLimitExceeded : lang.queueLimitExceeded,\r\n      fileExceedsSizeLimit : lang.fileExceedsSizeLimit,\r\n      zeroByteFile : lang.zeroByteFile,\r\n      invalidFiletype : lang.invalidFiletype,\r\n      unknownError : lang.unknownError,\r\n      pendingMessage : lang.pending,\r\n      errorMessage : lang.uploadError,\r\n      afterError : function(html) {\r\n        self.errorDialog(html);\r\n      }\r\n    });\r\n    return dialog;\r\n  };\r\n  self.clickToolbar(name, function() {\r\n    self.plugin.multiImageDialog({\r\n      clickFn : function (urlList) {\r\n        if (urlList.length === 0) {\r\n          return;\r\n        }\r\n        K.each(urlList, function(i, data) {\r\n          if (self.afterUpload) {\r\n            self.afterUpload.call(self, data.url, data, 'multiimage');\r\n          }\r\n          self.exec('insertimage', data.url, data.title, data.width, data.height, data.border, data.align);\r\n        });\r\n        setTimeout(function() {\r\n          self.hideDialog().focus();\r\n        }, 0);\r\n      }\r\n    });\r\n  });\r\n});\r\n/* ******************* */\r\n/* Constructor & Init  */\r\n/* ******************* */\r\n(function() {\r\nwindow.SWFUpload = function (settings) {\r\n  this.initSWFUpload(settings);\r\n};\r\nSWFUpload.prototype.initSWFUpload = function (settings) {\r\n  try {\r\n    this.customSettings = {};\r\n    this.settings = settings;\r\n    this.eventQueue = [];\r\n    this.movieName = \"KindEditor_SWFUpload_\" + SWFUpload.movieCount++;\r\n    this.movieElement = null;\r\n    SWFUpload.instances[this.movieName] = this;\r\n    this.initSettings();\r\n    this.loadFlash();\r\n    this.displayDebugInfo();\r\n  } catch (ex) {\r\n    delete SWFUpload.instances[this.movieName];\r\n    throw ex;\r\n  }\r\n};\r\n/* *************** */\r\n/* Static Members  */\r\n/* *************** */\r\nSWFUpload.instances = {};\r\nSWFUpload.movieCount = 0;\r\nSWFUpload.version = \"2.2.0 2009-03-25\";\r\nSWFUpload.QUEUE_ERROR = {\r\n  QUEUE_LIMIT_EXCEEDED        : -100,\r\n  FILE_EXCEEDS_SIZE_LIMIT     : -110,\r\n  ZERO_BYTE_FILE            : -120,\r\n  INVALID_FILETYPE          : -130\r\n};\r\nSWFUpload.UPLOAD_ERROR = {\r\n  HTTP_ERROR              : -200,\r\n  MISSING_UPLOAD_URL            : -210,\r\n  IO_ERROR              : -220,\r\n  SECURITY_ERROR            : -230,\r\n  UPLOAD_LIMIT_EXCEEDED       : -240,\r\n  UPLOAD_FAILED           : -250,\r\n  SPECIFIED_FILE_ID_NOT_FOUND   : -260,\r\n  FILE_VALIDATION_FAILED        : -270,\r\n  FILE_CANCELLED            : -280,\r\n  UPLOAD_STOPPED          : -290\r\n};\r\nSWFUpload.FILE_STATUS = {\r\n  QUEUED     : -1,\r\n  IN_PROGRESS  : -2,\r\n  ERROR    : -3,\r\n  COMPLETE   : -4,\r\n  CANCELLED  : -5\r\n};\r\nSWFUpload.BUTTON_ACTION = {\r\n  SELECT_FILE  : -100,\r\n  SELECT_FILES : -110,\r\n  START_UPLOAD : -120\r\n};\r\nSWFUpload.CURSOR = {\r\n  ARROW : -1,\r\n  HAND : -2\r\n};\r\nSWFUpload.WINDOW_MODE = {\r\n  WINDOW : \"window\",\r\n  TRANSPARENT : \"transparent\",\r\n  OPAQUE : \"opaque\"\r\n};\r\n\r\n\r\n\r\nSWFUpload.completeURL = function(url) {\r\n  if (typeof(url) !== \"string\" || url.match(/^https?:\\/\\//i) || url.match(/^\\//)) {\r\n    return url;\r\n  }\r\n  var currentURL = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? \":\" + window.location.port : \"\");\r\n  var indexSlash = window.location.pathname.lastIndexOf(\"/\");\r\n  var path;\r\n  if (indexSlash <= 0) {\r\n    path = \"/\";\r\n  } else {\r\n    path = window.location.pathname.substr(0, indexSlash) + \"/\";\r\n  }\r\n  return /*currentURL +*/ path + url;\r\n};\r\n/* ******************** */\r\n/* Instance Members  */\r\n/* ******************** */\r\n\r\n\r\n\r\nSWFUpload.prototype.initSettings = function () {\r\n  this.ensureDefault = function (settingName, defaultValue) {\r\n    this.settings[settingName] = (this.settings[settingName] == undefined) ? defaultValue : this.settings[settingName];\r\n  };\r\n  this.ensureDefault(\"upload_url\", \"\");\r\n  this.ensureDefault(\"preserve_relative_urls\", false);\r\n  this.ensureDefault(\"file_post_name\", \"Filedata\");\r\n  this.ensureDefault(\"post_params\", {});\r\n  this.ensureDefault(\"use_query_string\", false);\r\n  this.ensureDefault(\"requeue_on_error\", false);\r\n  this.ensureDefault(\"http_success\", []);\r\n  this.ensureDefault(\"assume_success_timeout\", 0);\r\n  this.ensureDefault(\"file_types\", \"*.*\");\r\n  this.ensureDefault(\"file_types_description\", \"All Files\");\r\n  this.ensureDefault(\"file_size_limit\", 0);\r\n  this.ensureDefault(\"file_upload_limit\", 0);\r\n  this.ensureDefault(\"file_queue_limit\", 0);\r\n  this.ensureDefault(\"flash_url\", \"swfupload.swf\");\r\n  this.ensureDefault(\"prevent_swf_caching\", true);\r\n  this.ensureDefault(\"button_image_url\", \"\");\r\n  this.ensureDefault(\"button_width\", 1);\r\n  this.ensureDefault(\"button_height\", 1);\r\n  this.ensureDefault(\"button_text\", \"\");\r\n  this.ensureDefault(\"button_text_style\", \"color: #000000; font-size: 16pt;\");\r\n  this.ensureDefault(\"button_text_top_padding\", 0);\r\n  this.ensureDefault(\"button_text_left_padding\", 0);\r\n  this.ensureDefault(\"button_action\", SWFUpload.BUTTON_ACTION.SELECT_FILES);\r\n  this.ensureDefault(\"button_disabled\", false);\r\n  this.ensureDefault(\"button_placeholder_id\", \"\");\r\n  this.ensureDefault(\"button_placeholder\", null);\r\n  this.ensureDefault(\"button_cursor\", SWFUpload.CURSOR.ARROW);\r\n  this.ensureDefault(\"button_window_mode\", SWFUpload.WINDOW_MODE.WINDOW);\r\n  this.ensureDefault(\"debug\", false);\r\n  this.settings.debug_enabled = this.settings.debug;\r\n  this.settings.return_upload_start_handler = this.returnUploadStart;\r\n  this.ensureDefault(\"swfupload_loaded_handler\", null);\r\n  this.ensureDefault(\"file_dialog_start_handler\", null);\r\n  this.ensureDefault(\"file_queued_handler\", null);\r\n  this.ensureDefault(\"file_queue_error_handler\", null);\r\n  this.ensureDefault(\"file_dialog_complete_handler\", null);\r\n  this.ensureDefault(\"upload_start_handler\", null);\r\n  this.ensureDefault(\"upload_progress_handler\", null);\r\n  this.ensureDefault(\"upload_error_handler\", null);\r\n  this.ensureDefault(\"upload_success_handler\", null);\r\n  this.ensureDefault(\"upload_complete_handler\", null);\r\n  this.ensureDefault(\"debug_handler\", this.debugMessage);\r\n  this.ensureDefault(\"custom_settings\", {});\r\n  this.customSettings = this.settings.custom_settings;\r\n  if (!!this.settings.prevent_swf_caching) {\r\n    this.settings.flash_url = this.settings.flash_url + (this.settings.flash_url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"preventswfcaching=\" + new Date().getTime();\r\n  }\r\n  if (!this.settings.preserve_relative_urls) {\r\n    this.settings.upload_url = SWFUpload.completeURL(this.settings.upload_url);\r\n    this.settings.button_image_url = SWFUpload.completeURL(this.settings.button_image_url);\r\n  }\r\n  delete this.ensureDefault;\r\n};\r\n\r\n\r\nSWFUpload.prototype.loadFlash = function () {\r\n  var targetElement, tempParent;\r\n  if (document.getElementById(this.movieName) !== null) {\r\n    throw \"ID \" + this.movieName + \" is already in use. The Flash Object could not be added\";\r\n  }\r\n  targetElement = document.getElementById(this.settings.button_placeholder_id) || this.settings.button_placeholder;\r\n  if (targetElement == undefined) {\r\n    throw \"Could not find the placeholder element: \" + this.settings.button_placeholder_id;\r\n  }\r\n  tempParent = document.createElement(\"div\");\r\n  tempParent.innerHTML = this.getFlashHTML();\r\n  targetElement.parentNode.replaceChild(tempParent.firstChild, targetElement);\r\n  if (window[this.movieName] == undefined) {\r\n    window[this.movieName] = this.getMovieElement();\r\n  }\r\n};\r\n\r\n\r\nSWFUpload.prototype.getFlashHTML = function () {\r\n  var classid = '';\r\n  if (KindEditor.IE && KindEditor.V > 8) {\r\n    classid = ' classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"';\r\n  }\r\n  return ['<object id=\"', this.movieName, '\"' + classid + ' type=\"application/x-shockwave-flash\" data=\"', this.settings.flash_url, '\" width=\"', this.settings.button_width, '\" height=\"', this.settings.button_height, '\" class=\"swfupload\">',\r\n        '<param name=\"wmode\" value=\"', this.settings.button_window_mode, '\" />',\r\n        '<param name=\"movie\" value=\"', this.settings.flash_url, '\" />',\r\n        '<param name=\"quality\" value=\"high\" />',\r\n        '<param name=\"menu\" value=\"false\" />',\r\n        '<param name=\"allowScriptAccess\" value=\"always\" />',\r\n        '<param name=\"flashvars\" value=\"' + this.getFlashVars() + '\" />',\r\n        '</object>'].join(\"\");\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.getFlashVars = function () {\r\n  var paramString = this.buildParamString();\r\n  var httpSuccessString = this.settings.http_success.join(\",\");\r\n  return [\"movieName=\", encodeURIComponent(this.movieName),\r\n      \"&amp;uploadURL=\", encodeURIComponent(this.settings.upload_url),\r\n      \"&amp;useQueryString=\", encodeURIComponent(this.settings.use_query_string),\r\n      \"&amp;requeueOnError=\", encodeURIComponent(this.settings.requeue_on_error),\r\n      \"&amp;httpSuccess=\", encodeURIComponent(httpSuccessString),\r\n      \"&amp;assumeSuccessTimeout=\", encodeURIComponent(this.settings.assume_success_timeout),\r\n      \"&amp;params=\", encodeURIComponent(paramString),\r\n      \"&amp;filePostName=\", encodeURIComponent(this.settings.file_post_name),\r\n      \"&amp;fileTypes=\", encodeURIComponent(this.settings.file_types),\r\n      \"&amp;fileTypesDescription=\", encodeURIComponent(this.settings.file_types_description),\r\n      \"&amp;fileSizeLimit=\", encodeURIComponent(this.settings.file_size_limit),\r\n      \"&amp;fileUploadLimit=\", encodeURIComponent(this.settings.file_upload_limit),\r\n      \"&amp;fileQueueLimit=\", encodeURIComponent(this.settings.file_queue_limit),\r\n      \"&amp;debugEnabled=\", encodeURIComponent(this.settings.debug_enabled),\r\n      \"&amp;buttonImageURL=\", encodeURIComponent(this.settings.button_image_url),\r\n      \"&amp;buttonWidth=\", encodeURIComponent(this.settings.button_width),\r\n      \"&amp;buttonHeight=\", encodeURIComponent(this.settings.button_height),\r\n      \"&amp;buttonText=\", encodeURIComponent(this.settings.button_text),\r\n      \"&amp;buttonTextTopPadding=\", encodeURIComponent(this.settings.button_text_top_padding),\r\n      \"&amp;buttonTextLeftPadding=\", encodeURIComponent(this.settings.button_text_left_padding),\r\n      \"&amp;buttonTextStyle=\", encodeURIComponent(this.settings.button_text_style),\r\n      \"&amp;buttonAction=\", encodeURIComponent(this.settings.button_action),\r\n      \"&amp;buttonDisabled=\", encodeURIComponent(this.settings.button_disabled),\r\n      \"&amp;buttonCursor=\", encodeURIComponent(this.settings.button_cursor)\r\n    ].join(\"\");\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.getMovieElement = function () {\r\n  if (this.movieElement == undefined) {\r\n    this.movieElement = document.getElementById(this.movieName);\r\n  }\r\n  if (this.movieElement === null) {\r\n    throw \"Could not find Flash element\";\r\n  }\r\n  return this.movieElement;\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.buildParamString = function () {\r\n  var postParams = this.settings.post_params;\r\n  var paramStringPairs = [];\r\n  if (typeof(postParams) === \"object\") {\r\n    for (var name in postParams) {\r\n      if (postParams.hasOwnProperty(name)) {\r\n        paramStringPairs.push(encodeURIComponent(name.toString()) + \"=\" + encodeURIComponent(postParams[name].toString()));\r\n      }\r\n    }\r\n  }\r\n  return paramStringPairs.join(\"&amp;\");\r\n};\r\n\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.destroy = function () {\r\n  try {\r\n    this.cancelUpload(null, false);\r\n    var movieElement = null;\r\n    movieElement = this.getMovieElement();\r\n    if (movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n      for (var i in movieElement) {\r\n        try {\r\n          if (typeof(movieElement[i]) === \"function\") {\r\n            movieElement[i] = null;\r\n          }\r\n        } catch (ex1) {}\r\n      }\r\n      try {\r\n        movieElement.parentNode.removeChild(movieElement);\r\n      } catch (ex) {}\r\n    }\r\n    window[this.movieName] = null;\r\n    SWFUpload.instances[this.movieName] = null;\r\n    delete SWFUpload.instances[this.movieName];\r\n    this.movieElement = null;\r\n    this.settings = null;\r\n    this.customSettings = null;\r\n    this.eventQueue = null;\r\n    this.movieName = null;\r\n    return true;\r\n  } catch (ex2) {\r\n    return false;\r\n  }\r\n};\r\n\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.displayDebugInfo = function () {\r\n  this.debug(\r\n    [\r\n      \"---SWFUpload Instance Info---\\n\",\r\n      \"Version: \", SWFUpload.version, \"\\n\",\r\n      \"Movie Name: \", this.movieName, \"\\n\",\r\n      \"Settings:\\n\",\r\n      \"\\t\", \"upload_url:               \", this.settings.upload_url, \"\\n\",\r\n      \"\\t\", \"flash_url:                \", this.settings.flash_url, \"\\n\",\r\n      \"\\t\", \"use_query_string:         \", this.settings.use_query_string.toString(), \"\\n\",\r\n      \"\\t\", \"requeue_on_error:         \", this.settings.requeue_on_error.toString(), \"\\n\",\r\n      \"\\t\", \"http_success:             \", this.settings.http_success.join(\", \"), \"\\n\",\r\n      \"\\t\", \"assume_success_timeout:   \", this.settings.assume_success_timeout, \"\\n\",\r\n      \"\\t\", \"file_post_name:           \", this.settings.file_post_name, \"\\n\",\r\n      \"\\t\", \"post_params:              \", this.settings.post_params.toString(), \"\\n\",\r\n      \"\\t\", \"file_types:               \", this.settings.file_types, \"\\n\",\r\n      \"\\t\", \"file_types_description:   \", this.settings.file_types_description, \"\\n\",\r\n      \"\\t\", \"file_size_limit:          \", this.settings.file_size_limit, \"\\n\",\r\n      \"\\t\", \"file_upload_limit:        \", this.settings.file_upload_limit, \"\\n\",\r\n      \"\\t\", \"file_queue_limit:         \", this.settings.file_queue_limit, \"\\n\",\r\n      \"\\t\", \"debug:                    \", this.settings.debug.toString(), \"\\n\",\r\n      \"\\t\", \"prevent_swf_caching:      \", this.settings.prevent_swf_caching.toString(), \"\\n\",\r\n      \"\\t\", \"button_placeholder_id:    \", this.settings.button_placeholder_id.toString(), \"\\n\",\r\n      \"\\t\", \"button_placeholder:       \", (this.settings.button_placeholder ? \"Set\" : \"Not Set\"), \"\\n\",\r\n      \"\\t\", \"button_image_url:         \", this.settings.button_image_url.toString(), \"\\n\",\r\n      \"\\t\", \"button_width:             \", this.settings.button_width.toString(), \"\\n\",\r\n      \"\\t\", \"button_height:            \", this.settings.button_height.toString(), \"\\n\",\r\n      \"\\t\", \"button_text:              \", this.settings.button_text.toString(), \"\\n\",\r\n      \"\\t\", \"button_text_style:        \", this.settings.button_text_style.toString(), \"\\n\",\r\n      \"\\t\", \"button_text_top_padding:  \", this.settings.button_text_top_padding.toString(), \"\\n\",\r\n      \"\\t\", \"button_text_left_padding: \", this.settings.button_text_left_padding.toString(), \"\\n\",\r\n      \"\\t\", \"button_action:            \", this.settings.button_action.toString(), \"\\n\",\r\n      \"\\t\", \"button_disabled:          \", this.settings.button_disabled.toString(), \"\\n\",\r\n      \"\\t\", \"custom_settings:          \", this.settings.custom_settings.toString(), \"\\n\",\r\n      \"Event Handlers:\\n\",\r\n      \"\\t\", \"swfupload_loaded_handler assigned:  \", (typeof this.settings.swfupload_loaded_handler === \"function\").toString(), \"\\n\",\r\n      \"\\t\", \"file_dialog_start_handler assigned: \", (typeof this.settings.file_dialog_start_handler === \"function\").toString(), \"\\n\",\r\n      \"\\t\", \"file_queued_handler assigned:       \", (typeof this.settings.file_queued_handler === \"function\").toString(), \"\\n\",\r\n      \"\\t\", \"file_queue_error_handler assigned:  \", (typeof this.settings.file_queue_error_handler === \"function\").toString(), \"\\n\",\r\n      \"\\t\", \"upload_start_handler assigned:      \", (typeof this.settings.upload_start_handler === \"function\").toString(), \"\\n\",\r\n      \"\\t\", \"upload_progress_handler assigned:   \", (typeof this.settings.upload_progress_handler === \"function\").toString(), \"\\n\",\r\n      \"\\t\", \"upload_error_handler assigned:      \", (typeof this.settings.upload_error_handler === \"function\").toString(), \"\\n\",\r\n      \"\\t\", \"upload_success_handler assigned:    \", (typeof this.settings.upload_success_handler === \"function\").toString(), \"\\n\",\r\n      \"\\t\", \"upload_complete_handler assigned:   \", (typeof this.settings.upload_complete_handler === \"function\").toString(), \"\\n\",\r\n      \"\\t\", \"debug_handler assigned:             \", (typeof this.settings.debug_handler === \"function\").toString(), \"\\n\"\r\n    ].join(\"\")\r\n  );\r\n};\r\n/* Note: addSetting and getSetting are no longer used by SWFUpload but are included\r\n  the maintain v2 API compatibility\r\n*/\r\n\r\nSWFUpload.prototype.addSetting = function (name, value, default_value) {\r\n    if (value == undefined) {\r\n        return (this.settings[name] = default_value);\r\n    } else {\r\n        return (this.settings[name] = value);\r\n  }\r\n};\r\n\r\n\r\nSWFUpload.prototype.getSetting = function (name) {\r\n    if (this.settings[name] != undefined) {\r\n        return this.settings[name];\r\n  }\r\n    return \"\";\r\n};\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.callFlash = function (functionName, argumentArray) {\r\n  argumentArray = argumentArray || [];\r\n  var movieElement = this.getMovieElement();\r\n  var returnValue, returnString;\r\n  try {\r\n    returnString = movieElement.CallFunction('<invoke name=\"' + functionName + '\" returntype=\"javascript\">' + __flash__argumentsToXML(argumentArray, 0) + '</invoke>');\r\n    returnValue = eval(returnString);\r\n  } catch (ex) {\r\n    throw \"Call to \" + functionName + \" failed\";\r\n  }\r\n  if (returnValue != undefined && typeof returnValue.post === \"object\") {\r\n    returnValue = this.unescapeFilePostParams(returnValue);\r\n  }\r\n  return returnValue;\r\n};\r\n/* *****************************\r\n  -- Flash control methods --\r\n  Your UI should use these\r\n  to operate SWFUpload\r\n   ***************************** */\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.selectFile = function () {\r\n  this.callFlash(\"SelectFile\");\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.selectFiles = function () {\r\n  this.callFlash(\"SelectFiles\");\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.startUpload = function (fileID) {\r\n  this.callFlash(\"StartUpload\", [fileID]);\r\n};\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.cancelUpload = function (fileID, triggerErrorEvent) {\r\n  if (triggerErrorEvent !== false) {\r\n    triggerErrorEvent = true;\r\n  }\r\n  this.callFlash(\"CancelUpload\", [fileID, triggerErrorEvent]);\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.stopUpload = function () {\r\n  this.callFlash(\"StopUpload\");\r\n};\r\n/* ************************\r\n * Settings methods\r\n *   These methods change the SWFUpload settings.\r\n *   SWFUpload settings should not be changed directly on the settings object\r\n *   since many of the settings need to be passed to Flash in order to take\r\n *   effect.\r\n * *********************** */\r\n\r\n\r\nSWFUpload.prototype.getStats = function () {\r\n  return this.callFlash(\"GetStats\");\r\n};\r\n\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.setStats = function (statsObject) {\r\n  this.callFlash(\"SetStats\", [statsObject]);\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.getFile = function (fileID) {\r\n  if (typeof(fileID) === \"number\") {\r\n    return this.callFlash(\"GetFileByIndex\", [fileID]);\r\n  } else {\r\n    return this.callFlash(\"GetFile\", [fileID]);\r\n  }\r\n};\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.addFileParam = function (fileID, name, value) {\r\n  return this.callFlash(\"AddFileParam\", [fileID, name, value]);\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.removeFileParam = function (fileID, name) {\r\n  this.callFlash(\"RemoveFileParam\", [fileID, name]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setUploadURL = function (url) {\r\n  this.settings.upload_url = url.toString();\r\n  this.callFlash(\"SetUploadURL\", [url]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setPostParams = function (paramsObject) {\r\n  this.settings.post_params = paramsObject;\r\n  this.callFlash(\"SetPostParams\", [paramsObject]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.addPostParam = function (name, value) {\r\n  this.settings.post_params[name] = value;\r\n  this.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.removePostParam = function (name) {\r\n  delete this.settings.post_params[name];\r\n  this.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setFileTypes = function (types, description) {\r\n  this.settings.file_types = types;\r\n  this.settings.file_types_description = description;\r\n  this.callFlash(\"SetFileTypes\", [types, description]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setFileSizeLimit = function (fileSizeLimit) {\r\n  this.settings.file_size_limit = fileSizeLimit;\r\n  this.callFlash(\"SetFileSizeLimit\", [fileSizeLimit]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setFileUploadLimit = function (fileUploadLimit) {\r\n  this.settings.file_upload_limit = fileUploadLimit;\r\n  this.callFlash(\"SetFileUploadLimit\", [fileUploadLimit]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setFileQueueLimit = function (fileQueueLimit) {\r\n  this.settings.file_queue_limit = fileQueueLimit;\r\n  this.callFlash(\"SetFileQueueLimit\", [fileQueueLimit]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setFilePostName = function (filePostName) {\r\n  this.settings.file_post_name = filePostName;\r\n  this.callFlash(\"SetFilePostName\", [filePostName]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setUseQueryString = function (useQueryString) {\r\n  this.settings.use_query_string = useQueryString;\r\n  this.callFlash(\"SetUseQueryString\", [useQueryString]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setRequeueOnError = function (requeueOnError) {\r\n  this.settings.requeue_on_error = requeueOnError;\r\n  this.callFlash(\"SetRequeueOnError\", [requeueOnError]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setHTTPSuccess = function (http_status_codes) {\r\n  if (typeof http_status_codes === \"string\") {\r\n    http_status_codes = http_status_codes.replace(\" \", \"\").split(\",\");\r\n  }\r\n  this.settings.http_success = http_status_codes;\r\n  this.callFlash(\"SetHTTPSuccess\", [http_status_codes]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setAssumeSuccessTimeout = function (timeout_seconds) {\r\n  this.settings.assume_success_timeout = timeout_seconds;\r\n  this.callFlash(\"SetAssumeSuccessTimeout\", [timeout_seconds]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setDebugEnabled = function (debugEnabled) {\r\n  this.settings.debug_enabled = debugEnabled;\r\n  this.callFlash(\"SetDebugEnabled\", [debugEnabled]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setButtonImageURL = function (buttonImageURL) {\r\n  if (buttonImageURL == undefined) {\r\n    buttonImageURL = \"\";\r\n  }\r\n  this.settings.button_image_url = buttonImageURL;\r\n  this.callFlash(\"SetButtonImageURL\", [buttonImageURL]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setButtonDimensions = function (width, height) {\r\n  this.settings.button_width = width;\r\n  this.settings.button_height = height;\r\n  var movie = this.getMovieElement();\r\n  if (movie != undefined) {\r\n    movie.style.width = width + \"px\";\r\n    movie.style.height = height + \"px\";\r\n  }\r\n  this.callFlash(\"SetButtonDimensions\", [width, height]);\r\n};\r\n\r\nSWFUpload.prototype.setButtonText = function (html) {\r\n  this.settings.button_text = html;\r\n  this.callFlash(\"SetButtonText\", [html]);\r\n};\r\n\r\nSWFUpload.prototype.setButtonTextPadding = function (left, top) {\r\n  this.settings.button_text_top_padding = top;\r\n  this.settings.button_text_left_padding = left;\r\n  this.callFlash(\"SetButtonTextPadding\", [left, top]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setButtonTextStyle = function (css) {\r\n  this.settings.button_text_style = css;\r\n  this.callFlash(\"SetButtonTextStyle\", [css]);\r\n};\r\n\r\nSWFUpload.prototype.setButtonDisabled = function (isDisabled) {\r\n  this.settings.button_disabled = isDisabled;\r\n  this.callFlash(\"SetButtonDisabled\", [isDisabled]);\r\n};\r\n\r\nSWFUpload.prototype.setButtonAction = function (buttonAction) {\r\n  this.settings.button_action = buttonAction;\r\n  this.callFlash(\"SetButtonAction\", [buttonAction]);\r\n};\r\n\r\n\r\nSWFUpload.prototype.setButtonCursor = function (cursor) {\r\n  this.settings.button_cursor = cursor;\r\n  this.callFlash(\"SetButtonCursor\", [cursor]);\r\n};\r\n/* *******************************\r\n  Flash Event Interfaces\r\n  These functions are used by Flash to trigger the various\r\n  events.\r\n  All these functions a Private.\r\n  Because the ExternalInterface library is buggy the event calls\r\n  are added to a queue and the queue then executed by a setTimeout.\r\n  This ensures that events are executed in a determinate order and that\r\n  the ExternalInterface bugs are avoided.\r\n******************************* */\r\nSWFUpload.prototype.queueEvent = function (handlerName, argumentArray) {\r\n  if (argumentArray == undefined) {\r\n    argumentArray = [];\r\n  } else if (!(argumentArray instanceof Array)) {\r\n    argumentArray = [argumentArray];\r\n  }\r\n  var self = this;\r\n  if (typeof this.settings[handlerName] === \"function\") {\r\n    this.eventQueue.push(function () {\r\n      this.settings[handlerName].apply(this, argumentArray);\r\n    });\r\n    setTimeout(function () {\r\n      self.executeNextEvent();\r\n    }, 0);\r\n  } else if (this.settings[handlerName] !== null) {\r\n    throw \"Event handler \" + handlerName + \" is unknown or is not a function\";\r\n  }\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.executeNextEvent = function () {\r\n  var  f = this.eventQueue ? this.eventQueue.shift() : null;\r\n  if (typeof(f) === \"function\") {\r\n    f.apply(this);\r\n  }\r\n};\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.unescapeFilePostParams = function (file) {\r\n  var reg = /[$]([0-9a-f]{4})/i;\r\n  var unescapedPost = {};\r\n  var uk;\r\n  if (file != undefined) {\r\n    for (var k in file.post) {\r\n      if (file.post.hasOwnProperty(k)) {\r\n        uk = k;\r\n        var match;\r\n        while ((match = reg.exec(uk)) !== null) {\r\n          uk = uk.replace(match[0], String.fromCharCode(parseInt(\"0x\" + match[1], 16)));\r\n        }\r\n        unescapedPost[uk] = file.post[k];\r\n      }\r\n    }\r\n    file.post = unescapedPost;\r\n  }\r\n  return file;\r\n};\r\n\r\n\r\nSWFUpload.prototype.testExternalInterface = function () {\r\n  try {\r\n    return this.callFlash(\"TestExternalInterface\");\r\n  } catch (ex) {\r\n    return false;\r\n  }\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.flashReady = function () {\r\n  var movieElement = this.getMovieElement();\r\n  if (!movieElement) {\r\n    this.debug(\"Flash called back ready but the flash movie can't be found.\");\r\n    return;\r\n  }\r\n  this.cleanUp(movieElement);\r\n  this.queueEvent(\"swfupload_loaded_handler\");\r\n};\r\n\r\n\r\n\r\nSWFUpload.prototype.cleanUp = function (movieElement) {\r\n  try {\r\n    if (this.movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n      this.debug(\"Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)\");\r\n      for (var key in movieElement) {\r\n        try {\r\n          if (typeof(movieElement[key]) === \"function\") {\r\n            movieElement[key] = null;\r\n          }\r\n        } catch (ex) {\r\n        }\r\n      }\r\n    }\r\n  } catch (ex1) {\r\n  }\r\n  window[\"__flash__removeCallback\"] = function (instance, name) {\r\n    try {\r\n      if (instance) {\r\n        instance[name] = null;\r\n      }\r\n    } catch (flashEx) {\r\n    }\r\n  };\r\n};\r\n/* This is a chance to do something before the browse window opens */\r\nSWFUpload.prototype.fileDialogStart = function () {\r\n  this.queueEvent(\"file_dialog_start_handler\");\r\n};\r\n/* Called when a file is successfully added to the queue. */\r\nSWFUpload.prototype.fileQueued = function (file) {\r\n  file = this.unescapeFilePostParams(file);\r\n  this.queueEvent(\"file_queued_handler\", file);\r\n};\r\n/* Handle errors that occur when an attempt to queue a file fails. */\r\nSWFUpload.prototype.fileQueueError = function (file, errorCode, message) {\r\n  file = this.unescapeFilePostParams(file);\r\n  this.queueEvent(\"file_queue_error_handler\", [file, errorCode, message]);\r\n};\r\n/* Called after the file dialog has closed and the selected files have been queued.\r\n  You could call startUpload here if you want the queued files to begin uploading immediately. */\r\nSWFUpload.prototype.fileDialogComplete = function (numFilesSelected, numFilesQueued, numFilesInQueue) {\r\n  this.queueEvent(\"file_dialog_complete_handler\", [numFilesSelected, numFilesQueued, numFilesInQueue]);\r\n};\r\nSWFUpload.prototype.uploadStart = function (file) {\r\n  file = this.unescapeFilePostParams(file);\r\n  this.queueEvent(\"return_upload_start_handler\", file);\r\n};\r\nSWFUpload.prototype.returnUploadStart = function (file) {\r\n  var returnValue;\r\n  if (typeof this.settings.upload_start_handler === \"function\") {\r\n    file = this.unescapeFilePostParams(file);\r\n    returnValue = this.settings.upload_start_handler.call(this, file);\r\n  } else if (this.settings.upload_start_handler != undefined) {\r\n    throw \"upload_start_handler must be a function\";\r\n  }\r\n  if (returnValue === undefined) {\r\n    returnValue = true;\r\n  }\r\n  returnValue = !!returnValue;\r\n  this.callFlash(\"ReturnUploadStart\", [returnValue]);\r\n};\r\nSWFUpload.prototype.uploadProgress = function (file, bytesComplete, bytesTotal) {\r\n  file = this.unescapeFilePostParams(file);\r\n  this.queueEvent(\"upload_progress_handler\", [file, bytesComplete, bytesTotal]);\r\n};\r\nSWFUpload.prototype.uploadError = function (file, errorCode, message) {\r\n  file = this.unescapeFilePostParams(file);\r\n  this.queueEvent(\"upload_error_handler\", [file, errorCode, message]);\r\n};\r\nSWFUpload.prototype.uploadSuccess = function (file, serverData, responseReceived) {\r\n  file = this.unescapeFilePostParams(file);\r\n  this.queueEvent(\"upload_success_handler\", [file, serverData, responseReceived]);\r\n};\r\nSWFUpload.prototype.uploadComplete = function (file) {\r\n  file = this.unescapeFilePostParams(file);\r\n  this.queueEvent(\"upload_complete_handler\", file);\r\n};\r\n/* Called by SWFUpload JavaScript and Flash functions when debug is enabled. By default it writes messages to the\r\n   internal debug console.  You can override this event and have messages written where you want. */\r\nSWFUpload.prototype.debug = function (message) {\r\n  this.queueEvent(\"debug_handler\", message);\r\n};\r\n/* **********************************\r\n  Debug Console\r\n  The debug console is a self contained, in page location\r\n  for debug message to be sent.  The Debug Console adds\r\n  itself to the body if necessary.\r\n  The console is automatically scrolled as messages appear.\r\n  If you are using your own debug handler or when you deploy to production and\r\n  have debug disabled you can remove these functions to reduce the file size\r\n  and complexity.\r\n********************************** */\r\n\r\n\r\n\r\n\r\nSWFUpload.prototype.debugMessage = function (message) {\r\n  if (this.settings.debug) {\r\n    var exceptionMessage, exceptionValues = [];\r\n    if (typeof message === \"object\" && typeof message.name === \"string\" && typeof message.message === \"string\") {\r\n      for (var key in message) {\r\n        if (message.hasOwnProperty(key)) {\r\n          exceptionValues.push(key + \": \" + message[key]);\r\n        }\r\n      }\r\n      exceptionMessage = exceptionValues.join(\"\\n\") || \"\";\r\n      exceptionValues = exceptionMessage.split(\"\\n\");\r\n      exceptionMessage = \"EXCEPTION: \" + exceptionValues.join(\"\\nEXCEPTION: \");\r\n      SWFUpload.Console.writeLine(exceptionMessage);\r\n    } else {\r\n      SWFUpload.Console.writeLine(message);\r\n    }\r\n  }\r\n};\r\nSWFUpload.Console = {};\r\nSWFUpload.Console.writeLine = function (message) {\r\n  var console, documentForm;\r\n  try {\r\n    console = document.getElementById(\"SWFUpload_Console\");\r\n    if (!console) {\r\n      documentForm = document.createElement(\"form\");\r\n      document.getElementsByTagName(\"body\")[0].appendChild(documentForm);\r\n      console = document.createElement(\"textarea\");\r\n      console.id = \"SWFUpload_Console\";\r\n      console.style.fontFamily = \"monospace\";\r\n      console.setAttribute(\"wrap\", \"off\");\r\n      console.wrap = \"off\";\r\n      console.style.overflow = \"auto\";\r\n      console.style.width = \"700px\";\r\n      console.style.height = \"350px\";\r\n      console.style.margin = \"5px\";\r\n      documentForm.appendChild(console);\r\n    }\r\n    console.value += message + \"\\n\";\r\n    console.scrollTop = console.scrollHeight - console.clientHeight;\r\n  } catch (ex) {\r\n    alert(\"Exception: \" + ex.name + \" Message: \" + ex.message);\r\n  }\r\n};\r\n})();\r\n(function() {\r\n/*\r\n  Queue Plug-in\r\n  Features:\r\n    *Adds a cancelQueue() method for cancelling the entire queue.\r\n    *All queued files are uploaded when startUpload() is called.\r\n    *If false is returned from uploadComplete then the queue upload is stopped.\r\n     If false is not returned (strict comparison) then the queue upload is continued.\r\n    *Adds a QueueComplete event that is fired when all the queued files have finished uploading.\r\n     Set the event handler with the queue_complete_handler setting.\r\n  */\r\nif (typeof(SWFUpload) === \"function\") {\r\n  SWFUpload.queue = {};\r\n  SWFUpload.prototype.initSettings = (function (oldInitSettings) {\r\n    return function () {\r\n      if (typeof(oldInitSettings) === \"function\") {\r\n        oldInitSettings.call(this);\r\n      }\r\n      this.queueSettings = {};\r\n      this.queueSettings.queue_cancelled_flag = false;\r\n      this.queueSettings.queue_upload_count = 0;\r\n      this.queueSettings.user_upload_complete_handler = this.settings.upload_complete_handler;\r\n      this.queueSettings.user_upload_start_handler = this.settings.upload_start_handler;\r\n      this.settings.upload_complete_handler = SWFUpload.queue.uploadCompleteHandler;\r\n      this.settings.upload_start_handler = SWFUpload.queue.uploadStartHandler;\r\n      this.settings.queue_complete_handler = this.settings.queue_complete_handler || null;\r\n    };\r\n  })(SWFUpload.prototype.initSettings);\r\n  SWFUpload.prototype.startUpload = function (fileID) {\r\n    this.queueSettings.queue_cancelled_flag = false;\r\n    this.callFlash(\"StartUpload\", [fileID]);\r\n  };\r\n  SWFUpload.prototype.cancelQueue = function () {\r\n    this.queueSettings.queue_cancelled_flag = true;\r\n    this.stopUpload();\r\n    var stats = this.getStats();\r\n    while (stats.files_queued > 0) {\r\n      this.cancelUpload();\r\n      stats = this.getStats();\r\n    }\r\n  };\r\n  SWFUpload.queue.uploadStartHandler = function (file) {\r\n    var returnValue;\r\n    if (typeof(this.queueSettings.user_upload_start_handler) === \"function\") {\r\n      returnValue = this.queueSettings.user_upload_start_handler.call(this, file);\r\n    }\r\n    returnValue = (returnValue === false) ? false : true;\r\n    this.queueSettings.queue_cancelled_flag = !returnValue;\r\n    return returnValue;\r\n  };\r\n  SWFUpload.queue.uploadCompleteHandler = function (file) {\r\n    var user_upload_complete_handler = this.queueSettings.user_upload_complete_handler;\r\n    var continueUpload;\r\n    if (file.filestatus === SWFUpload.FILE_STATUS.COMPLETE) {\r\n      this.queueSettings.queue_upload_count++;\r\n    }\r\n    if (typeof(user_upload_complete_handler) === \"function\") {\r\n      continueUpload = (user_upload_complete_handler.call(this, file) === false) ? false : true;\r\n    } else if (file.filestatus === SWFUpload.FILE_STATUS.QUEUED) {\r\n      continueUpload = false;\r\n    } else {\r\n      continueUpload = true;\r\n    }\r\n    if (continueUpload) {\r\n      var stats = this.getStats();\r\n      if (stats.files_queued > 0 && this.queueSettings.queue_cancelled_flag === false) {\r\n        this.startUpload();\r\n      } else if (this.queueSettings.queue_cancelled_flag === false) {\r\n        this.queueEvent(\"queue_complete_handler\", [this.queueSettings.queue_upload_count]);\r\n        this.queueSettings.queue_upload_count = 0;\r\n      } else {\r\n        this.queueSettings.queue_cancelled_flag = false;\r\n        this.queueSettings.queue_upload_count = 0;\r\n      }\r\n    }\r\n  };\r\n}\r\n})();\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('pagebreak', function(K) {\r\n  var self = this;\r\n  var name = 'pagebreak';\r\n  var pagebreakHtml = K.undef(self.pagebreakHtml, '<hr style=\"page-break-after: always;\" class=\"ke-pagebreak\" />');\r\n  self.clickToolbar(name, function() {\r\n    var cmd = self.cmd, range = cmd.range;\r\n    self.focus();\r\n    var tail = self.newlineTag == 'br' || K.WEBKIT ? '' : '<span id=\"__kindeditor_tail_tag__\"></span>';\r\n    self.insertHtml(pagebreakHtml + tail);\r\n    if (tail !== '') {\r\n      var p = K('#__kindeditor_tail_tag__', self.edit.doc);\r\n      range.selectNodeContents(p[0]);\r\n      p.removeAttr('id');\r\n      cmd.select();\r\n    }\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('plainpaste', function(K) {\r\n  var self = this, name = 'plainpaste';\r\n  self.clickToolbar(name, function() {\r\n    var lang = self.lang(name + '.'),\r\n      html = '<div style=\"padding:10px 20px;\">' +\r\n        '<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n        '<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>' +\r\n        '</div>',\r\n      dialog = self.createDialog({\r\n        name : name,\r\n        width : 450,\r\n        title : self.lang(name),\r\n        body : html,\r\n        yesBtn : {\r\n          name : self.lang('yes'),\r\n          click : function(e) {\r\n            var html = textarea.val();\r\n            html = K.escape(html);\r\n            html = html.replace(/ {2}/g, ' &nbsp;');\r\n            if (self.newlineTag == 'p') {\r\n              html = html.replace(/^/, '<p>').replace(/$/, '</p>').replace(/\\n/g, '</p><p>');\r\n            } else {\r\n              html = html.replace(/\\n/g, '<br />$&');\r\n            }\r\n            self.insertHtml(html).hideDialog().focus();\r\n          }\r\n        }\r\n      }),\r\n      textarea = K('textarea', dialog.div);\r\n    textarea[0].focus();\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('preview', function(K) {\r\n  var self = this, name = 'preview', undefined;\r\n  self.clickToolbar(name, function() {\r\n    var lang = self.lang(name + '.'),\r\n      html = '<div style=\"padding:10px 20px;\">' +\r\n        '<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe>' +\r\n        '</div>',\r\n      dialog = self.createDialog({\r\n        name : name,\r\n        width : 750,\r\n        title : self.lang(name),\r\n        body : html\r\n      }),\r\n      iframe = K('iframe', dialog.div),\r\n      doc = K.iframeDoc(iframe);\r\n    doc.open();\r\n    doc.write(self.fullHtml());\r\n    doc.close();\r\n    K(doc.body).css('background-color', '#FFF');\r\n    iframe[0].contentWindow.focus();\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('quickformat', function(K) {\r\n  var self = this, name = 'quickformat',\r\n    blockMap = K.toMap('blockquote,center,div,h1,h2,h3,h4,h5,h6,p');\r\n  function getFirstChild(knode) {\r\n    var child = knode.first();\r\n    while (child && child.first()) {\r\n      child = child.first();\r\n    }\r\n    return child;\r\n  }\r\n  self.clickToolbar(name, function() {\r\n    self.focus();\r\n    var doc = self.edit.doc,\r\n      range = self.cmd.range,\r\n      child = K(doc.body).first(), next,\r\n      nodeList = [], subList = [],\r\n      bookmark = range.createBookmark(true);\r\n    while(child) {\r\n      next = child.next();\r\n      var firstChild = getFirstChild(child);\r\n      if (!firstChild || firstChild.name != 'img') {\r\n        if (blockMap[child.name]) {\r\n          child.html(child.html().replace(/^(\\s|&nbsp;|)+/ig, ''));\r\n          child.css('text-indent', '2em');\r\n        } else {\r\n          subList.push(child);\r\n        }\r\n        if (!next || (blockMap[next.name] || blockMap[child.name] && !blockMap[next.name])) {\r\n          if (subList.length > 0) {\r\n            nodeList.push(subList);\r\n          }\r\n          subList = [];\r\n        }\r\n      }\r\n      child = next;\r\n    }\r\n    K.each(nodeList, function(i, subList) {\r\n      var wrapper = K('<p style=\"text-indent:2em;\"></p>', doc);\r\n      subList[0].before(wrapper);\r\n      K.each(subList, function(i, knode) {\r\n        wrapper.append(knode);\r\n      });\r\n    });\r\n    range.moveToBookmark(bookmark);\r\n    self.addBookmark();\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('table', function(K) {\r\n  var self = this, name = 'table', lang = self.lang(name + '.'), zeroborder = 'ke-zeroborder';\r\n  function _setColor(box, color) {\r\n    color = color.toUpperCase();\r\n    box.css('background-color', color);\r\n    box.css('color', color === '#000000' ? '#FFFFFF' : '#000000');\r\n    box.html(color);\r\n  }\r\n  var pickerList = [];\r\n  function _initColorPicker(dialogDiv, colorBox) {\r\n    colorBox.bind('click,mousedown', function(e){\r\n      e.stopPropagation();\r\n    });\r\n    function removePicker() {\r\n      K.each(pickerList, function() {\r\n        this.remove();\r\n      });\r\n      pickerList = [];\r\n      K(document).unbind('click,mousedown', removePicker);\r\n      dialogDiv.unbind('click,mousedown', removePicker);\r\n    }\r\n    colorBox.click(function(e) {\r\n      removePicker();\r\n      var box = K(this),\r\n        pos = box.pos();\r\n      var picker = K.colorpicker({\r\n        x : pos.x,\r\n        y : pos.y + box.height(),\r\n        z : 811214,\r\n        selectedColor : K(this).html(),\r\n        colors : self.colorTable,\r\n        noColor : self.lang('noColor'),\r\n        shadowMode : self.shadowMode,\r\n        click : function(color) {\r\n          _setColor(box, color);\r\n          removePicker();\r\n        }\r\n      });\r\n      pickerList.push(picker);\r\n      K(document).bind('click,mousedown', removePicker);\r\n      dialogDiv.bind('click,mousedown', removePicker);\r\n    });\r\n  }\r\n  function _getCellIndex(table, row, cell) {\r\n    var rowSpanCount = 0;\r\n    for (var i = 0, len = row.cells.length; i < len; i++) {\r\n      if (row.cells[i] == cell) {\r\n        break;\r\n      }\r\n      rowSpanCount += row.cells[i].rowSpan - 1;\r\n    }\r\n    return cell.cellIndex - rowSpanCount;\r\n  }\r\n  self.plugin.table = {\r\n    prop : function(isInsert) {\r\n      var html = [\r\n        '<div style=\"padding:20px;\">',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keRows\" style=\"width:90px;\">' + lang.cells + '</label>',\r\n        lang.rows + ' <input type=\"text\" id=\"keRows\" class=\"ke-input-text ke-input-number\" name=\"rows\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n        lang.cols + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"cols\" value=\"\" maxlength=\"4\" />',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n        lang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n        '<select name=\"widthType\">',\r\n        '<option value=\"%\">' + lang.percent + '</option>',\r\n        '<option value=\"px\">' + lang.px + '</option>',\r\n        '</select> &nbsp; ',\r\n        lang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n        '<select name=\"heightType\">',\r\n        '<option value=\"%\">' + lang.percent + '</option>',\r\n        '<option value=\"px\">' + lang.px + '</option>',\r\n        '</select>',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"kePadding\" style=\"width:90px;\">' + lang.space + '</label>',\r\n        lang.padding + ' <input type=\"text\" id=\"kePadding\" class=\"ke-input-text ke-input-number\" name=\"padding\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n        lang.spacing + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"spacing\" value=\"\" maxlength=\"4\" />',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n        '<select id=\"keAlign\" name=\"align\">',\r\n        '<option value=\"\">' + lang.alignDefault + '</option>',\r\n        '<option value=\"left\">' + lang.alignLeft + '</option>',\r\n        '<option value=\"center\">' + lang.alignCenter + '</option>',\r\n        '<option value=\"right\">' + lang.alignRight + '</option>',\r\n        '</select>',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n        lang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n        lang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n        '<span class=\"ke-inline-block ke-input-color\"></span>',\r\n        '</div>',\r\n        '</div>'\r\n      ].join('');\r\n      var bookmark = self.cmd.range.createBookmark();\r\n      var dialog = self.createDialog({\r\n        name : name,\r\n        width : 500,\r\n        title : self.lang(name),\r\n        body : html,\r\n        beforeRemove : function() {\r\n          colorBox.unbind();\r\n        },\r\n        yesBtn : {\r\n          name : self.lang('yes'),\r\n          click : function(e) {\r\n            var rows = rowsBox.val(),\r\n              cols = colsBox.val(),\r\n              width = widthBox.val(),\r\n              height = heightBox.val(),\r\n              widthType = widthTypeBox.val(),\r\n              heightType = heightTypeBox.val(),\r\n              padding = paddingBox.val(),\r\n              spacing = spacingBox.val(),\r\n              align = alignBox.val(),\r\n              border = borderBox.val(),\r\n              borderColor = K(colorBox[0]).html() || '',\r\n              bgColor = K(colorBox[1]).html() || '';\r\n            if (rows == 0 || !/^\\d+$/.test(rows)) {\r\n              alert(self.lang('invalidRows'));\r\n              rowsBox[0].focus();\r\n              return;\r\n            }\r\n            if (cols == 0 || !/^\\d+$/.test(cols)) {\r\n              alert(self.lang('invalidRows'));\r\n              colsBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(width)) {\r\n              alert(self.lang('invalidWidth'));\r\n              widthBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(height)) {\r\n              alert(self.lang('invalidHeight'));\r\n              heightBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(padding)) {\r\n              alert(self.lang('invalidPadding'));\r\n              paddingBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(spacing)) {\r\n              alert(self.lang('invalidSpacing'));\r\n              spacingBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(border)) {\r\n              alert(self.lang('invalidBorder'));\r\n              borderBox[0].focus();\r\n              return;\r\n            }\r\n            if (table) {\r\n              if (width !== '') {\r\n                table.width(width + widthType);\r\n              } else {\r\n                table.css('width', '');\r\n              }\r\n              if (table[0].width !== undefined) {\r\n                table.removeAttr('width');\r\n              }\r\n              if (height !== '') {\r\n                table.height(height + heightType);\r\n              } else {\r\n                table.css('height', '');\r\n              }\r\n              if (table[0].height !== undefined) {\r\n                table.removeAttr('height');\r\n              }\r\n              table.css('background-color', bgColor);\r\n              if (table[0].bgColor !== undefined) {\r\n                table.removeAttr('bgColor');\r\n              }\r\n              if (padding !== '') {\r\n                table[0].cellPadding = padding;\r\n              } else {\r\n                table.removeAttr('cellPadding');\r\n              }\r\n              if (spacing !== '') {\r\n                table[0].cellSpacing = spacing;\r\n              } else {\r\n                table.removeAttr('cellSpacing');\r\n              }\r\n              if (align !== '') {\r\n                table[0].align = align;\r\n              } else {\r\n                table.removeAttr('align');\r\n              }\r\n              if (border !== '') {\r\n                table.attr('border', border);\r\n              } else {\r\n                table.removeAttr('border');\r\n              }\r\n              if (border === '' || border === '0') {\r\n                table.addClass(zeroborder);\r\n              } else {\r\n                table.removeClass(zeroborder);\r\n              }\r\n              if (borderColor !== '') {\r\n                table.attr('borderColor', borderColor);\r\n              } else {\r\n                table.removeAttr('borderColor');\r\n              }\r\n              self.hideDialog().focus();\r\n              self.cmd.range.moveToBookmark(bookmark);\r\n              self.cmd.select();\r\n              self.addBookmark();\r\n              return;\r\n            }\r\n            var style = '';\r\n            if (width !== '') {\r\n              style += 'width:' + width + widthType + ';';\r\n            }\r\n            if (height !== '') {\r\n              style += 'height:' + height + heightType + ';';\r\n            }\r\n            if (bgColor !== '') {\r\n              style += 'background-color:' + bgColor + ';';\r\n            }\r\n            var html = '<table';\r\n            if (style !== '') {\r\n              html += ' style=\"' + style + '\"';\r\n            }\r\n            if (padding !== '') {\r\n              html += ' cellpadding=\"' + padding + '\"';\r\n            }\r\n            if (spacing !== '') {\r\n              html += ' cellspacing=\"' + spacing + '\"';\r\n            }\r\n            if (align !== '') {\r\n              html += ' align=\"' + align + '\"';\r\n            }\r\n            if (border !== '') {\r\n              html += ' border=\"' + border + '\"';\r\n            }\r\n            if (border === '' || border === '0') {\r\n              html += ' class=\"' + zeroborder + '\"';\r\n            }\r\n            if (borderColor !== '') {\r\n              html += ' bordercolor=\"' + borderColor + '\"';\r\n            }\r\n            html += '>';\r\n            for (var i = 0; i < rows; i++) {\r\n              html += '<tr>';\r\n              for (var j = 0; j < cols; j++) {\r\n                html += '<td>' + (K.IE ? '&nbsp;' : '<br />') + '</td>';\r\n              }\r\n              html += '</tr>';\r\n            }\r\n            html += '</table>';\r\n            if (!K.IE) {\r\n              html += '<br />';\r\n            }\r\n            self.insertHtml(html);\r\n            self.select().hideDialog().focus();\r\n            self.addBookmark();\r\n          }\r\n        }\r\n      }),\r\n      div = dialog.div,\r\n      rowsBox = K('[name=\"rows\"]', div).val(3),\r\n      colsBox = K('[name=\"cols\"]', div).val(2),\r\n      widthBox = K('[name=\"width\"]', div).val(100),\r\n      heightBox = K('[name=\"height\"]', div),\r\n      widthTypeBox = K('[name=\"widthType\"]', div),\r\n      heightTypeBox = K('[name=\"heightType\"]', div),\r\n      paddingBox = K('[name=\"padding\"]', div).val(2),\r\n      spacingBox = K('[name=\"spacing\"]', div).val(0),\r\n      alignBox = K('[name=\"align\"]', div),\r\n      borderBox = K('[name=\"border\"]', div).val(1),\r\n      colorBox = K('.ke-input-color', div);\r\n      _initColorPicker(div, colorBox.eq(0));\r\n      _initColorPicker(div, colorBox.eq(1));\r\n      _setColor(colorBox.eq(0), '#000000');\r\n      _setColor(colorBox.eq(1), '');\r\n      rowsBox[0].focus();\r\n      rowsBox[0].select();\r\n      var table;\r\n      if (isInsert) {\r\n        return;\r\n      }\r\n      table = self.plugin.getSelectedTable();\r\n      if (table) {\r\n        rowsBox.val(table[0].rows.length);\r\n        colsBox.val(table[0].rows.length > 0 ? table[0].rows[0].cells.length : 0);\r\n        rowsBox.attr('disabled', true);\r\n        colsBox.attr('disabled', true);\r\n        var match,\r\n          tableWidth = table[0].style.width || table[0].width,\r\n          tableHeight = table[0].style.height || table[0].height;\r\n        if (tableWidth !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableWidth))) {\r\n          widthBox.val(match[1]);\r\n          widthTypeBox.val(match[2]);\r\n        } else {\r\n          widthBox.val('');\r\n        }\r\n        if (tableHeight !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableHeight))) {\r\n          heightBox.val(match[1]);\r\n          heightTypeBox.val(match[2]);\r\n        }\r\n        paddingBox.val(table[0].cellPadding || '');\r\n        spacingBox.val(table[0].cellSpacing || '');\r\n        alignBox.val(table[0].align || '');\r\n        borderBox.val(table[0].border === undefined ? '' : table[0].border);\r\n        _setColor(colorBox.eq(0), K.toHex(table.attr('borderColor') || ''));\r\n        _setColor(colorBox.eq(1), K.toHex(table[0].style.backgroundColor || table[0].bgColor || ''));\r\n        widthBox[0].focus();\r\n        widthBox[0].select();\r\n      }\r\n    },\r\n    cellprop : function() {\r\n      var html = [\r\n        '<div style=\"padding:20px;\">',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n        lang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n        '<select name=\"widthType\">',\r\n        '<option value=\"%\">' + lang.percent + '</option>',\r\n        '<option value=\"px\">' + lang.px + '</option>',\r\n        '</select> &nbsp; ',\r\n        lang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n        '<select name=\"heightType\">',\r\n        '<option value=\"%\">' + lang.percent + '</option>',\r\n        '<option value=\"px\">' + lang.px + '</option>',\r\n        '</select>',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n        lang.textAlign + ' <select id=\"keAlign\" name=\"textAlign\">',\r\n        '<option value=\"\">' + lang.alignDefault + '</option>',\r\n        '<option value=\"left\">' + lang.alignLeft + '</option>',\r\n        '<option value=\"center\">' + lang.alignCenter + '</option>',\r\n        '<option value=\"right\">' + lang.alignRight + '</option>',\r\n        '</select> ',\r\n        lang.verticalAlign + ' <select name=\"verticalAlign\">',\r\n        '<option value=\"\">' + lang.alignDefault + '</option>',\r\n        '<option value=\"top\">' + lang.alignTop + '</option>',\r\n        '<option value=\"middle\">' + lang.alignMiddle + '</option>',\r\n        '<option value=\"bottom\">' + lang.alignBottom + '</option>',\r\n        '<option value=\"baseline\">' + lang.alignBaseline + '</option>',\r\n        '</select>',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n        lang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n        lang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n        '</div>',\r\n        '<div class=\"ke-dialog-row\">',\r\n        '<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n        '<span class=\"ke-inline-block ke-input-color\"></span>',\r\n        '</div>',\r\n        '</div>'\r\n      ].join('');\r\n      var bookmark = self.cmd.range.createBookmark();\r\n      var dialog = self.createDialog({\r\n        name : name,\r\n        width : 500,\r\n        title : self.lang('tablecell'),\r\n        body : html,\r\n        beforeRemove : function() {\r\n          colorBox.unbind();\r\n        },\r\n        yesBtn : {\r\n          name : self.lang('yes'),\r\n          click : function(e) {\r\n            var width = widthBox.val(),\r\n              height = heightBox.val(),\r\n              widthType = widthTypeBox.val(),\r\n              heightType = heightTypeBox.val(),\r\n              padding = paddingBox.val(),\r\n              spacing = spacingBox.val(),\r\n              textAlign = textAlignBox.val(),\r\n              verticalAlign = verticalAlignBox.val(),\r\n              border = borderBox.val(),\r\n              borderColor = K(colorBox[0]).html() || '',\r\n              bgColor = K(colorBox[1]).html() || '';\r\n            if (!/^\\d*$/.test(width)) {\r\n              alert(self.lang('invalidWidth'));\r\n              widthBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(height)) {\r\n              alert(self.lang('invalidHeight'));\r\n              heightBox[0].focus();\r\n              return;\r\n            }\r\n            if (!/^\\d*$/.test(border)) {\r\n              alert(self.lang('invalidBorder'));\r\n              borderBox[0].focus();\r\n              return;\r\n            }\r\n            cell.css({\r\n              width : width !== '' ? (width + widthType) : '',\r\n              height : height !== '' ? (height + heightType) : '',\r\n              'background-color' : bgColor,\r\n              'text-align' : textAlign,\r\n              'vertical-align' : verticalAlign,\r\n              'border-width' : border,\r\n              'border-style' : border !== '' ? 'solid' : '',\r\n              'border-color' : borderColor\r\n            });\r\n            self.hideDialog().focus();\r\n            self.cmd.range.moveToBookmark(bookmark);\r\n            self.cmd.select();\r\n            self.addBookmark();\r\n          }\r\n        }\r\n      }),\r\n      div = dialog.div,\r\n      widthBox = K('[name=\"width\"]', div).val(100),\r\n      heightBox = K('[name=\"height\"]', div),\r\n      widthTypeBox = K('[name=\"widthType\"]', div),\r\n      heightTypeBox = K('[name=\"heightType\"]', div),\r\n      paddingBox = K('[name=\"padding\"]', div).val(2),\r\n      spacingBox = K('[name=\"spacing\"]', div).val(0),\r\n      textAlignBox = K('[name=\"textAlign\"]', div),\r\n      verticalAlignBox = K('[name=\"verticalAlign\"]', div),\r\n      borderBox = K('[name=\"border\"]', div).val(1),\r\n      colorBox = K('.ke-input-color', div);\r\n      _initColorPicker(div, colorBox.eq(0));\r\n      _initColorPicker(div, colorBox.eq(1));\r\n      _setColor(colorBox.eq(0), '#000000');\r\n      _setColor(colorBox.eq(1), '');\r\n      widthBox[0].focus();\r\n      widthBox[0].select();\r\n      var cell = self.plugin.getSelectedCell();\r\n      var match,\r\n        cellWidth = cell[0].style.width || cell[0].width || '',\r\n        cellHeight = cell[0].style.height || cell[0].height || '';\r\n      if ((match = /^(\\d+)((?:px|%)*)$/.exec(cellWidth))) {\r\n        widthBox.val(match[1]);\r\n        widthTypeBox.val(match[2]);\r\n      } else {\r\n        widthBox.val('');\r\n      }\r\n      if ((match = /^(\\d+)((?:px|%)*)$/.exec(cellHeight))) {\r\n        heightBox.val(match[1]);\r\n        heightTypeBox.val(match[2]);\r\n      }\r\n      textAlignBox.val(cell[0].style.textAlign || '');\r\n      verticalAlignBox.val(cell[0].style.verticalAlign || '');\r\n      var border = cell[0].style.borderWidth || '';\r\n      if (border) {\r\n        border = parseInt(border);\r\n      }\r\n      borderBox.val(border);\r\n      _setColor(colorBox.eq(0), K.toHex(cell[0].style.borderColor || ''));\r\n      _setColor(colorBox.eq(1), K.toHex(cell[0].style.backgroundColor || ''));\r\n      widthBox[0].focus();\r\n      widthBox[0].select();\r\n    },\r\n    insert : function() {\r\n      this.prop(true);\r\n    },\r\n    'delete' : function() {\r\n      var table = self.plugin.getSelectedTable();\r\n      self.cmd.range.setStartBefore(table[0]).collapse(true);\r\n      self.cmd.select();\r\n      table.remove();\r\n      self.addBookmark();\r\n    },\r\n    colinsert : function(offset) {\r\n      var table = self.plugin.getSelectedTable()[0],\r\n        row = self.plugin.getSelectedRow()[0],\r\n        cell = self.plugin.getSelectedCell()[0],\r\n        index = cell.cellIndex + offset;\r\n      index += table.rows[0].cells.length - row.cells.length;\r\n      for (var i = 0, len = table.rows.length; i < len; i++) {\r\n        var newRow = table.rows[i],\r\n          newCell = newRow.insertCell(index);\r\n        newCell.innerHTML = K.IE ? '' : '<br />';\r\n        index = _getCellIndex(table, newRow, newCell);\r\n      }\r\n      self.cmd.range.selectNodeContents(cell).collapse(true);\r\n      self.cmd.select();\r\n      self.addBookmark();\r\n    },\r\n    colinsertleft : function() {\r\n      this.colinsert(0);\r\n    },\r\n    colinsertright : function() {\r\n      this.colinsert(1);\r\n    },\r\n    rowinsert : function(offset) {\r\n      var table = self.plugin.getSelectedTable()[0],\r\n        row = self.plugin.getSelectedRow()[0],\r\n        cell = self.plugin.getSelectedCell()[0];\r\n      var rowIndex = row.rowIndex;\r\n      if (offset === 1) {\r\n        rowIndex = row.rowIndex + (cell.rowSpan - 1) + offset;\r\n      }\r\n      var newRow = table.insertRow(rowIndex);\r\n      for (var i = 0, len = row.cells.length; i < len; i++) {\r\n        if (row.cells[i].rowSpan > 1) {\r\n          len -= row.cells[i].rowSpan - 1;\r\n        }\r\n        var newCell = newRow.insertCell(i);\r\n        if (offset === 1 && row.cells[i].colSpan > 1) {\r\n          newCell.colSpan = row.cells[i].colSpan;\r\n        }\r\n        newCell.innerHTML = K.IE ? '' : '<br />';\r\n      }\r\n      for (var j = rowIndex; j >= 0; j--) {\r\n        var cells = table.rows[j].cells;\r\n        if (cells.length > i) {\r\n          for (var k = cell.cellIndex; k >= 0; k--) {\r\n            if (cells[k].rowSpan > 1) {\r\n              cells[k].rowSpan += 1;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n      }\r\n      self.cmd.range.selectNodeContents(cell).collapse(true);\r\n      self.cmd.select();\r\n      self.addBookmark();\r\n    },\r\n    rowinsertabove : function() {\r\n      this.rowinsert(0);\r\n    },\r\n    rowinsertbelow : function() {\r\n      this.rowinsert(1);\r\n    },\r\n    rowmerge : function() {\r\n      var table = self.plugin.getSelectedTable()[0],\r\n        row = self.plugin.getSelectedRow()[0],\r\n        cell = self.plugin.getSelectedCell()[0],\r\n        rowIndex = row.rowIndex,\r\n        nextRowIndex = rowIndex + cell.rowSpan,\r\n        nextRow = table.rows[nextRowIndex];\r\n      if (table.rows.length <= nextRowIndex) {\r\n        return;\r\n      }\r\n      var cellIndex = cell.cellIndex;\r\n      if (nextRow.cells.length <= cellIndex) {\r\n        return;\r\n      }\r\n      var nextCell = nextRow.cells[cellIndex];\r\n      if (cell.colSpan !== nextCell.colSpan) {\r\n        return;\r\n      }\r\n      cell.rowSpan += nextCell.rowSpan;\r\n      nextRow.deleteCell(cellIndex);\r\n      self.cmd.range.selectNodeContents(cell).collapse(true);\r\n      self.cmd.select();\r\n      self.addBookmark();\r\n    },\r\n    colmerge : function() {\r\n      var table = self.plugin.getSelectedTable()[0],\r\n        row = self.plugin.getSelectedRow()[0],\r\n        cell = self.plugin.getSelectedCell()[0],\r\n        rowIndex = row.rowIndex,\r\n        cellIndex = cell.cellIndex,\r\n        nextCellIndex = cellIndex + 1;\r\n      if (row.cells.length <= nextCellIndex) {\r\n        return;\r\n      }\r\n      var nextCell = row.cells[nextCellIndex];\r\n      if (cell.rowSpan !== nextCell.rowSpan) {\r\n        return;\r\n      }\r\n      cell.colSpan += nextCell.colSpan;\r\n      row.deleteCell(nextCellIndex);\r\n      self.cmd.range.selectNodeContents(cell).collapse(true);\r\n      self.cmd.select();\r\n      self.addBookmark();\r\n    },\r\n    rowsplit : function() {\r\n      var table = self.plugin.getSelectedTable()[0],\r\n        row = self.plugin.getSelectedRow()[0],\r\n        cell = self.plugin.getSelectedCell()[0],\r\n        rowIndex = row.rowIndex;\r\n      if (cell.rowSpan === 1) {\r\n        return;\r\n      }\r\n      var cellIndex = _getCellIndex(table, row, cell);\r\n      for (var i = 1, len = cell.rowSpan; i < len; i++) {\r\n        var newRow = table.rows[rowIndex + i],\r\n          newCell = newRow.insertCell(cellIndex);\r\n        if (cell.colSpan > 1) {\r\n          newCell.colSpan = cell.colSpan;\r\n        }\r\n        newCell.innerHTML = K.IE ? '' : '<br />';\r\n        cellIndex = _getCellIndex(table, newRow, newCell);\r\n      }\r\n      K(cell).removeAttr('rowSpan');\r\n      self.cmd.range.selectNodeContents(cell).collapse(true);\r\n      self.cmd.select();\r\n      self.addBookmark();\r\n    },\r\n    colsplit : function() {\r\n      var table = self.plugin.getSelectedTable()[0],\r\n        row = self.plugin.getSelectedRow()[0],\r\n        cell = self.plugin.getSelectedCell()[0],\r\n        cellIndex = cell.cellIndex;\r\n      if (cell.colSpan === 1) {\r\n        return;\r\n      }\r\n      for (var i = 1, len = cell.colSpan; i < len; i++) {\r\n        var newCell = row.insertCell(cellIndex + i);\r\n        if (cell.rowSpan > 1) {\r\n          newCell.rowSpan = cell.rowSpan;\r\n        }\r\n        newCell.innerHTML = K.IE ? '' : '<br />';\r\n      }\r\n      K(cell).removeAttr('colSpan');\r\n      self.cmd.range.selectNodeContents(cell).collapse(true);\r\n      self.cmd.select();\r\n      self.addBookmark();\r\n    },\r\n    coldelete : function() {\r\n      var table = self.plugin.getSelectedTable()[0],\r\n        row = self.plugin.getSelectedRow()[0],\r\n        cell = self.plugin.getSelectedCell()[0],\r\n        index = cell.cellIndex;\r\n      for (var i = 0, len = table.rows.length; i < len; i++) {\r\n        var newRow = table.rows[i],\r\n          newCell = newRow.cells[index];\r\n        if (newCell.colSpan > 1) {\r\n          newCell.colSpan -= 1;\r\n          if (newCell.colSpan === 1) {\r\n            K(newCell).removeAttr('colSpan');\r\n          }\r\n        } else {\r\n          newRow.deleteCell(index);\r\n        }\r\n        if (newCell.rowSpan > 1) {\r\n          i += newCell.rowSpan - 1;\r\n        }\r\n      }\r\n      if (row.cells.length === 0) {\r\n        self.cmd.range.setStartBefore(table).collapse(true);\r\n        self.cmd.select();\r\n        K(table).remove();\r\n      } else {\r\n        self.cmd.selection(true);\r\n      }\r\n      self.addBookmark();\r\n    },\r\n    rowdelete : function() {\r\n      var table = self.plugin.getSelectedTable()[0],\r\n        row = self.plugin.getSelectedRow()[0],\r\n        cell = self.plugin.getSelectedCell()[0],\r\n        rowIndex = row.rowIndex;\r\n      for (var i = cell.rowSpan - 1; i >= 0; i--) {\r\n        table.deleteRow(rowIndex + i);\r\n      }\r\n      if (table.rows.length === 0) {\r\n        self.cmd.range.setStartBefore(table).collapse(true);\r\n        self.cmd.select();\r\n        K(table).remove();\r\n      } else {\r\n        self.cmd.selection(true);\r\n      }\r\n      self.addBookmark();\r\n    }\r\n  };\r\n  self.clickToolbar(name, self.plugin.table.prop);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('template', function(K) {\r\n  var self = this, name = 'template', lang = self.lang(name + '.'),\r\n    htmlPath = self.pluginsPath + name + '/html/';\r\n  function getFilePath(fileName) {\r\n    return htmlPath + fileName + '?ver=' + encodeURIComponent(K.DEBUG ? K.TIME : K.VERSION);\r\n  }\r\n  self.clickToolbar(name, function() {\r\n    var lang = self.lang(name + '.'),\r\n      arr = ['<div style=\"padding:10px 20px;\">',\r\n        '<div class=\"ke-header\">',\r\n        '<div class=\"ke-left\">',\r\n        lang. selectTemplate + ' <select>'];\r\n      K.each(lang.fileList, function(key, val) {\r\n        arr.push('<option value=\"' + key + '\">' + val + '</option>');\r\n      });\r\n      html = [arr.join(''),\r\n        '</select></div>',\r\n        '<div class=\"ke-right\">',\r\n        '<input type=\"checkbox\" id=\"keReplaceFlag\" name=\"replaceFlag\" value=\"1\" /> <label for=\"keReplaceFlag\">' + lang.replaceContent + '</label>',\r\n        '</div>',\r\n        '<div class=\"ke-clearfix\"></div>',\r\n        '</div>',\r\n        '<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:458px;height:260px;background-color:#FFF;\"></iframe>',\r\n        '</div>'].join('');\r\n    var dialog = self.createDialog({\r\n      name : name,\r\n      width : 500,\r\n      title : self.lang(name),\r\n      body : html,\r\n      yesBtn : {\r\n        name : self.lang('yes'),\r\n        click : function(e) {\r\n          var doc = K.iframeDoc(iframe);\r\n          self[checkbox[0].checked ? 'html' : 'insertHtml'](doc.body.innerHTML).hideDialog().focus();\r\n        }\r\n      }\r\n    });\r\n    var selectBox = K('select', dialog.div),\r\n      checkbox = K('[name=\"replaceFlag\"]', dialog.div),\r\n      iframe = K('iframe', dialog.div);\r\n    checkbox[0].checked = true;\r\n    iframe.attr('src', getFilePath(selectBox.val()));\r\n    selectBox.change(function() {\r\n      iframe.attr('src', getFilePath(this.value));\r\n    });\r\n  });\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('wordpaste', function(K) {\r\n  var self = this, name = 'wordpaste';\r\n  self.clickToolbar(name, function() {\r\n    var lang = self.lang(name + '.'),\r\n      html = '<div style=\"padding:10px 20px;\">' +\r\n        '<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n        '<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:408px;height:260px;\"></iframe>' +\r\n        '</div>',\r\n      dialog = self.createDialog({\r\n        name : name,\r\n        width : 450,\r\n        title : self.lang(name),\r\n        body : html,\r\n        yesBtn : {\r\n          name : self.lang('yes'),\r\n          click : function(e) {\r\n            var str = doc.body.innerHTML;\r\n            str = K.clearMsWord(str, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n            self.insertHtml(str).hideDialog().focus();\r\n          }\r\n        }\r\n      }),\r\n      div = dialog.div,\r\n      iframe = K('iframe', div),\r\n      doc = K.iframeDoc(iframe);\r\n    if (!K.IE) {\r\n      doc.designMode = 'on';\r\n    }\r\n    doc.open();\r\n    doc.write('<!doctype html><html><head><title>WordPaste</title></head>');\r\n    doc.write('<body style=\"background-color:#FFF;font-size:12px;margin:2px;\">');\r\n    if (!K.IE) {\r\n      doc.write('<br />');\r\n    }\r\n    doc.write('</body></html>');\r\n    doc.close();\r\n    if (K.IE) {\r\n      doc.body.contentEditable = 'true';\r\n    }\r\n    iframe[0].contentWindow.focus();\r\n  });\r\n});\r\n\r\n\r\nKindEditor.plugin('fixtoolbar', function (K) {\r\n    var self = this;\r\n    if (!self.fixToolBar) {\r\n        return;\r\n    }\r\n    function init() {\r\n        var toolbar = K('.ke-toolbar');\r\n        var originY = toolbar.pos().y;\r\n        K(window).bind('scroll', function () {\r\n            if (toolbar.css('position') == 'fixed') {\r\n                if(document.body.scrollTop - originY < 0){\r\n                    toolbar.css('position', 'static');\r\n                    toolbar.css('top', 'auto');\r\n                }\r\n            } else {\r\n                if (toolbar.pos().y - document.body.scrollTop < 0) {\r\n                    toolbar.css('position', 'fixed');\r\n                    toolbar.css('top', 0);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    if (self.isCreated) {\r\n        init();\r\n    } else {\r\n        self.afterCreate(init);\r\n    }\r\n});\r\n"]}